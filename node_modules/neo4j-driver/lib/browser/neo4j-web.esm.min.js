var commonjsGlobal="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function getDefaultExportFromCjs(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var lib$2={},driver$1={},lib$1={},error={},json$3={},objectUtil$2={},__isBrokenObject__=(Object.defineProperty(objectUtil$2,"__esModule",{value:!0}),objectUtil$2.getBrokenObjectReason=objectUtil$2.isBrokenObject=objectUtil$2.createBrokenObject=void 0,"__isBrokenObject__"),__reason__="__reason__";function createBrokenObject(r,e){void 0===e&&(e={});function n(){throw r}return new Proxy(e,{get:function(e,t){return t===__isBrokenObject__||(t===__reason__?r:void("toJSON"!==t&&n()))},set:n,apply:n,construct:n,defineProperty:n,deleteProperty:n,getOwnPropertyDescriptor:n,getPrototypeOf:n,has:n,isExtensible:n,ownKeys:n,preventExtensions:n,setPrototypeOf:n})}function isBrokenObject(e){return null!==e&&"object"==typeof e&&!0===e[__isBrokenObject__]}function getBrokenObjectReason(e){return e[__reason__]}objectUtil$2.createBrokenObject=createBrokenObject,objectUtil$2.isBrokenObject=isBrokenObject,objectUtil$2.getBrokenObjectReason=getBrokenObjectReason,Object.defineProperty(json$3,"__esModule",{value:!0}),json$3.stringify=void 0;var object_util_1=objectUtil$2;function stringify(e,t){return JSON.stringify(e,function(e,r){return(0,object_util_1.isBrokenObject)(r)?{__isBrokenObject__:!0,__reason__:(0,object_util_1.getBrokenObjectReason)(r)}:"bigint"==typeof r?"".concat(r,"n"):!0!==(null==t?void 0:t.sortedElements)||"object"!=typeof r||Array.isArray(r)?!0!==(null==t?void 0:t.useCustomToString)||"object"!=typeof r||Array.isArray(r)||"function"!=typeof r.toString||r.toString===Object.prototype.toString?r:null==r?void 0:r.toString():Object.keys(r).sort().reduce(function(e,t){return e[t]=r[t],e},{})})}json$3.stringify=stringify;var gqlConstants={},__extends$S=(!function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.rawPolyfilledDiagnosticRecord=void 0,e.rawPolyfilledDiagnosticRecord={OPERATION:"",OPERATION_CODE:"0",CURRENT_SCHEMA:"/"},Object.freeze(e.rawPolyfilledDiagnosticRecord)}(gqlConstants),commonjsGlobal&&commonjsGlobal.__extends||function(){var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}}()),__createBinding$d=commonjsGlobal&&commonjsGlobal.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&("get"in o?t.__esModule:!o.writable&&!o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,o)}:function(e,t,r,n){e[n=void 0===n?r:n]=t[r]}),__setModuleDefault$d=commonjsGlobal&&commonjsGlobal.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),__importStar$d=commonjsGlobal&&commonjsGlobal.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&__createBinding$d(t,e,r);return __setModuleDefault$d(t,e),t},json$2=(Object.defineProperty(error,"__esModule",{value:!0}),error.PROTOCOL_ERROR=error.SESSION_EXPIRED=error.SERVICE_UNAVAILABLE=error.GQLError=error.Neo4jError=error.isRetriableError=error.newGQLError=error.newError=void 0,__importStar$d(json$3)),gql_constants_1$1=gqlConstants,errorClassification={DATABASE_ERROR:"DATABASE_ERROR",CLIENT_ERROR:"CLIENT_ERROR",TRANSIENT_ERROR:"TRANSIENT_ERROR",UNKNOWN:"UNKNOWN"},classifications=(Object.freeze(errorClassification),Object.values(errorClassification)),SERVICE_UNAVAILABLE$6="ServiceUnavailable",SESSION_EXPIRED$2=(error.SERVICE_UNAVAILABLE=SERVICE_UNAVAILABLE$6,"SessionExpired"),PROTOCOL_ERROR$6=(error.SESSION_EXPIRED=SESSION_EXPIRED$2,"ProtocolError"),NOT_AVAILABLE$1=(error.PROTOCOL_ERROR=PROTOCOL_ERROR$6,"N/A"),GQLError=function(a){function s(e,t,r,n,o){var i=this;return(i=a.call(this,e,null!=o?{cause:o}:void 0)||this).constructor=s,i.__proto__=s.prototype,i.cause=null!=o?o:void 0,i.gqlStatus=t,i.gqlStatusDescription=r,i.diagnosticRecord=n,i.classification=_extractClassification(i.diagnosticRecord),i.rawClassification=null!=(e=null==n?void 0:n._classification)?e:void 0,i.name="GQLError",i}return __extends$S(s,a),Object.defineProperty(s.prototype,"diagnosticRecordAsJsonString",{get:function(){return json$2.stringify(this.diagnosticRecord,{useCustomToString:!0})},enumerable:!1,configurable:!0}),s}(Error),Neo4jError=function(a){function s(e,t,r,n,o,i){e=a.call(this,e,r,n,o,i)||this;return e.constructor=s,e.__proto__=s.prototype,e.code=t,e.name="Neo4jError",e.retriable=_isRetriableCode(t),e}return __extends$S(s,a),s.isRetriable=function(e){return null!=e&&e instanceof s&&e.retriable},s}(error.GQLError=GQLError);function newError(e,t,r,n,o,i){return new Neo4jError(e,null!=t?t:NOT_AVAILABLE$1,null!=n?n:"50N42",null!=o?o:"error: general processing exception - unexpected error. "+e,null!=i?i:gql_constants_1$1.rawPolyfilledDiagnosticRecord,r)}function newGQLError(e,t,r,n,o){return new GQLError(e,null!=r?r:"50N42",null!=n?n:"error: general processing exception - unexpected error. "+e,null!=o?o:gql_constants_1$1.rawPolyfilledDiagnosticRecord,t)}error.Neo4jError=Neo4jError,error.newError=newError,error.newGQLError=newGQLError;var isRetriableError=Neo4jError.isRetriable;function _isRetriableCode(e){return e===SERVICE_UNAVAILABLE$6||e===SESSION_EXPIRED$2||_isAuthorizationExpired(e)||_isTransientError(e)}function _isTransientError(e){return!0===(null==e?void 0:e.includes("TransientError"))}function _isAuthorizationExpired(e){return"Neo.ClientError.Security.AuthorizationExpired"===e}function _extractClassification(e){return void 0!==e&&void 0!==e._classification&&classifications.includes(e._classification)?null==e?void 0:e._classification:"UNKNOWN"}error.isRetriableError=isRetriableError;var integer={},error_1$d=(Object.defineProperty(integer,"__esModule",{value:!0}),integer.toString=integer.toNumber=integer.inSafeRange=integer.isInt=integer.int=void 0,error),INT_CACHE=new Map,Integer=function(){function _(e,t){this.low=null!=e?e:0,this.high=null!=t?t:0}return _.prototype.inSafeRange=function(){return this.greaterThanOrEqual(_.MIN_SAFE_VALUE)&&this.lessThanOrEqual(_.MAX_SAFE_VALUE)},_.prototype.toInt=function(){return this.low},_.prototype.toNumber=function(){return this.high*TWO_PWR_32_DBL+(this.low>>>0)},_.prototype.toBigInt=function(){var e;return this.isZero()?BigInt(0):this.isPositive()?BigInt(this.high>>>0)*BigInt(TWO_PWR_32_DBL)+BigInt(this.low>>>0):(e=this.negate(),BigInt(-1)*(BigInt(e.high>>>0)*BigInt(TWO_PWR_32_DBL)+BigInt(e.low>>>0)))},_.prototype.toNumberOrInfinity=function(){return this.lessThan(_.MIN_SAFE_VALUE)?Number.NEGATIVE_INFINITY:this.greaterThan(_.MAX_SAFE_VALUE)?Number.POSITIVE_INFINITY:this.toNumber()},_.prototype.toString=function(e){if((e=null!=e?e:10)<2||36<e)throw RangeError("radix out of range: "+e.toString());if(this.isZero())return"0";var t,r,n;if(this.isNegative())return this.equals(_.MIN_VALUE)?(t=_.fromNumber(e),n=(r=this.div(t)).multiply(t).subtract(this),r.toString(e)+n.toInt().toString(e)):"-"+this.negate().toString(e);for(var o=_.fromNumber(Math.pow(e,6)),i=(n=this,"");;){var a=n.div(o),s=(n.subtract(a.multiply(o)).toInt()>>>0).toString(e);if((n=a).isZero())return s+i;for(;s.length<6;)s="0"+s;i=""+s+i}},_.prototype.valueOf=function(){return this.toBigInt()},_.prototype.getHighBits=function(){return this.high},_.prototype.getLowBits=function(){return this.low},_.prototype.getNumBitsAbs=function(){if(this.isNegative())return this.equals(_.MIN_VALUE)?64:this.negate().getNumBitsAbs();for(var e=0!==this.high?this.high:this.low,t=0,t=31;0<t&&0==(e&1<<t);t--);return 0!==this.high?t+33:t+1},_.prototype.isZero=function(){return 0===this.high&&0===this.low},_.prototype.isNegative=function(){return this.high<0},_.prototype.isPositive=function(){return 0<=this.high},_.prototype.isOdd=function(){return 1==(1&this.low)},_.prototype.isEven=function(){return 0==(1&this.low)},_.prototype.equals=function(e){e=_.fromValue(e);return this.high===e.high&&this.low===e.low},_.prototype.notEquals=function(e){return!this.equals(e)},_.prototype.lessThan=function(e){return this.compare(e)<0},_.prototype.lessThanOrEqual=function(e){return this.compare(e)<=0},_.prototype.greaterThan=function(e){return 0<this.compare(e)},_.prototype.greaterThanOrEqual=function(e){return 0<=this.compare(e)},_.prototype.compare=function(e){e=_.fromValue(e);if(this.equals(e))return 0;var t=this.isNegative(),r=e.isNegative();return t&&!r||(t||!r)&&this.subtract(e).isNegative()?-1:1},_.prototype.negate=function(){return this.equals(_.MIN_VALUE)?_.MIN_VALUE:this.not().add(_.ONE)},_.prototype.add=function(e){var e=_.fromValue(e),t=this.high>>>16,r=65535&this.high,n=this.low>>>16,o=65535&this.low,i=e.high>>>16,a=65535&e.high,s=e.low>>>16,u=0,c=0,l=0,f=0;return c+=(l=l+((f+=o+(65535&e.low))>>>16)+(n+s))>>>16,_.fromBits((l&=65535)<<16|(f&=65535),((u+=(c+=r+a)>>>16)+(t+i)&65535)<<16|(c&=65535))},_.prototype.subtract=function(e){e=_.fromValue(e);return this.add(e.negate())},_.prototype.multiply=function(e){if(this.isZero())return _.ZERO;e=_.fromValue(e);if(e.isZero())return _.ZERO;if(this.equals(_.MIN_VALUE))return e.isOdd()?_.MIN_VALUE:_.ZERO;if(e.equals(_.MIN_VALUE))return this.isOdd()?_.MIN_VALUE:_.ZERO;if(this.isNegative())return e.isNegative()?this.negate().multiply(e.negate()):this.negate().multiply(e).negate();if(e.isNegative())return this.multiply(e.negate()).negate();if(this.lessThan(TWO_PWR_24)&&e.lessThan(TWO_PWR_24))return _.fromNumber(this.toNumber()*e.toNumber());var t=this.high>>>16,r=65535&this.high,n=this.low>>>16,o=65535&this.low,i=e.high>>>16,a=65535&e.high,s=e.low>>>16,e=65535&e.low,u=0,c=0,l=0,f=(f=0)+((c=c+((l+=o*e)>>>16)+n*e)>>>16)+((c=(c&65535)+o*s)>>>16);return _.fromBits((c&=65535)<<16|(l&=65535),((u+=(f+=r*e)>>>16)+((f=(f&65535)+n*s)>>>16)+((f=(f&65535)+o*a)>>>16)+(t*e+r*s+n*a+o*i)&65535)<<16|(f&=65535))},_.prototype.div=function(e){var t,r,n,o=_.fromValue(e);if(o.isZero())throw(0,error_1$d.newError)("division by zero");if(this.isZero())return _.ZERO;{if(this.equals(_.MIN_VALUE))return o.equals(_.ONE)||o.equals(_.NEG_ONE)?_.MIN_VALUE:o.equals(_.MIN_VALUE)?_.ONE:(n=this.shiftRight(1).div(o).shiftLeft(1)).equals(_.ZERO)?o.isNegative()?_.ONE:_.NEG_ONE:(t=this.subtract(o.multiply(n)),n.add(t.div(o)));if(o.equals(_.MIN_VALUE))return _.ZERO}if(this.isNegative())return o.isNegative()?this.negate().div(o.negate()):this.negate().div(o).negate();if(o.isNegative())return this.div(o.negate()).negate();for(r=_.ZERO,t=this;t.greaterThanOrEqual(o);){n=Math.max(1,Math.floor(t.toNumber()/o.toNumber()));for(var i=Math.ceil(Math.log(n)/Math.LN2),a=i<=48?1:Math.pow(2,i-48),s=_.fromNumber(n),u=s.multiply(o);u.isNegative()||u.greaterThan(t);)u=(s=_.fromNumber(n-=a)).multiply(o);s.isZero()&&(s=_.ONE),r=r.add(s),t=t.subtract(u)}return r},_.prototype.modulo=function(e){e=_.fromValue(e);return this.subtract(this.div(e).multiply(e))},_.prototype.not=function(){return _.fromBits(~this.low,~this.high)},_.prototype.and=function(e){e=_.fromValue(e);return _.fromBits(this.low&e.low,this.high&e.high)},_.prototype.or=function(e){e=_.fromValue(e);return _.fromBits(this.low|e.low,this.high|e.high)},_.prototype.xor=function(e){e=_.fromValue(e);return _.fromBits(this.low^e.low,this.high^e.high)},_.prototype.shiftLeft=function(e){e=_.toNumber(e);return 0==(e&=63)?_.ZERO:e<32?_.fromBits(this.low<<e,this.high<<e|this.low>>>32-e):_.fromBits(0,this.low<<e-32)},_.prototype.shiftRight=function(e){var t=_.toNumber(e),e=_.toNumber(e);return 0==(t&=63)?_.ZERO:e<32?_.fromBits(this.low>>>t|this.high<<32-t,this.high>>t):_.fromBits(this.high>>t-32,0<=this.high?0:-1)},_.isInteger=function(e){return!0===(null==e?void 0:e.__isInteger__)},_.fromInt=function(e){if(-128<=(e|=0)&&e<128&&null!=(t=INT_CACHE.get(e)))return t;var t=new _(e,e<0?-1:0);return-128<=e&&e<128&&INT_CACHE.set(e,t),t},_.fromBits=function(e,t){return new _(e,t)},_.fromNumber=function(e){return isNaN(e)||!isFinite(e)?_.ZERO:e<=-TWO_PWR_63_DBL?_.MIN_VALUE:TWO_PWR_63_DBL<=e+1?_.MAX_VALUE:e<0?_.fromNumber(-e).negate():new _(e%TWO_PWR_32_DBL|0,e/TWO_PWR_32_DBL|0)},_.fromString=function(e,t,r){var n=(void 0===r?{}:r).strictStringValidation;if(0===e.length)throw(0,error_1$d.newError)("number format error: empty string");if("NaN"===e||"Infinity"===e||"+Infinity"===e||"-Infinity"===e)return _.ZERO;if((t=null!=t?t:10)<2||36<t)throw(0,error_1$d.newError)("radix out of range: "+t.toString());if(0<(r=e.indexOf("-")))throw(0,error_1$d.newError)('number format error: interior "-" character: '+e);if(0===r)return _.fromString(e.substring(1),t).negate();for(var o=_.fromNumber(Math.pow(t,8)),i=_.ZERO,a=0;a<e.length;a+=8){var s=Math.min(8,e.length-a),u=e.substring(a,a+s),c=parseInt(u,t);if(!0===n&&!_isValidNumberFromString(u,c,t))throw(0,error_1$d.newError)('number format error: "'.concat(u,'" is NaN in radix ').concat(t,": ").concat(e));i=s<8?(u=_.fromNumber(Math.pow(t,s)),i.multiply(u).add(_.fromNumber(c))):(i=i.multiply(o)).add(_.fromNumber(c))}return i},_.fromValue=function(e,t){return void 0===t&&(t={}),e instanceof _?e:"number"==typeof e?(!0===t.ceilFloat&&(e=Math.ceil(e)),_.fromNumber(e)):"string"==typeof e?_.fromString(e,void 0,t):"bigint"==typeof e?_.fromString(e.toString()):new _(e.low,e.high)},_.toNumber=function(e){switch(typeof e){case"number":return e;case"bigint":return Number(e);default:return _.fromValue(e).toNumber()}},_.toString=function(e,t){return _.fromValue(e).toString(t)},_.inSafeRange=function(e){return _.fromValue(e).inSafeRange()},_.ZERO=_.fromInt(0),_.ONE=_.fromInt(1),_.NEG_ONE=_.fromInt(-1),_.MAX_VALUE=_.fromBits(-1,2147483647),_.MIN_VALUE=_.fromBits(0,-2147483648),_.MIN_SAFE_VALUE=_.fromBits(1,-2097152),_.MAX_SAFE_VALUE=_.fromBits(-1,2097151),_.__isInteger__=!0,_}();function _convertNumberToString(e,t,r){e=e.toString(t),t=Math.max(r-e.length,0),r="0".repeat(t);return"".concat(r).concat(e)}function _isValidNumberFromString(e,t,r){return!Number.isNaN(e)&&!Number.isNaN(t)&&_convertNumberToString(t,r,e.length)===e.toLowerCase()}Object.defineProperty(Integer.prototype,"__isInteger__",{value:!0,enumerable:!1,configurable:!1});var TWO_PWR_16_DBL=65536,TWO_PWR_24_DBL=1<<24,TWO_PWR_32_DBL=TWO_PWR_16_DBL*TWO_PWR_16_DBL,TWO_PWR_64_DBL=TWO_PWR_32_DBL*TWO_PWR_32_DBL,TWO_PWR_63_DBL=TWO_PWR_64_DBL/2,TWO_PWR_24=Integer.fromInt(TWO_PWR_24_DBL),int=Integer.fromValue,isInt=(integer.int=int,Integer.isInteger),inSafeRange=(integer.isInt=isInt,Integer.inSafeRange),toNumber$1=(integer.inSafeRange=inSafeRange,Integer.toNumber),toString=(integer.toNumber=toNumber$1,Integer.toString),temporalTypes=(integer.toString=toString,integer.default=Integer,{}),temporalUtil$1={},util$4={},__createBinding$c=commonjsGlobal&&commonjsGlobal.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&("get"in o?t.__esModule:!o.writable&&!o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,o)}:function(e,t,r,n){e[n=void 0===n?r:n]=t[r]}),__setModuleDefault$c=commonjsGlobal&&commonjsGlobal.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),__importStar$c=commonjsGlobal&&commonjsGlobal.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&__createBinding$c(t,e,r);return __setModuleDefault$c(t,e),t},__values$d=commonjsGlobal&&commonjsGlobal.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return{value:(e=e&&n>=e.length?void 0:e)&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},integer_1$2=(Object.defineProperty(util$4,"__esModule",{value:!0}),util$4.ENCRYPTION_OFF=util$4.ENCRYPTION_ON=util$4.equals=util$4.validateQueryAndParameters=util$4.toNumber=util$4.assertValidDate=util$4.assertNumberOrInteger=util$4.assertNumber=util$4.assertString=util$4.assertObject=util$4.isString=util$4.isObject=util$4.isEmptyObjectOrNull=void 0,__importStar$c(integer)),json_1$3=json$3,ENCRYPTION_ON$2="ENCRYPTION_ON",ENCRYPTION_OFF$2=(util$4.ENCRYPTION_ON=ENCRYPTION_ON$2,"ENCRYPTION_OFF");function isEmptyObjectOrNull(e){if(null===e)return!0;if(!isObject(e))return!1;for(var t in e)if(void 0!==e[t])return!1;return!0}function isObject(e){return"object"==typeof e&&!Array.isArray(e)&&null!==e}function validateQueryAndParameters(e,t,r){var n="",t=null!=t?t:{},r=null!=(r=null==r?void 0:r.skipAsserts)&&r;return"string"==typeof e?n=e:e instanceof String?n=e.toString():"object"==typeof e&&null!=e.text&&(n=e.text,t=null!=(e=e.parameters)?e:{}),r||(assertCypherQuery(n),assertQueryParameters(t)),{validatedQuery:n,params:t}}function assertObject(e,t){if(isObject(e))return e;throw new TypeError(t+" expected to be an object but was: "+(0,json_1$3.stringify)(e))}function assertString$1(e,t){if(isString$1(e))return e;throw new TypeError((0,json_1$3.stringify)(t)+" expected to be string but was: "+(0,json_1$3.stringify)(e))}function assertNumber(e,t){if("number"!=typeof e)throw new TypeError(t+" expected to be a number but was: "+(0,json_1$3.stringify)(e));return e}function assertNumberOrInteger(e,t){if("number"==typeof e||"bigint"==typeof e||(0,integer_1$2.isInt)(e))return e;throw new TypeError(t+" expected to be either a number or an Integer object but was: "+(0,json_1$3.stringify)(e))}function assertValidDate(e,t){if("[object Date]"!==Object.prototype.toString.call(e))throw new TypeError(t+" expected to be a standard JavaScript Date but was: "+(0,json_1$3.stringify)(e));if(Number.isNaN(e.getTime()))throw new TypeError(t+" expected to be valid JavaScript Date but its time was NaN: "+(0,json_1$3.stringify)(e));return e}function assertCypherQuery(e){if(assertString$1(e,"Cypher query"),0===e.trim().length)throw new TypeError("Cypher query is expected to be a non-empty string.")}function assertQueryParameters(e){var t;if(!isObject(e))throw t=null!=e.constructor?" "+e.constructor.name:"",new TypeError("Query parameters are expected to either be undefined/null or an object, given:".concat(t," ").concat(JSON.stringify(e)))}function isString$1(e){return"[object String]"===Object.prototype.toString.call(e)}function equals$1(e,t){var r,n;if(e===t)return!0;if(null===e||null===t)return!1;if("object"!=typeof e||"object"!=typeof t)return!1;var o=Object.keys(e),i=Object.keys(t);if(o.length!==i.length)return!1;try{for(var a=__values$d(o),s=a.next();!s.done;s=a.next()){var u=s.value;if(!equals$1(e[u],t[u]))return!1}}catch(e){r={error:e}}finally{try{s&&!s.done&&(n=a.return)&&n.call(a)}finally{if(r)throw r.error}}return!0}function toNumber(e){return e instanceof integer_1$2.default?e.toNumber():"bigint"==typeof e?(0,integer_1$2.int)(e).toNumber():e}util$4.ENCRYPTION_OFF=ENCRYPTION_OFF$2,util$4.isEmptyObjectOrNull=isEmptyObjectOrNull,util$4.isObject=isObject,util$4.validateQueryAndParameters=validateQueryAndParameters,util$4.assertObject=assertObject,util$4.assertString=assertString$1,util$4.assertNumber=assertNumber,util$4.assertNumberOrInteger=assertNumberOrInteger,util$4.assertValidDate=assertValidDate,util$4.isString=isString$1,util$4.equals=equals$1,util$4.toNumber=toNumber,function(s){var n=commonjsGlobal&&commonjsGlobal.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&("get"in o?t.__esModule:!o.writable&&!o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,o)}:function(e,t,r,n){e[n=void 0===n?r:n]=t[r]}),o=commonjsGlobal&&commonjsGlobal.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),e=commonjsGlobal&&commonjsGlobal.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return o(t,e),t},u=(Object.defineProperty(s,"__esModule",{value:!0}),s.floorMod=s.floorDiv=s.assertValidZoneId=s.assertValidNanosecond=s.assertValidSecond=s.assertValidMinute=s.assertValidHour=s.assertValidDay=s.assertValidMonth=s.assertValidYear=s.timeZoneOffsetInSeconds=s.totalNanoseconds=s.newDate=s.toStandardDate=s.isoStringToStandardDate=s.dateToIsoString=s.timeZoneOffsetToIsoString=s.timeToIsoString=s.durationToIsoString=s.dateToEpochDay=s.localDateTimeToEpochSecond=s.localTimeToNanoOfDay=s.normalizeNanosecondsForDuration=s.normalizeSecondsForDuration=s.SECONDS_PER_DAY=s.DAYS_PER_400_YEAR_CYCLE=s.DAYS_0000_TO_1970=s.NANOS_PER_HOUR=s.NANOS_PER_MINUTE=s.NANOS_PER_MILLISECOND=s.NANOS_PER_SECOND=s.SECONDS_PER_HOUR=s.SECONDS_PER_MINUTE=s.MINUTES_PER_HOUR=s.NANOSECOND_OF_SECOND_RANGE=s.SECOND_OF_MINUTE_RANGE=s.MINUTE_OF_HOUR_RANGE=s.HOUR_OF_DAY_RANGE=s.DAY_OF_MONTH_RANGE=s.MONTH_OF_YEAR_RANGE=s.YEAR_RANGE=void 0,e(integer)),i=error,a=util$4,e=(t.prototype.contains=function(e){var t;return(0,u.isInt)(e)&&e instanceof u.default?e.greaterThanOrEqual(this._minInteger)&&e.lessThanOrEqual(this._maxInteger):"bigint"==typeof e?(t=(0,u.int)(e)).greaterThanOrEqual(this._minInteger)&&t.lessThanOrEqual(this._maxInteger):e>=this._minNumber&&e<=this._maxNumber},t.prototype.toString=function(){return"[".concat(this._minNumber,", ").concat(this._maxNumber,"]")},t);function t(e,t){this._minNumber=e,this._maxNumber=t,this._minInteger=(0,u.int)(e),this._maxInteger=(0,u.int)(t)}function c(e,t,r){e=(0,u.int)(e),t=(0,u.int)(t),r=(0,u.int)(r);var n=e.multiply(365);return n=(n=(n=e.greaterThanOrEqual(0)?n.add(e.add(3).div(4).subtract(e.add(99).div(100)).add(e.add(399).div(400))):n.subtract(e.div(-4).subtract(e.div(-100)).add(e.div(-400)))).add(t.multiply(367).subtract(362).div(12))).add(r.subtract(1)),t.greaterThan(2)&&(n=n.subtract(1),function(e){if((e=(0,u.int)(e)).modulo(4).equals(0))return!e.modulo(100).equals(0)||!!e.modulo(400).equals(0)}(e)||(n=n.subtract(1))),n.subtract(s.DAYS_0000_TO_1970)}function l(e,t){return 1===e?t%400==0||t%4==0&&t%100!=0?29:28:[0,2,4,6,7,9,11].includes(e)?31:30}s.YEAR_RANGE=new e(-999999999,999999999),s.MONTH_OF_YEAR_RANGE=new e(1,12),s.DAY_OF_MONTH_RANGE=new e(1,31),s.HOUR_OF_DAY_RANGE=new e(0,23),s.MINUTE_OF_HOUR_RANGE=new e(0,59),s.SECOND_OF_MINUTE_RANGE=new e(0,59),s.NANOSECOND_OF_SECOND_RANGE=new e(0,999999999),s.MINUTES_PER_HOUR=60,s.SECONDS_PER_MINUTE=60,s.SECONDS_PER_HOUR=s.SECONDS_PER_MINUTE*s.MINUTES_PER_HOUR,s.NANOS_PER_SECOND=1e9,s.NANOS_PER_MILLISECOND=1e6,s.NANOS_PER_MINUTE=s.NANOS_PER_SECOND*s.SECONDS_PER_MINUTE,s.NANOS_PER_HOUR=s.NANOS_PER_MINUTE*s.MINUTES_PER_HOUR,s.DAYS_0000_TO_1970=719528,s.DAYS_PER_400_YEAR_CYCLE=146097,s.SECONDS_PER_DAY=86400,s.normalizeSecondsForDuration=function(e,t){return(0,u.int)(e).add(p(t,s.NANOS_PER_SECOND))},s.normalizeNanosecondsForDuration=function(e){return d(e,s.NANOS_PER_SECOND)},s.localTimeToNanoOfDay=function(e,t,r,n){return e=(0,u.int)(e),t=(0,u.int)(t),r=(0,u.int)(r),n=(0,u.int)(n),(e=(e=(e=e.multiply(s.NANOS_PER_HOUR)).add(t.multiply(s.NANOS_PER_MINUTE))).add(r.multiply(s.NANOS_PER_SECOND))).add(n)},s.localDateTimeToEpochSecond=function(e,t,r,n,o,i,a){return e=c(e,t,r),t=function(e,t,r){e=(0,u.int)(e),t=(0,u.int)(t),r=(0,u.int)(r);e=e.multiply(s.SECONDS_PER_HOUR);return(e=e.add(t.multiply(s.SECONDS_PER_MINUTE))).add(r)}(n,o,i),e.multiply(s.SECONDS_PER_DAY).add(t)},s.dateToEpochDay=c,s.durationToIsoString=function(e,t,r,n){return e=m(e),t=m(t),r=function(e,t){e=(0,u.int)(e),t=(0,u.int)(t);var r,n=e.isNegative(),o=t.greaterThan(0);e=n&&o?e.equals(-1)?"-0":e.add(1).toString():e.toString();o&&(r=b((n?t.negate().add(2*s.NANOS_PER_SECOND):t.add(s.NANOS_PER_SECOND)).modulo(s.NANOS_PER_SECOND)));return null!=r?e+r:e}(r,n),"P".concat(e,"M").concat(t,"DT").concat(r,"S")},s.timeToIsoString=function(e,t,r,n){return e=m(e,2),t=m(t,2),r=m(r,2),n=b(n),"".concat(e,":").concat(t,":").concat(r).concat(n)},s.timeZoneOffsetToIsoString=function(e){if((e=(0,u.int)(e)).equals(0))return"Z";var t=(r=e.isNegative())?"-":"+",r=m((e=r?e.multiply(-1):e).div(s.SECONDS_PER_HOUR),2),n=m(e.div(s.SECONDS_PER_MINUTE).modulo(s.MINUTES_PER_HOUR),2);return null!=(e=(e=e.modulo(s.SECONDS_PER_MINUTE)).equals(0)?null:m(e,2))?"".concat(t).concat(r,":").concat(n,":").concat(e):"".concat(t).concat(r,":").concat(n)},s.dateToIsoString=function(e,t,r){return e=function(e){e=(0,u.int)(e);if(e.isNegative()||e.greaterThan(9999))return m(e,6,{usePositiveSign:!0});return m(e,4)}(e),t=m(t,2),r=m(r,2),"".concat(e,"-").concat(t,"-").concat(r)},s.isoStringToStandardDate=function(e){return new Date(e)},s.toStandardDate=function(e){return new Date(e)},s.newDate=function(e){return new Date(e)},s.totalNanoseconds=function(e,t){return t=null!=t?t:0,e=e.getMilliseconds()*s.NANOS_PER_MILLISECOND,t instanceof u.default?t.add(e):"bigint"==typeof t?t+BigInt(e):t+e},s.timeZoneOffsetInSeconds=function(e){var t=e.getSeconds()-e.getUTCSeconds(),r=e.getMinutes()-e.getUTCMinutes(),n=e.getHours()-e.getUTCHours(),e=(e=e).getMonth()===e.getUTCMonth()?e.getDate()-e.getUTCDate():e.getFullYear()>e.getUTCFullYear()||e.getMonth()>e.getUTCMonth()&&e.getFullYear()===e.getUTCFullYear()?e.getDate()+l(e.getUTCMonth(),e.getUTCFullYear())-e.getUTCDate():e.getDate()-(e.getUTCDate()+l(e.getMonth(),e.getFullYear()));return n*s.SECONDS_PER_HOUR+r*s.SECONDS_PER_MINUTE+t+e*s.SECONDS_PER_DAY},s.assertValidYear=function(e){return r(e,s.YEAR_RANGE,"Year")},s.assertValidMonth=function(e){return r(e,s.MONTH_OF_YEAR_RANGE,"Month")},s.assertValidDay=function(e){return r(e,s.DAY_OF_MONTH_RANGE,"Day")},s.assertValidHour=function(e){return r(e,s.HOUR_OF_DAY_RANGE,"Hour")},s.assertValidMinute=function(e){return r(e,s.MINUTE_OF_HOUR_RANGE,"Minute")},s.assertValidSecond=function(e){return r(e,s.SECOND_OF_MINUTE_RANGE,"Second")},s.assertValidNanosecond=function(e){return r(e,s.NANOSECOND_OF_SECOND_RANGE,"Nanosecond")};function f(e,t){return(0,i.newError)("".concat(t,' is expected to be a valid ZoneId but was: "').concat(e,'"'))}var _=new Map;function r(e,t,r){if((0,a.assertNumberOrInteger)(e,r),t.contains(e))return e;throw(0,i.newError)("".concat(r," is expected to be in range ").concat(t.toString()," but was: ").concat(e.toString()))}function p(e,t){e=(0,u.int)(e),t=(0,u.int)(t);var r=e.div(t);return r=e.isPositive()!==t.isPositive()&&r.multiply(t).notEquals(e)?r.subtract(1):r}function d(e,t){return e=(0,u.int)(e),t=(0,u.int)(t),e.subtract(p(e,t).multiply(t))}function b(e){return(e=(0,u.int)(e)).equals(0)?"":"."+m(e,9)}function m(e,t,r){var n=(e=(0,u.int)(e)).isNegative(),o=(e=n?e.negate():e).toString();if(null!=t)for(;o.length<t;)o="0"+o;return n?"-"+o:!0===(null==r?void 0:r.usePositiveSign)?"+"+o:o}s.assertValidZoneId=function(t,r){var e=_.get(r);if(!0!==e){if(!1===e)throw f(r,t);try{Intl.DateTimeFormat(void 0,{timeZone:r}),_.set(r,!0)}catch(e){throw _.set(r,!1),f(r,t)}}},s.floorDiv=p,s.floorMod=d}(temporalUtil$1);var __createBinding$b=commonjsGlobal&&commonjsGlobal.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&("get"in o?t.__esModule:!o.writable&&!o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,o)}:function(e,t,r,n){e[n=void 0===n?r:n]=t[r]}),__setModuleDefault$b=commonjsGlobal&&commonjsGlobal.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),__importStar$b=commonjsGlobal&&commonjsGlobal.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&__createBinding$b(t,e,r);return __setModuleDefault$b(t,e),t},__read$x=commonjsGlobal&&commonjsGlobal.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),a=[];try{for(;(void 0===t||0<t--)&&!(n=i.next()).done;)a.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a},util$3=(Object.defineProperty(temporalTypes,"__esModule",{value:!0}),temporalTypes.isDateTime=temporalTypes.DateTime=temporalTypes.isLocalDateTime=temporalTypes.LocalDateTime=temporalTypes.isDate=temporalTypes.Date=temporalTypes.isTime=temporalTypes.Time=temporalTypes.isLocalTime=temporalTypes.LocalTime=temporalTypes.isDuration=temporalTypes.Duration=void 0,__importStar$b(temporalUtil$1)),util_1$7=util$4,error_1$c=error,integer_1$1=__importStar$b(integer),IDENTIFIER_PROPERTY_ATTRIBUTES$1={value:!0,enumerable:!1,configurable:!1,writable:!1},DURATION_IDENTIFIER_PROPERTY="__isDuration__",LOCAL_TIME_IDENTIFIER_PROPERTY="__isLocalTime__",TIME_IDENTIFIER_PROPERTY="__isTime__",DATE_IDENTIFIER_PROPERTY="__isDate__",LOCAL_DATE_TIME_IDENTIFIER_PROPERTY="__isLocalDateTime__",DATE_TIME_IDENTIFIER_PROPERTY="__isDateTime__",Duration=function(){function e(e,t,r,n){this.months=(0,util_1$7.assertNumberOrInteger)(e,"Months"),this.days=(0,util_1$7.assertNumberOrInteger)(t,"Days"),(0,util_1$7.assertNumberOrInteger)(r,"Seconds"),(0,util_1$7.assertNumberOrInteger)(n,"Nanoseconds"),this.seconds=util$3.normalizeSecondsForDuration(r,n),this.nanoseconds=util$3.normalizeNanosecondsForDuration(n),Object.freeze(this)}return e.prototype.toString=function(){return util$3.durationToIsoString(this.months,this.days,this.seconds,this.nanoseconds)},e}();function isDuration(e){return hasIdentifierProperty$1(e,DURATION_IDENTIFIER_PROPERTY)}temporalTypes.Duration=Duration,Object.defineProperty(Duration.prototype,DURATION_IDENTIFIER_PROPERTY,IDENTIFIER_PROPERTY_ATTRIBUTES$1),temporalTypes.isDuration=isDuration;var LocalTime=function(){function r(e,t,r,n){this.hour=util$3.assertValidHour(e),this.minute=util$3.assertValidMinute(t),this.second=util$3.assertValidSecond(r),this.nanosecond=util$3.assertValidNanosecond(n),Object.freeze(this)}return r.fromStandardDate=function(e,t){verifyStandardDateAndNanos(e,t);t=util$3.totalNanoseconds(e,t);return new r(e.getHours(),e.getMinutes(),e.getSeconds(),t instanceof integer_1$1.default?t.toInt():"bigint"==typeof t?(0,integer_1$1.int)(t).toInt():t)},r.prototype.toString=function(){return util$3.timeToIsoString(this.hour,this.minute,this.second,this.nanosecond)},r}();function isLocalTime(e){return hasIdentifierProperty$1(e,LOCAL_TIME_IDENTIFIER_PROPERTY)}temporalTypes.LocalTime=LocalTime,Object.defineProperty(LocalTime.prototype,LOCAL_TIME_IDENTIFIER_PROPERTY,IDENTIFIER_PROPERTY_ATTRIBUTES$1),temporalTypes.isLocalTime=isLocalTime;var Time=function(){function r(e,t,r,n,o){this.hour=util$3.assertValidHour(e),this.minute=util$3.assertValidMinute(t),this.second=util$3.assertValidSecond(r),this.nanosecond=util$3.assertValidNanosecond(n),this.timeZoneOffsetSeconds=(0,util_1$7.assertNumberOrInteger)(o,"Time zone offset in seconds"),Object.freeze(this)}return r.fromStandardDate=function(e,t){return verifyStandardDateAndNanos(e,t),new r(e.getHours(),e.getMinutes(),e.getSeconds(),(0,integer_1$1.toNumber)(util$3.totalNanoseconds(e,t)),util$3.timeZoneOffsetInSeconds(e))},r.prototype.toString=function(){return util$3.timeToIsoString(this.hour,this.minute,this.second,this.nanosecond)+util$3.timeZoneOffsetToIsoString(this.timeZoneOffsetSeconds)},r}();function isTime(e){return hasIdentifierProperty$1(e,TIME_IDENTIFIER_PROPERTY)}temporalTypes.Time=Time,Object.defineProperty(Time.prototype,TIME_IDENTIFIER_PROPERTY,IDENTIFIER_PROPERTY_ATTRIBUTES$1),temporalTypes.isTime=isTime;var Date$1=function(){function t(e,t,r){this.year=util$3.assertValidYear(e),this.month=util$3.assertValidMonth(t),this.day=util$3.assertValidDay(r),Object.freeze(this)}return t.fromStandardDate=function(e){return verifyStandardDateAndNanos(e),new t(e.getFullYear(),e.getMonth()+1,e.getDate())},t.prototype.toStandardDate=function(){return util$3.isoStringToStandardDate(this.toString())},t.prototype.toString=function(){return util$3.dateToIsoString(this.year,this.month,this.day)},t}();function isDate$1(e){return hasIdentifierProperty$1(e,DATE_IDENTIFIER_PROPERTY)}temporalTypes.Date=Date$1,Object.defineProperty(Date$1.prototype,DATE_IDENTIFIER_PROPERTY,IDENTIFIER_PROPERTY_ATTRIBUTES$1),temporalTypes.isDate=isDate$1;var LocalDateTime=function(){function r(e,t,r,n,o,i,a){this.year=util$3.assertValidYear(e),this.month=util$3.assertValidMonth(t),this.day=util$3.assertValidDay(r),this.hour=util$3.assertValidHour(n),this.minute=util$3.assertValidMinute(o),this.second=util$3.assertValidSecond(i),this.nanosecond=util$3.assertValidNanosecond(a),Object.freeze(this)}return r.fromStandardDate=function(e,t){return verifyStandardDateAndNanos(e,t),new r(e.getFullYear(),e.getMonth()+1,e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),(0,integer_1$1.toNumber)(util$3.totalNanoseconds(e,t)))},r.prototype.toStandardDate=function(){return util$3.isoStringToStandardDate(this.toString())},r.prototype.toString=function(){return localDateTimeToString(this.year,this.month,this.day,this.hour,this.minute,this.second,this.nanosecond)},r}();function isLocalDateTime(e){return hasIdentifierProperty$1(e,LOCAL_DATE_TIME_IDENTIFIER_PROPERTY)}temporalTypes.LocalDateTime=LocalDateTime,Object.defineProperty(LocalDateTime.prototype,LOCAL_DATE_TIME_IDENTIFIER_PROPERTY,IDENTIFIER_PROPERTY_ATTRIBUTES$1),temporalTypes.isLocalDateTime=isLocalDateTime;var DateTime=function(){function r(e,t,r,n,o,i,a,s,u){this.year=util$3.assertValidYear(e),this.month=util$3.assertValidMonth(t),this.day=util$3.assertValidDay(r),this.hour=util$3.assertValidHour(n),this.minute=util$3.assertValidMinute(o),this.second=util$3.assertValidSecond(i),this.nanosecond=util$3.assertValidNanosecond(a);e=__read$x(verifyTimeZoneArguments(s,u),2),t=e[0],r=e[1];this.timeZoneOffsetSeconds=t,this.timeZoneId=null!=r?r:void 0,Object.freeze(this)}return r.fromStandardDate=function(e,t){return verifyStandardDateAndNanos(e,t),new r(e.getFullYear(),e.getMonth()+1,e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),(0,integer_1$1.toNumber)(util$3.totalNanoseconds(e,t)),util$3.timeZoneOffsetInSeconds(e),null)},r.prototype.toStandardDate=function(){return util$3.toStandardDate(this._toUTC())},r.prototype.toString=function(){var e;return localDateTimeToString(this.year,this.month,this.day,this.hour,this.minute,this.second,this.nanosecond)+(null!=this.timeZoneOffsetSeconds?util$3.timeZoneOffsetToIsoString(null!=(e=this.timeZoneOffsetSeconds)?e:0):"")+(null!=this.timeZoneId?"[".concat(this.timeZoneId,"]"):"")},r.prototype._toUTC=function(){if(void 0===this.timeZoneOffsetSeconds)throw new Error("Requires DateTime created with time zone offset");var e=util$3.localDateTimeToEpochSecond(this.year,this.month,this.day,this.hour,this.minute,this.second,this.nanosecond).subtract(null!=(e=this.timeZoneOffsetSeconds)?e:0);return(0,integer_1$1.int)(e).multiply(1e3).add((0,integer_1$1.int)(this.nanosecond).div(1e6)).toNumber()},r}();function isDateTime(e){return hasIdentifierProperty$1(e,DATE_TIME_IDENTIFIER_PROPERTY)}function hasIdentifierProperty$1(e,t){return null!=e&&!0===e[t]}function localDateTimeToString(e,t,r,n,o,i,a){return util$3.dateToIsoString(e,t,r)+"T"+util$3.timeToIsoString(n,o,i,a)}function verifyTimeZoneArguments(e,t){var r=null!=e,n=null!=t&&""!==t;if(!r&&!n)throw(0,error_1$c.newError)("Unable to create DateTime without either time zone offset or id. Please specify either of them. Given offset: ".concat(e," and id: ").concat(t));var o=[void 0,void 0];return r&&((0,util_1$7.assertNumberOrInteger)(e,"Time zone offset in seconds"),o[0]=e),n&&((0,util_1$7.assertString)(t,"Time zone ID"),util$3.assertValidZoneId("Time zone ID",t),o[1]=t),o}function verifyStandardDateAndNanos(e,t){(0,util_1$7.assertValidDate)(e,"Standard date"),null!=t&&(0,util_1$7.assertNumberOrInteger)(t,"Nanosecond")}temporalTypes.DateTime=DateTime,Object.defineProperty(DateTime.prototype,DATE_TIME_IDENTIFIER_PROPERTY,IDENTIFIER_PROPERTY_ATTRIBUTES$1),temporalTypes.isDateTime=isDateTime;var graphTypes={},json_1$2=(Object.defineProperty(graphTypes,"__esModule",{value:!0}),graphTypes.isPathSegment=graphTypes.PathSegment=graphTypes.isPath=graphTypes.Path=graphTypes.isUnboundRelationship=graphTypes.UnboundRelationship=graphTypes.isRelationship=graphTypes.Relationship=graphTypes.isNode=graphTypes.Node=void 0,json$3),IDENTIFIER_PROPERTY_ATTRIBUTES={value:!0,enumerable:!1,configurable:!1,writable:!1},NODE_IDENTIFIER_PROPERTY="__isNode__",RELATIONSHIP_IDENTIFIER_PROPERTY="__isRelationship__",UNBOUND_RELATIONSHIP_IDENTIFIER_PROPERTY="__isUnboundRelationship__",PATH_IDENTIFIER_PROPERTY="__isPath__",PATH_SEGMENT_IDENTIFIER_PROPERTY="__isPathSegment__";function hasIdentifierProperty(e,t){return null!=e&&!0===e[t]}var Node=function(){function e(e,t,r,n){this.identity=e,this.labels=t,this.properties=r,this.elementId=_valueOrGetDefault(n,function(){return e.toString()})}return e.prototype.toString=function(){for(var e="("+this.elementId,t=0;t<this.labels.length;t++)e+=":"+this.labels[t];var r=Object.keys(this.properties);if(0<r.length){e+=" {";for(t=0;t<r.length;t++)0<t&&(e+=","),e+=r[t]+":"+(0,json_1$2.stringify)(this.properties[r[t]]);e+="}"}return e+=")"},e}();function isNode(e){return hasIdentifierProperty(e,NODE_IDENTIFIER_PROPERTY)}graphTypes.Node=Node,Object.defineProperty(Node.prototype,NODE_IDENTIFIER_PROPERTY,IDENTIFIER_PROPERTY_ATTRIBUTES),graphTypes.isNode=isNode;var Relationship=function(){function e(e,t,r,n,o,i,a,s){this.identity=e,this.start=t,this.end=r,this.type=n,this.properties=o,this.elementId=_valueOrGetDefault(i,function(){return e.toString()}),this.startNodeElementId=_valueOrGetDefault(a,function(){return t.toString()}),this.endNodeElementId=_valueOrGetDefault(s,function(){return r.toString()})}return e.prototype.toString=function(){var e="("+this.startNodeElementId+")-[:"+this.type,t=Object.keys(this.properties);if(0<t.length){e+=" {";for(var r=0;r<t.length;r++)0<r&&(e+=","),e+=t[r]+":"+(0,json_1$2.stringify)(this.properties[t[r]]);e+="}"}return e+="]->("+this.endNodeElementId+")"},e}();function isRelationship(e){return hasIdentifierProperty(e,RELATIONSHIP_IDENTIFIER_PROPERTY)}graphTypes.Relationship=Relationship,Object.defineProperty(Relationship.prototype,RELATIONSHIP_IDENTIFIER_PROPERTY,IDENTIFIER_PROPERTY_ATTRIBUTES),graphTypes.isRelationship=isRelationship;var UnboundRelationship=function(){function e(e,t,r,n){this.identity=e,this.type=t,this.properties=r,this.elementId=_valueOrGetDefault(n,function(){return e.toString()})}return e.prototype.bind=function(e,t){return new Relationship(this.identity,e,t,this.type,this.properties,this.elementId)},e.prototype.bindTo=function(e,t){return new Relationship(this.identity,e.identity,t.identity,this.type,this.properties,this.elementId,e.elementId,t.elementId)},e.prototype.toString=function(){var e="-[:"+this.type,t=Object.keys(this.properties);if(0<t.length){e+=" {";for(var r=0;r<t.length;r++)0<r&&(e+=","),e+=t[r]+":"+(0,json_1$2.stringify)(this.properties[t[r]]);e+="}"}return e+="]->"},e}();function isUnboundRelationship(e){return hasIdentifierProperty(e,UNBOUND_RELATIONSHIP_IDENTIFIER_PROPERTY)}graphTypes.UnboundRelationship=UnboundRelationship,Object.defineProperty(UnboundRelationship.prototype,UNBOUND_RELATIONSHIP_IDENTIFIER_PROPERTY,IDENTIFIER_PROPERTY_ATTRIBUTES),graphTypes.isUnboundRelationship=isUnboundRelationship;var PathSegment=function(e,t,r){this.start=e,this.relationship=t,this.end=r};function isPathSegment(e){return hasIdentifierProperty(e,PATH_SEGMENT_IDENTIFIER_PROPERTY)}graphTypes.PathSegment=PathSegment,Object.defineProperty(PathSegment.prototype,PATH_SEGMENT_IDENTIFIER_PROPERTY,IDENTIFIER_PROPERTY_ATTRIBUTES),graphTypes.isPathSegment=isPathSegment;var Path=function(e,t,r){this.start=e,this.end=t,this.segments=r,this.length=r.length};function isPath(e){return hasIdentifierProperty(e,PATH_IDENTIFIER_PROPERTY)}function _valueOrGetDefault(e,t){return null==e?t():e}graphTypes.Path=Path,Object.defineProperty(Path.prototype,PATH_IDENTIFIER_PROPERTY,IDENTIFIER_PROPERTY_ATTRIBUTES),graphTypes.isPath=isPath;var record={},__generator$n=commonjsGlobal&&commonjsGlobal.__generator||function(n,o){var i,a,s,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},c={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(c[Symbol.iterator]=function(){return this}),c;function e(r){return function(e){var t=[r,e];if(i)throw new TypeError("Generator is already executing.");for(;u=c&&t[c=0]?0:u;)try{if(i=1,a&&(s=2&t[0]?a.return:t[0]?a.throw||((s=a.return)&&s.call(a),0):a.next)&&!(s=s.call(a,t[1])).done)return s;switch(a=0,(t=s?[2&t[0],s.value]:t)[0]){case 0:case 1:s=t;break;case 4:return u.label++,{value:t[1],done:!1};case 5:u.label++,a=t[1],t=[0];continue;case 7:t=u.ops.pop(),u.trys.pop();continue;default:if(!(s=0<(s=u.trys).length&&s[s.length-1])&&(6===t[0]||2===t[0])){u=0;continue}if(3===t[0]&&(!s||t[1]>s[0]&&t[1]<s[3])){u.label=t[1];break}if(6===t[0]&&u.label<s[1]){u.label=s[1],s=t;break}if(s&&u.label<s[2]){u.label=s[2],u.ops.push(t);break}s[2]&&u.ops.pop(),u.trys.pop();continue}t=o.call(n,u)}catch(e){t=[6,e],a=0}finally{i=s=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}}},__values$c=commonjsGlobal&&commonjsGlobal.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return{value:(e=e&&n>=e.length?void 0:e)&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},__read$w=commonjsGlobal&&commonjsGlobal.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),a=[];try{for(;(void 0===t||0<t--)&&!(n=i.next()).done;)a.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a},error_1$b=(Object.defineProperty(record,"__esModule",{value:!0}),error);function generateFieldLookup(e){var r={};return e.forEach(function(e,t){r[e]=t}),r}var Record=function(){function e(e,t,r){this.keys=e,this.length=e.length,this._fields=t,this._fieldLookup=null!=r?r:generateFieldLookup(e)}return e.prototype.forEach=function(e){var t,r;try{for(var n=__values$c(this.entries()),o=n.next();!o.done;o=n.next()){var i=__read$w(o.value,2),a=i[0];e(i[1],a,this)}}catch(e){t={error:e}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(t)throw t.error}}},e.prototype.map=function(e){var t,r,n=[];try{for(var o=__values$c(this.entries()),i=o.next();!i.done;i=o.next()){var a=__read$w(i.value,2),s=a[0],u=a[1];n.push(e(u,s,this))}}catch(e){t={error:e}}finally{try{i&&!i.done&&(r=o.return)&&r.call(o)}finally{if(t)throw t.error}}return n},e.prototype.entries=function(){var t;return __generator$n(this,function(e){switch(e.label){case 0:t=0,e.label=1;case 1:return t<this.keys.length?[4,[this.keys[t],this._fields[t]]]:[3,4];case 2:e.sent(),e.label=3;case 3:return t++,[3,1];case 4:return[2]}})},e.prototype.values=function(){var t;return __generator$n(this,function(e){switch(e.label){case 0:t=0,e.label=1;case 1:return t<this.keys.length?[4,this._fields[t]]:[3,4];case 2:e.sent(),e.label=3;case 3:return t++,[3,1];case 4:return[2]}})},e.prototype[Symbol.iterator]=function(){var t;return __generator$n(this,function(e){switch(e.label){case 0:t=0,e.label=1;case 1:return t<this.keys.length?[4,this._fields[t]]:[3,4];case 2:e.sent(),e.label=3;case 3:return t++,[3,1];case 4:return[2]}})},e.prototype.toObject=function(){var t,e,r={};try{for(var n=__values$c(this.entries()),o=n.next();!o.done;o=n.next()){var i=__read$w(o.value,2),a=i[0],s=i[1];r[a]=s}}catch(e){t={error:e}}finally{try{o&&!o.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}return r},e.prototype.get=function(e){var t;if("number"!=typeof e){if(void 0===(t=this._fieldLookup[e]))throw(0,error_1$b.newError)("This record has no field with key '".concat(e.toString(),"', available keys are: [")+this.keys.toString()+"].")}else t=e;if(t>this._fields.length-1||t<0)throw(0,error_1$b.newError)("This record has no field with index '"+t.toString()+"'. Remember that indexes start at `0`, and make sure your query returns records in the shape you meant it to.");return this._fields[t]},e.prototype.has=function(e){return"number"==typeof e?0<=e&&e<this._fields.length:void 0!==this._fieldLookup[e]},e}(),spatialTypes=(record.default=Record,{}),util_1$6=(Object.defineProperty(spatialTypes,"__esModule",{value:!0}),spatialTypes.isPoint=spatialTypes.Point=void 0,util$4),POINT_IDENTIFIER_PROPERTY="__isPoint__",Point=function(){function e(e,t,r,n){this.srid=(0,util_1$6.assertNumberOrInteger)(e,"SRID"),this.x=(0,util_1$6.assertNumber)(t,"X coordinate"),this.y=(0,util_1$6.assertNumber)(r,"Y coordinate"),this.z=null==n?n:(0,util_1$6.assertNumber)(n,"Z coordinate"),Object.freeze(this)}return e.prototype.toString=function(){return null==this.z||isNaN(this.z)?"Point{srid=".concat(formatAsFloat(this.srid),", x=").concat(formatAsFloat(this.x),", y=").concat(formatAsFloat(this.y),"}"):"Point{srid=".concat(formatAsFloat(this.srid),", x=").concat(formatAsFloat(this.x),", y=").concat(formatAsFloat(this.y),", z=").concat(formatAsFloat(this.z),"}")},e}();function formatAsFloat(e){return Number.isInteger(e)?e.toString()+".0":e.toString()}function isPoint(e){return null!=e&&!0===e[POINT_IDENTIFIER_PROPERTY]}spatialTypes.Point=Point,Object.defineProperty(Point.prototype,POINT_IDENTIFIER_PROPERTY,{value:!0,enumerable:!1,configurable:!1,writable:!1}),spatialTypes.isPoint=isPoint;var resultSummary={},internal={},observers={},CompletedObserver$1=(Object.defineProperty(observers,"__esModule",{value:!0}),observers.FailedObserver=observers.CompletedObserver=void 0,function(){function e(){}return e.prototype.subscribe=function(e){apply(e,e.onKeys,[]),apply(e,e.onCompleted,{})},e.prototype.cancel=function(){},e.prototype.pause=function(){},e.prototype.resume=function(){},e.prototype.prepareToHandleSingleResponse=function(){},e.prototype.markCompleted=function(){},e.prototype.onError=function(e){throw new Error("CompletedObserver not supposed to call onError",{cause:e})},e}()),FailedObserver$1=(observers.CompletedObserver=CompletedObserver$1,function(){function e(e){var t=e.error,e=e.onError;this._error=t,this._beforeError=e,this._observers=[],this.onError(t)}return e.prototype.subscribe=function(e){apply(e,e.onError,this._error),this._observers.push(e)},e.prototype.onError=function(t){apply(this,this._beforeError,t),this._observers.forEach(function(e){return apply(e,e.onError,t)})},e.prototype.cancel=function(){},e.prototype.pause=function(){},e.prototype.resume=function(){},e.prototype.markCompleted=function(){},e.prototype.prepareToHandleSingleResponse=function(){},e}());function apply(e,t,r){null!=t&&t.bind(e)(r)}observers.FailedObserver=FailedObserver$1;var bookmarks$1={},__createBinding$a=commonjsGlobal&&commonjsGlobal.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&("get"in o?t.__esModule:!o.writable&&!o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,o)}:function(e,t,r,n){e[n=void 0===n?r:n]=t[r]}),__setModuleDefault$a=commonjsGlobal&&commonjsGlobal.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),__importStar$a=commonjsGlobal&&commonjsGlobal.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&__createBinding$a(t,e,r);return __setModuleDefault$a(t,e),t},__read$v=commonjsGlobal&&commonjsGlobal.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),a=[];try{for(;(void 0===t||0<t--)&&!(n=i.next()).done;)a.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a},__spreadArray$o=commonjsGlobal&&commonjsGlobal.__spreadArray||function(e,t,r){if(r||2===arguments.length)for(var n,o=0,i=t.length;o<i;o++)!n&&o in t||((n=n||Array.prototype.slice.call(t,0,o))[o]=t[o]);return e.concat(n||Array.prototype.slice.call(t))},util$2=(Object.defineProperty(bookmarks$1,"__esModule",{value:!0}),bookmarks$1.Bookmarks=void 0,__importStar$a(util$4)),BOOKMARKS_KEY="bookmarks",Bookmarks$4=function(){function e(e){this._values=asStringArray(e)}return e.empty=function(){return EMPTY_BOOKMARK},e.prototype.isEmpty=function(){return 0===this._values.length},e.prototype.values=function(){return this._values},e.prototype[Symbol.iterator]=function(){return this._values[Symbol.iterator]()},e.prototype.asBeginTransactionParameters=function(){var e;return this.isEmpty()?{}:((e={})[BOOKMARKS_KEY]=this._values,e)},e}(),EMPTY_BOOKMARK=new(bookmarks$1.Bookmarks=Bookmarks$4)(null);function asStringArray(e){if(null==e||""===e)return[];if(util$2.isString(e))return[e];if(Array.isArray(e)){for(var t=new Set,r=flattenArray(e),n=0;n<r.length;n++){var o=r[n];if(null!=o){if(!util$2.isString(o))throw new TypeError("Bookmark value should be a string, given: '".concat(o,"'"));t.add(o)}}return __spreadArray$o([],__read$v(t),!1)}throw new TypeError("Bookmarks should either be a string or a string array, given: '".concat(e,"'"))}function flattenArray(e){return e.reduce(function(e,t){return Array.isArray(t)?e.concat(flattenArray(t)):e.concat(t)},[])}var _a$i,constants$1={},FETCH_ALL$8=(Object.defineProperty(constants$1,"__esModule",{value:!0}),constants$1.TELEMETRY_APIS=constants$1.BOLT_PROTOCOL_V5_8=constants$1.BOLT_PROTOCOL_V5_7=constants$1.BOLT_PROTOCOL_V5_6=constants$1.BOLT_PROTOCOL_V5_5=constants$1.BOLT_PROTOCOL_V5_4=constants$1.BOLT_PROTOCOL_V5_3=constants$1.BOLT_PROTOCOL_V5_2=constants$1.BOLT_PROTOCOL_V5_1=constants$1.BOLT_PROTOCOL_V5_0=constants$1.BOLT_PROTOCOL_V4_4=constants$1.BOLT_PROTOCOL_V4_3=constants$1.BOLT_PROTOCOL_V4_2=constants$1.BOLT_PROTOCOL_V4_1=constants$1.BOLT_PROTOCOL_V4_0=constants$1.BOLT_PROTOCOL_V3=constants$1.BOLT_PROTOCOL_V2=constants$1.BOLT_PROTOCOL_V1=constants$1.DEFAULT_POOL_MAX_SIZE=constants$1.DEFAULT_POOL_ACQUISITION_TIMEOUT=constants$1.DEFAULT_CONNECTION_TIMEOUT_MILLIS=constants$1.ACCESS_MODE_WRITE=constants$1.ACCESS_MODE_READ=constants$1.FETCH_ALL=void 0,-1),DEFAULT_POOL_ACQUISITION_TIMEOUT=(constants$1.FETCH_ALL=FETCH_ALL$8,6e4),DEFAULT_POOL_MAX_SIZE=(constants$1.DEFAULT_POOL_ACQUISITION_TIMEOUT=DEFAULT_POOL_ACQUISITION_TIMEOUT,100),DEFAULT_CONNECTION_TIMEOUT_MILLIS=(constants$1.DEFAULT_POOL_MAX_SIZE=DEFAULT_POOL_MAX_SIZE,3e4),ACCESS_MODE_READ$2=(constants$1.DEFAULT_CONNECTION_TIMEOUT_MILLIS=DEFAULT_CONNECTION_TIMEOUT_MILLIS,"READ"),ACCESS_MODE_WRITE$2=(constants$1.ACCESS_MODE_READ=ACCESS_MODE_READ$2,"WRITE"),BOLT_PROTOCOL_V1$1=(constants$1.ACCESS_MODE_WRITE=ACCESS_MODE_WRITE$2,1),BOLT_PROTOCOL_V2$1=(constants$1.BOLT_PROTOCOL_V1=BOLT_PROTOCOL_V1$1,2),BOLT_PROTOCOL_V3$3=(constants$1.BOLT_PROTOCOL_V2=BOLT_PROTOCOL_V2$1,3),BOLT_PROTOCOL_V4_0$3=(constants$1.BOLT_PROTOCOL_V3=BOLT_PROTOCOL_V3$3,4),BOLT_PROTOCOL_V4_1$1=(constants$1.BOLT_PROTOCOL_V4_0=BOLT_PROTOCOL_V4_0$3,4.1),BOLT_PROTOCOL_V4_2$1=(constants$1.BOLT_PROTOCOL_V4_1=BOLT_PROTOCOL_V4_1$1,4.2),BOLT_PROTOCOL_V4_3$1=(constants$1.BOLT_PROTOCOL_V4_2=BOLT_PROTOCOL_V4_2$1,4.3),BOLT_PROTOCOL_V4_4$3=(constants$1.BOLT_PROTOCOL_V4_3=BOLT_PROTOCOL_V4_3$1,4.4),BOLT_PROTOCOL_V5_0$1=(constants$1.BOLT_PROTOCOL_V4_4=BOLT_PROTOCOL_V4_4$3,5),BOLT_PROTOCOL_V5_1$3=(constants$1.BOLT_PROTOCOL_V5_0=BOLT_PROTOCOL_V5_0$1,5.1),BOLT_PROTOCOL_V5_2$1=(constants$1.BOLT_PROTOCOL_V5_1=BOLT_PROTOCOL_V5_1$3,5.2),BOLT_PROTOCOL_V5_3$1=(constants$1.BOLT_PROTOCOL_V5_2=BOLT_PROTOCOL_V5_2$1,5.3),BOLT_PROTOCOL_V5_4$1=(constants$1.BOLT_PROTOCOL_V5_3=BOLT_PROTOCOL_V5_3$1,5.4),BOLT_PROTOCOL_V5_5$1=(constants$1.BOLT_PROTOCOL_V5_4=BOLT_PROTOCOL_V5_4$1,5.5),BOLT_PROTOCOL_V5_6$1=(constants$1.BOLT_PROTOCOL_V5_5=BOLT_PROTOCOL_V5_5$1,5.6),BOLT_PROTOCOL_V5_7$1=(constants$1.BOLT_PROTOCOL_V5_6=BOLT_PROTOCOL_V5_6$1,5.7),BOLT_PROTOCOL_V5_8$1=(constants$1.BOLT_PROTOCOL_V5_7=BOLT_PROTOCOL_V5_7$1,5.8),TELEMETRY_APIS$1=(constants$1.BOLT_PROTOCOL_V5_8=BOLT_PROTOCOL_V5_8$1,{MANAGED_TRANSACTION:0,UNMANAGED_TRANSACTION:1,AUTO_COMMIT_TRANSACTION:2,EXECUTE_QUERY:3}),connectionHolder$1=(constants$1.TELEMETRY_APIS=TELEMETRY_APIS$1,{}),logger$1={},__extends$R=commonjsGlobal&&commonjsGlobal.__extends||function(){var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}}(),error_1$a=(Object.defineProperty(logger$1,"__esModule",{value:!0}),logger$1.Logger=void 0,error),ERROR="error",WARN="warn",INFO="info",DEBUG="debug",DEFAULT_LEVEL=INFO,levels=((_a$i={})[ERROR]=0,_a$i[WARN]=1,_a$i[INFO]=2,_a$i[DEBUG]=3,_a$i),Logger$1=function(){function t(e,t){this._level=e,this._loggerFunction=t}return t.create=function(e){return null!=(null==e?void 0:e.logging)?new t(extractConfiguredLevel(e=e.logging),extractConfiguredLogger(e)):this.noOp()},t.noOp=function(){return noOpLogger},t.prototype.isErrorEnabled=function(){return isLevelEnabled(this._level,ERROR)},t.prototype.error=function(e){this.isErrorEnabled()&&this._loggerFunction(ERROR,e)},t.prototype.isWarnEnabled=function(){return isLevelEnabled(this._level,WARN)},t.prototype.warn=function(e){this.isWarnEnabled()&&this._loggerFunction(WARN,e)},t.prototype.isInfoEnabled=function(){return isLevelEnabled(this._level,INFO)},t.prototype.info=function(e){this.isInfoEnabled()&&this._loggerFunction(INFO,e)},t.prototype.isDebugEnabled=function(){return isLevelEnabled(this._level,DEBUG)},t.prototype.debug=function(e){this.isDebugEnabled()&&this._loggerFunction(DEBUG,e)},t}(),NoOpLogger=function(e){function t(){return e.call(this,INFO,function(e,t){})||this}return __extends$R(t,e),t.prototype.isErrorEnabled=function(){return!1},t.prototype.error=function(e){},t.prototype.isWarnEnabled=function(){return!1},t.prototype.warn=function(e){},t.prototype.isInfoEnabled=function(){return!1},t.prototype.info=function(e){},t.prototype.isDebugEnabled=function(){return!1},t.prototype.debug=function(e){},t}(logger$1.Logger=Logger$1),noOpLogger=new NoOpLogger;function isLevelEnabled(e,t){return levels[e]>=levels[t]}function extractConfiguredLevel(e){if(null==(null==e?void 0:e.level))return DEFAULT_LEVEL;var e=e.level,t=levels[e];if(null==t&&0!==t)throw(0,error_1$a.newError)("Illegal logging level: ".concat(e,". Supported levels are: ").concat(Object.keys(levels).toString()));return e}function extractConfiguredLogger(e){if(null!=(null==e?void 0:e.logger)){var t=e.logger;if(null!=t&&"function"==typeof t)return t}throw(0,error_1$a.newError)("Illegal logger function: ".concat(null!=(e=null==(t=null==e?void 0:e.logger)?void 0:t.toString())?e:"undefined"))}var __extends$Q=commonjsGlobal&&commonjsGlobal.__extends||function(){var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}}(),__awaiter$k=commonjsGlobal&&commonjsGlobal.__awaiter||function(e,a,s,u){return new(s=s||Promise)(function(r,t){function n(e){try{i(u.next(e))}catch(e){t(e)}}function o(e){try{i(u.throw(e))}catch(e){t(e)}}function i(e){var t;e.done?r(e.value):((t=e.value)instanceof s?t:new s(function(e){e(t)})).then(n,o)}i((u=u.apply(e,a||[])).next())})},__generator$m=commonjsGlobal&&commonjsGlobal.__generator||function(n,o){var i,a,s,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},c={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(c[Symbol.iterator]=function(){return this}),c;function e(r){return function(e){var t=[r,e];if(i)throw new TypeError("Generator is already executing.");for(;u=c&&t[c=0]?0:u;)try{if(i=1,a&&(s=2&t[0]?a.return:t[0]?a.throw||((s=a.return)&&s.call(a),0):a.next)&&!(s=s.call(a,t[1])).done)return s;switch(a=0,(t=s?[2&t[0],s.value]:t)[0]){case 0:case 1:s=t;break;case 4:return u.label++,{value:t[1],done:!1};case 5:u.label++,a=t[1],t=[0];continue;case 7:t=u.ops.pop(),u.trys.pop();continue;default:if(!(s=0<(s=u.trys).length&&s[s.length-1])&&(6===t[0]||2===t[0])){u=0;continue}if(3===t[0]&&(!s||t[1]>s[0]&&t[1]<s[3])){u.label=t[1];break}if(6===t[0]&&u.label<s[1]){u.label=s[1],s=t;break}if(s&&u.label<s[2]){u.label=s[2],u.ops.push(t);break}s[2]&&u.ops.pop(),u.trys.pop();continue}t=o.call(n,u)}catch(e){t=[6,e],a=0}finally{i=s=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}}},error_1$9=(Object.defineProperty(connectionHolder$1,"__esModule",{value:!0}),connectionHolder$1.EMPTY_CONNECTION_HOLDER=connectionHolder$1.ReadOnlyConnectionHolder=connectionHolder$1.ConnectionHolder=void 0,error),util_1$5=util$4,constants_1$4=constants$1,bookmarks_1$3=bookmarks$1,logger_1$2=logger$1,ConnectionHolder=function(){function e(e){var t=e.mode,r=e.database,r=void 0===r?"":r,n=e.bookmarks,o=e.connectionProvider,i=e.impersonatedUser,a=e.onDatabaseNameResolved,s=e.getConnectionAcquistionBookmarks,u=e.auth,e=e.log;this._mode=null!=t?t:constants_1$4.ACCESS_MODE_WRITE,this._closed=!1,this._database=null!=r?(0,util_1$5.assertString)(r,"database"):"",this._bookmarks=null!=n?n:bookmarks_1$3.Bookmarks.empty(),this._connectionProvider=o,this._impersonatedUser=i,this._referenceCount=0,this._connectionPromise=Promise.resolve(null),this._onDatabaseNameResolved=a,this._auth=u,this._log=e,this._logError=this._logError.bind(this),this._getConnectionAcquistionBookmarks=null!=s?s:function(){return Promise.resolve(bookmarks_1$3.Bookmarks.empty())}}return e.prototype.mode=function(){return this._mode},e.prototype.database=function(){return this._database},e.prototype.setDatabase=function(e){this._database=e},e.prototype.bookmarks=function(){return this._bookmarks},e.prototype.connectionProvider=function(){return this._connectionProvider},e.prototype.referenceCount=function(){return this._referenceCount},e.prototype.initializeConnection=function(e){return 0!==this._referenceCount||null==this._connectionProvider?(this._referenceCount++,!1):(this._connectionPromise=this._createConnectionPromise(this._connectionProvider,e),this._referenceCount++,!0)},e.prototype._createConnectionPromise=function(o,i){return __awaiter$k(this,void 0,void 0,function(){var t,r,n;return __generator$m(this,function(e){switch(e.label){case 0:return r=(t=o).acquireConnection,n={accessMode:this._mode,database:this._database},[4,this._getBookmarks()];case 1:return[4,r.apply(t,[(n.bookmarks=e.sent(),n.impersonatedUser=this._impersonatedUser,n.onDatabaseNameResolved=this._onDatabaseNameResolved,n.auth=this._auth,n.homeDb=i,n)])];case 2:return[2,e.sent()]}})})},e.prototype._getBookmarks=function(){return __awaiter$k(this,void 0,void 0,function(){return __generator$m(this,function(e){switch(e.label){case 0:return[4,this._getConnectionAcquistionBookmarks()];case 1:return[2,e.sent()]}})})},e.prototype.getConnection=function(){return this._connectionPromise},e.prototype.releaseConnection=function(){return 0===this._referenceCount?this._connectionPromise:(this._referenceCount--,0===this._referenceCount?this._releaseConnection():this._connectionPromise)},e.prototype.close=function(e){return this._closed=!0,0===this._referenceCount?this._connectionPromise:(this._referenceCount=0,this._releaseConnection(e))},e.prototype.log=function(){return this._log},e.prototype._releaseConnection=function(t){return this._connectionPromise=this._connectionPromise.then(function(e){return null!=e?e.isOpen()&&(e.hasOngoingObservableRequests()||!0===t)?e.resetAndFlush().catch(ignoreError).then(function(){return e.release().then(function(){return null})}):e.release().then(function(){return null}):Promise.resolve(null)}).catch(this._logError),this._connectionPromise},e.prototype._logError=function(e){return this._log.isWarnEnabled()&&this._log.warn("ConnectionHolder got an error while releasing the connection. Error ".concat(e,". Stacktrace: ").concat(e.stack)),null},e}(),ReadOnlyConnectionHolder=function(r){function e(e){var t=r.call(this,{mode:e.mode(),database:e.database(),bookmarks:e.bookmarks(),getConnectionAcquistionBookmarks:e._getConnectionAcquistionBookmarks,connectionProvider:e.connectionProvider(),log:e.log()})||this;return t._connectionHolder=e,t}return __extends$Q(e,r),e.prototype.initializeConnection=function(){return 0!==this._connectionHolder.referenceCount()},e.prototype.getConnection=function(){return this._connectionHolder.getConnection()},e.prototype.releaseConnection=function(){return this._connectionHolder.getConnection().catch(function(){return Promise.resolve(null)})},e.prototype.close=function(){return this._connectionHolder.getConnection().catch(function(){return Promise.resolve(null)})},e}(connectionHolder$1.ConnectionHolder=ConnectionHolder),EmptyConnectionHolder=(connectionHolder$1.ReadOnlyConnectionHolder=ReadOnlyConnectionHolder,connectionHolder$1.default=ReadOnlyConnectionHolder,function(e){function t(){return e.call(this,{log:logger_1$2.Logger.create({})})||this}return __extends$Q(t,e),t.prototype.mode=function(){},t.prototype.database=function(){},t.prototype.initializeConnection=function(){return!0},t.prototype.getConnection=function(){return __awaiter$k(this,void 0,void 0,function(){return __generator$m(this,function(e){switch(e.label){case 0:return[4,Promise.reject((0,error_1$9.newError)("This connection holder does not serve connections"))];case 1:return[2,e.sent()]}})})},t.prototype.releaseConnection=function(){return __awaiter$k(this,void 0,void 0,function(){return __generator$m(this,function(e){switch(e.label){case 0:return[4,Promise.resolve(null)];case 1:return[2,e.sent()]}})})},t.prototype.close=function(){return __awaiter$k(this,void 0,void 0,function(){return __generator$m(this,function(e){switch(e.label){case 0:return[4,Promise.resolve(null)];case 1:return[2,e.sent()]}})})},t}(ConnectionHolder)),EMPTY_CONNECTION_HOLDER$1=new EmptyConnectionHolder;function ignoreError(e){return null}connectionHolder$1.EMPTY_CONNECTION_HOLDER=EMPTY_CONNECTION_HOLDER$1;var txConfig$1={},__createBinding$9=commonjsGlobal&&commonjsGlobal.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&("get"in o?t.__esModule:!o.writable&&!o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,o)}:function(e,t,r,n){e[n=void 0===n?r:n]=t[r]}),__setModuleDefault$9=commonjsGlobal&&commonjsGlobal.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),__importStar$9=commonjsGlobal&&commonjsGlobal.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&__createBinding$9(t,e,r);return __setModuleDefault$9(t,e),t},util$1=(Object.defineProperty(txConfig$1,"__esModule",{value:!0}),txConfig$1.TxConfig=void 0,__importStar$9(util$4)),error_1$8=error,integer_1=integer,TxConfig$4=function(){function e(e,t){assertValidConfig(e),this.timeout=extractTimeout(e,t),this.metadata=extractMetadata(e)}return e.empty=function(){return EMPTY_CONFIG},e.prototype.isEmpty=function(){return Object.values(this).every(function(e){return null==e})},e}(),EMPTY_CONFIG=new(txConfig$1.TxConfig=TxConfig$4)({});function extractTimeout(e,t){if(util$1.isObject(e)&&null!=e.timeout){util$1.assertNumberOrInteger(e.timeout,"Transaction timeout"),isTimeoutFloat(e)&&!0===(null==t?void 0:t.isInfoEnabled())&&null!=t&&t.info("Transaction timeout expected to be an integer, got: ".concat(e.timeout,". The value will be rounded up."));t=(0,integer_1.int)(e.timeout,{ceilFloat:!0});if(t.isNegative())throw(0,error_1$8.newError)("Transaction timeout should not be negative");return t}return null}function isTimeoutFloat(e){return"number"==typeof e.timeout&&!Number.isInteger(e.timeout)}function extractMetadata(e){if(util$1.isObject(e)&&null!=e.metadata){e=e.metadata;if(util$1.assertObject(e,"config.metadata"),0!==Object.keys(e).length)return e}return null}function assertValidConfig(e){null!=e&&util$1.assertObject(e,"Transaction config")}var transactionExecutor$1={},__assign$x=commonjsGlobal&&commonjsGlobal.__assign||function(){return(__assign$x=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},__awaiter$j=commonjsGlobal&&commonjsGlobal.__awaiter||function(e,a,s,u){return new(s=s||Promise)(function(r,t){function n(e){try{i(u.next(e))}catch(e){t(e)}}function o(e){try{i(u.throw(e))}catch(e){t(e)}}function i(e){var t;e.done?r(e.value):((t=e.value)instanceof s?t:new s(function(e){e(t)})).then(n,o)}i((u=u.apply(e,a||[])).next())})},__generator$l=commonjsGlobal&&commonjsGlobal.__generator||function(n,o){var i,a,s,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},c={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(c[Symbol.iterator]=function(){return this}),c;function e(r){return function(e){var t=[r,e];if(i)throw new TypeError("Generator is already executing.");for(;u=c&&t[c=0]?0:u;)try{if(i=1,a&&(s=2&t[0]?a.return:t[0]?a.throw||((s=a.return)&&s.call(a),0):a.next)&&!(s=s.call(a,t[1])).done)return s;switch(a=0,(t=s?[2&t[0],s.value]:t)[0]){case 0:case 1:s=t;break;case 4:return u.label++,{value:t[1],done:!1};case 5:u.label++,a=t[1],t=[0];continue;case 7:t=u.ops.pop(),u.trys.pop();continue;default:if(!(s=0<(s=u.trys).length&&s[s.length-1])&&(6===t[0]||2===t[0])){u=0;continue}if(3===t[0]&&(!s||t[1]>s[0]&&t[1]<s[3])){u.label=t[1];break}if(6===t[0]&&u.label<s[1]){u.label=s[1],s=t;break}if(s&&u.label<s[2]){u.label=s[2],u.ops.push(t);break}s[2]&&u.ops.pop(),u.trys.pop();continue}t=o.call(n,u)}catch(e){t=[6,e],a=0}finally{i=s=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}}},__read$u=commonjsGlobal&&commonjsGlobal.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),a=[];try{for(;(void 0===t||0<t--)&&!(n=i.next()).done;)a.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a},__spreadArray$n=commonjsGlobal&&commonjsGlobal.__spreadArray||function(e,t,r){if(r||2===arguments.length)for(var n,o=0,i=t.length;o<i;o++)!n&&o in t||((n=n||Array.prototype.slice.call(t,0,o))[o]=t[o]);return e.concat(n||Array.prototype.slice.call(t))},error_1$7=(Object.defineProperty(transactionExecutor$1,"__esModule",{value:!0}),transactionExecutor$1.TransactionExecutor=void 0,error),constants_1$3=constants$1,DEFAULT_MAX_RETRY_TIME_MS$1=3e4,DEFAULT_INITIAL_RETRY_DELAY_MS$1=1e3,DEFAULT_RETRY_DELAY_MULTIPLIER$1=2,DEFAULT_RETRY_DELAY_JITTER_FACTOR$1=.2;function setTimeoutWrapper(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];return setTimeout.apply(void 0,__spreadArray$n([e,t],__read$u(r),!1))}function clearTimeoutWrapper(e){return clearTimeout(e)}var TransactionExecutor=function(){function e(e,t,r,n,o){void 0===o&&(o={setTimeout:setTimeoutWrapper,clearTimeout:clearTimeoutWrapper}),this._maxRetryTimeMs=_valueOrDefault(e,DEFAULT_MAX_RETRY_TIME_MS$1),this._initialRetryDelayMs=_valueOrDefault(t,DEFAULT_INITIAL_RETRY_DELAY_MS$1),this._multiplier=_valueOrDefault(r,DEFAULT_RETRY_DELAY_MULTIPLIER$1),this._jitterFactor=_valueOrDefault(n,DEFAULT_RETRY_DELAY_JITTER_FACTOR$1),this._setTimeout=o.setTimeout,this._clearTimeout=o.clearTimeout,this._inFlightTimeoutIds=[],this.pipelineBegin=!1,this.telemetryApi=constants_1$3.TELEMETRY_APIS.MANAGED_TRANSACTION,this._verifyAfterConstruction()}return e.prototype.execute=function(n,o,i){var a=this,s={apiTransactionConfig:{api:this.telemetryApi,onTelemetrySuccess:function(){s.apiTransactionConfig=void 0}}};return new Promise(function(e,t){a._executeTransactionInsidePromise(n,o,e,t,i,s).catch(t)}).catch(function(e){var t=Date.now(),r=a._initialRetryDelayMs;return a._retryTransactionPromise(n,o,e,t,r,i,s)})},e.prototype.close=function(){var t=this;this._inFlightTimeoutIds.forEach(function(e){return t._clearTimeout(e)}),this._inFlightTimeoutIds=[]},e.prototype._retryTransactionPromise=function(o,i,e,r,a,s,u){var c=this;return Date.now()-r>this._maxRetryTimeMs||!(0,error_1$7.isRetriableError)(e)?Promise.reject(e):new Promise(function(e,t){var r=c._computeDelayWithJitter(a),n=c._setTimeout(function(){c._inFlightTimeoutIds=c._inFlightTimeoutIds.filter(function(e){return e!==n}),c._executeTransactionInsidePromise(o,i,e,t,s,u).catch(t)},r);c._inFlightTimeoutIds.push(n)}).catch(function(e){var t=a*c._multiplier;return c._retryTransactionPromise(o,i,e,r,t,s,u)})},e.prototype._executeTransactionInsidePromise=function(a,s,u,c,l,f){return __awaiter$j(this,void 0,void 0,function(){var t,r,n,o,i=this;return __generator$l(this,function(e){switch(e.label){case 0:return(e.trys.push([0,4,,5]),r=a(null!=(null==f?void 0:f.apiTransactionConfig)?__assign$x({},null==f?void 0:f.apiTransactionConfig):void 0),this.pipelineBegin)?(n=r,[3,3]):[3,1];case 1:return[4,r];case 2:n=e.sent(),e.label=3;case 3:return t=n,[3,5];case 4:return o=e.sent(),c(o),[2];case 5:return o=(null!=l?l:function(e){return e})(t),this._safeExecuteTransactionWork(o,s).then(function(e){return i._handleTransactionWorkSuccess(e,t,u,c)}).catch(function(e){return i._handleTransactionWorkFailure(e,t,c)}),[2]}})})},e.prototype._safeExecuteTransactionWork=function(e,t){try{var r=t(e);return Promise.resolve(r)}catch(e){return Promise.reject(e)}},e.prototype._handleTransactionWorkSuccess=function(e,t,r,n){t.isOpen()?t.commit().then(function(){r(e)}).catch(function(e){n(e)}):r(e)},e.prototype._handleTransactionWorkFailure=function(e,t,r){t.isOpen()?t.rollback().catch(function(e){}).then(function(){return r(e)}).catch(r):r(e)},e.prototype._computeDelayWithJitter=function(e){var t=e*this._jitterFactor,r=e-t,e=e+t;return Math.random()*(e-r)+r},e.prototype._verifyAfterConstruction=function(){if(this._maxRetryTimeMs<0)throw(0,error_1$7.newError)("Max retry time should be >= 0: "+this._maxRetryTimeMs.toString());if(this._initialRetryDelayMs<0)throw(0,error_1$7.newError)("Initial retry delay should >= 0: "+this._initialRetryDelayMs.toString());if(this._multiplier<1)throw(0,error_1$7.newError)("Multiplier should be >= 1.0: "+this._multiplier.toString());if(this._jitterFactor<0||1<this._jitterFactor)throw(0,error_1$7.newError)("Jitter factor should be in [0.0, 1.0]: "+this._jitterFactor.toFixed())},e}();function _valueOrDefault(e,t){return null!=e?e:t}transactionExecutor$1.TransactionExecutor=TransactionExecutor;var urlUtil$2={},__assign$w=commonjsGlobal&&commonjsGlobal.__assign||function(){return(__assign$w=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},__read$t=commonjsGlobal&&commonjsGlobal.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),a=[];try{for(;(void 0===t||0<t--)&&!(n=i.next()).done;)a.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a},util_1$4=(Object.defineProperty(urlUtil$2,"__esModule",{value:!0}),urlUtil$2.Url=urlUtil$2.formatIPv6Address=urlUtil$2.formatIPv4Address=urlUtil$2.defaultPortForScheme=urlUtil$2.parseDatabaseUrl=void 0,util$4),DEFAULT_BOLT_PORT=7687,DEFAULT_HTTP_PORT=7474,DEFAULT_HTTPS_PORT=7473,Url=function(e,t,r,n,o){this.scheme=e,this.host=t,this.port=r,this.hostAndPort=n,this.query=o};function parseDatabaseUrl(e){(0,util_1$4.assertString)(e,"URL");var t=sanitizeUrl(e),r=uriJsParse(t.url),t=t.schemeMissing?null:extractScheme(r.scheme),n=extractHost(r.host),o=formatHost(n),i=extractPort(r.port,t),o="".concat(o,":").concat(i),a=extractQuery(null!=(a=r.query)?a:extractResourceQueryString(r.resourceName),e);return new Url(t,n,i,o,a)}function extractResourceQueryString(e){return"string"!=typeof e?null:__read$t(e.split("?"),2)[1]}function sanitizeUrl(e){return(e=e.trim()).includes("://")?{schemeMissing:!1,url:e}:{schemeMissing:!0,url:"none://".concat(e)}}function extractScheme(e){return null!=e?":"===(e=e.trim()).charAt(e.length-1)?e.substring(0,e.length-1):e:null}function extractHost(e,t){if(null==e)throw new Error("Unable to extract host from null or undefined URL");return e.trim()}function extractPort(e,t){e="string"==typeof e?parseInt(e,10):e;return null==e||isNaN(e)?defaultPortForScheme(t):e}function extractQuery(e,r){var e=null!=e?trimAndSanitizeQuery(e):null,n={};return null!=e&&e.split("&").forEach(function(e){e=e.split("=");if(2!==e.length)throw new Error("Invalid parameters: '".concat(e.toString(),"' in URL '").concat(r,"'."));var t=trimAndVerifyQueryElement(e[0],"key",r),e=trimAndVerifyQueryElement(e[1],"value",r);if(void 0!==n[t])throw new Error("Duplicated query parameters with key '".concat(t,"' in URL '").concat(r,"'"));n[t]=e}),n}function trimAndSanitizeQuery(e){return e="?"===(null==(e=(null!=e?e:"").trim())?void 0:e.charAt(0))?e.substring(1,e.length):e}function trimAndVerifyQueryElement(e,t,r){if(""===(e=(null!=e?e:"").trim()))throw new Error("Illegal empty ".concat(t," in URL query '").concat(r,"'"));return e}function escapeIPv6Address(e){var t="["===e.charAt(0),r="]"===e.charAt(e.length-1);if(t||r){if(t&&r)return e;throw new Error("Illegal IPv6 address ".concat(e))}return"[".concat(e,"]")}function formatHost(e){if(""===e||null==e)throw new Error("Illegal host ".concat(e));return e.includes(":")?escapeIPv6Address(e):e}function formatIPv4Address(e,t){return"".concat(e,":").concat(t)}function formatIPv6Address(e,t){e=escapeIPv6Address(e);return"".concat(e,":").concat(t)}function defaultPortForScheme(e){return"http"===e?DEFAULT_HTTP_PORT:"https"===e?DEFAULT_HTTPS_PORT:DEFAULT_BOLT_PORT}function uriJsParse(e){function a(e,t){t=e.indexOf(t);return 0<=t?[e.substring(0,t),e[t],e.substring(t+1)]:[e,"",""]}function t(e){var t,r={},n=((t="@")===(t=0<=(t=(o=e).lastIndexOf(t))?[o.substring(0,t),o[t],o.substring(t+1)]:["","",o])[1]&&(r.userInfo=decodeURIComponent(t[0]),e=t[2]),__read$t((o="]",n=a(n=e,i="["),[(i=a(n[2],o))[0],i[2]]),2)),o=n[0],i=n[1];return""!==o?(r.host=o,t=a(i,":")):(t=a(e,":"),r.host=t[0]),":"===t[1]&&(r.port=t[2]),r}var r={},n=a(e,":");return":"===n[1]&&(r.scheme=decodeURIComponent(n[0]),e=n[2]),"#"===(n=a(e,"#"))[1]&&(r.fragment=decodeURIComponent(n[2]),e=n[0]),"?"===(n=a(e,"?"))[1]&&(r.query=n[2],e=n[0]),e.startsWith("//")?(n=a(e.substr(2),"/"),(r=__assign$w(__assign$w({},r),t(n[0]))).path=n[1]+n[2]):r.path=e,r}urlUtil$2.Url=Url,urlUtil$2.parseDatabaseUrl=parseDatabaseUrl,urlUtil$2.formatIPv4Address=formatIPv4Address,urlUtil$2.formatIPv6Address=formatIPv6Address,urlUtil$2.defaultPortForScheme=defaultPortForScheme;var serverAddress$1={},__createBinding$8=commonjsGlobal&&commonjsGlobal.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&("get"in o?t.__esModule:!o.writable&&!o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,o)}:function(e,t,r,n){e[n=void 0===n?r:n]=t[r]}),__setModuleDefault$8=commonjsGlobal&&commonjsGlobal.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),__importStar$8=commonjsGlobal&&commonjsGlobal.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&__createBinding$8(t,e,r);return __setModuleDefault$8(t,e),t},util_1$3=(Object.defineProperty(serverAddress$1,"__esModule",{value:!0}),serverAddress$1.ServerAddress=void 0,util$4),urlUtil$1=__importStar$8(urlUtil$2),ServerAddress$1=function(){function t(e,t,r,n){this._host=(0,util_1$3.assertString)(e,"host"),this._resolved=null!=t?(0,util_1$3.assertString)(t,"resolved"):null,this._port=(0,util_1$3.assertNumber)(r,"port"),this._hostPort=n,this._stringValue=null!=t?"".concat(n,"(").concat(t,")"):"".concat(n)}return t.prototype.host=function(){return this._host},t.prototype.resolvedHost=function(){return null!=this._resolved?this._resolved:this._host},t.prototype.port=function(){return this._port},t.prototype.resolveWith=function(e){return new t(this._host,e,this._port,this._hostPort)},t.prototype.asHostPort=function(){return this._hostPort},t.prototype.asKey=function(){return this._hostPort},t.prototype.toString=function(){return this._stringValue},t.fromUrl=function(e){e=urlUtil$1.parseDatabaseUrl(e);return new t(e.host,null,e.port,e.hostAndPort)},t}(),resolver$1=(serverAddress$1.ServerAddress=ServerAddress$1,{}),baseHostNameResolver={},BaseHostNameResolver$1=(Object.defineProperty(baseHostNameResolver,"__esModule",{value:!0}),function(){function e(){}return e.prototype.resolve=function(){throw new Error("Abstract function")},e.prototype._resolveToItself=function(e){return Promise.resolve([e])},e}()),configuredCustomResolver=(baseHostNameResolver.default=BaseHostNameResolver$1,{}),server_address_1=(Object.defineProperty(configuredCustomResolver,"__esModule",{value:!0}),serverAddress$1);function resolveToSelf(e){return Promise.resolve([e])}var ConfiguredCustomResolver=function(){function e(e){this._resolverFunction=null!=e?e:resolveToSelf}return e.prototype.resolve=function(t){var r=this;return new Promise(function(e){return e(r._resolverFunction(t.asHostPort()))}).then(function(e){if(Array.isArray(e))return e.map(function(e){return server_address_1.ServerAddress.fromUrl(e)});throw new TypeError("Configured resolver function should either return an array of addresses or a Promise resolved with an array of addresses."+"Each address is '<host>:<port>'. Got: ".concat(e))})},e}(),__importDefault$10=(configuredCustomResolver.default=ConfiguredCustomResolver,commonjsGlobal&&commonjsGlobal.__importDefault||function(e){return e&&e.__esModule?e:{default:e}}),base_host_name_resolver_1=(Object.defineProperty(resolver$1,"__esModule",{value:!0}),resolver$1.ConfiguredCustomResolver=resolver$1.BaseHostNameResolver=void 0,__importDefault$10(baseHostNameResolver)),configured_custom_resolver_1$1=(resolver$1.BaseHostNameResolver=base_host_name_resolver_1.default,__importDefault$10(configuredCustomResolver)),browser$1=(resolver$1.ConfiguredCustomResolver=configured_custom_resolver_1$1.default,{}),boltAgent$1={};function fromVersion(e,t){var t=(t=void 0===t?function(){return{get userAgent(){}}}:t)(),r=null!=t.userAgent?t.userAgent.split("(")[1].split(")")[0]:void 0,t=t.userAgent||void 0;return{product:"neo4j-javascript/".concat(e),platform:r,languageDetails:t}}Object.defineProperty(boltAgent$1,"__esModule",{value:!0}),boltAgent$1.fromVersion=void 0,boltAgent$1.fromVersion=fromVersion,function(e){var n=commonjsGlobal&&commonjsGlobal.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&("get"in o?t.__esModule:!o.writable&&!o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,o)}:function(e,t,r,n){e[n=void 0===n?r:n]=t[r]}),t=commonjsGlobal&&commonjsGlobal.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(e,"__esModule",{value:!0}),t(boltAgent$1,e)}(browser$1);var pool$2={},poolConfig={},DEFAULT_MAX_SIZE=(Object.defineProperty(poolConfig,"__esModule",{value:!0}),poolConfig.DEFAULT_ACQUISITION_TIMEOUT=poolConfig.DEFAULT_MAX_SIZE=void 0,100),DEFAULT_ACQUISITION_TIMEOUT=(poolConfig.DEFAULT_MAX_SIZE=DEFAULT_MAX_SIZE,6e4),PoolConfig$1=(poolConfig.DEFAULT_ACQUISITION_TIMEOUT=DEFAULT_ACQUISITION_TIMEOUT,function(){function t(e,t){this.maxSize=valueOrDefault$2(e,DEFAULT_MAX_SIZE),this.acquisitionTimeout=valueOrDefault$2(t,DEFAULT_ACQUISITION_TIMEOUT)}return t.defaultConfig=function(){return new t(DEFAULT_MAX_SIZE,DEFAULT_ACQUISITION_TIMEOUT)},t.fromDriverConfig=function(e){return new t(isConfigured(e.maxConnectionPoolSize)?e.maxConnectionPoolSize:DEFAULT_MAX_SIZE,isConfigured(e.connectionAcquisitionTimeout)?e.connectionAcquisitionTimeout:DEFAULT_ACQUISITION_TIMEOUT)},t}());function valueOrDefault$2(e,t){return isConfigured(e)?e:t}function isConfigured(e){return 0===e||null!=e}poolConfig.default=PoolConfig$1;var pool$1={},__awaiter$i=commonjsGlobal&&commonjsGlobal.__awaiter||function(e,a,s,u){return new(s=s||Promise)(function(r,t){function n(e){try{i(u.next(e))}catch(e){t(e)}}function o(e){try{i(u.throw(e))}catch(e){t(e)}}function i(e){var t;e.done?r(e.value):((t=e.value)instanceof s?t:new s(function(e){e(t)})).then(n,o)}i((u=u.apply(e,a||[])).next())})},__generator$k=commonjsGlobal&&commonjsGlobal.__generator||function(n,o){var i,a,s,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},c={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(c[Symbol.iterator]=function(){return this}),c;function e(r){return function(e){var t=[r,e];if(i)throw new TypeError("Generator is already executing.");for(;u=c&&t[c=0]?0:u;)try{if(i=1,a&&(s=2&t[0]?a.return:t[0]?a.throw||((s=a.return)&&s.call(a),0):a.next)&&!(s=s.call(a,t[1])).done)return s;switch(a=0,(t=s?[2&t[0],s.value]:t)[0]){case 0:case 1:s=t;break;case 4:return u.label++,{value:t[1],done:!1};case 5:u.label++,a=t[1],t=[0];continue;case 7:t=u.ops.pop(),u.trys.pop();continue;default:if(!(s=0<(s=u.trys).length&&s[s.length-1])&&(6===t[0]||2===t[0])){u=0;continue}if(3===t[0]&&(!s||t[1]>s[0]&&t[1]<s[3])){u.label=t[1];break}if(6===t[0]&&u.label<s[1]){u.label=s[1],s=t;break}if(s&&u.label<s[2]){u.label=s[2],u.ops.push(t);break}s[2]&&u.ops.pop(),u.trys.pop();continue}t=o.call(n,u)}catch(e){t=[6,e],a=0}finally{i=s=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}}},__importDefault$$=commonjsGlobal&&commonjsGlobal.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},pool_config_1=(Object.defineProperty(pool$1,"__esModule",{value:!0}),__importDefault$$(poolConfig)),error_1$6=error,logger_1$1=logger$1,Pool$1=function(){function e(e){var t=e.create,t=void 0===t?function(e,t,r){return __awaiter$i(u,void 0,void 0,function(){return __generator$k(this,function(e){switch(e.label){case 0:return[4,Promise.reject(new Error("Not implemented"))];case 1:return[2,e.sent()]}})})}:t,r=e.destroy,r=void 0===r?function(e){return __awaiter$i(u,void 0,void 0,function(){return __generator$k(this,function(e){switch(e.label){case 0:return[4,Promise.resolve()];case 1:return[2,e.sent()]}})})}:r,n=e.validateOnAcquire,n=void 0===n?function(e,t){return!0}:n,o=e.validateOnRelease,o=void 0===o?function(e){return!0}:o,i=e.installIdleObserver,i=void 0===i?function(e,t){}:i,a=e.removeIdleObserver,a=void 0===a?function(e){}:a,s=e.config,s=void 0===s?pool_config_1.default.defaultConfig():s,e=e.log,e=void 0===e?logger_1$1.Logger.noOp():e,u=this;this._create=t,this._destroy=r,this._validateOnAcquire=n,this._validateOnRelease=o,this._installIdleObserver=i,this._removeIdleObserver=a,this._maxSize=s.maxSize,this._acquisitionTimeout=s.acquisitionTimeout,this._pools={},this._pendingCreates={},this._acquireRequests={},this._activeResourceCounts={},this._release=this._release.bind(this),this._log=e,this._closed=!1}return e.prototype.acquire=function(s,u,c){return __awaiter$i(this,void 0,void 0,function(){var o,i,a=this;return __generator$k(this,function(e){switch(e.label){case 0:return o=u.asKey(),i=this._acquireRequests,null==i[o]&&(i[o]=[]),[4,new Promise(function(e,t){var r=setTimeout(function(){var e,t=i[o];null!=t&&(i[o]=t.filter(function(e){return e!==n})),n.isCompleted()||(t=a.activeResourceCount(u),e=a.has(u)?a._pools[o].length:0,n.reject((0,error_1$6.newError)("Connection acquisition timed out in ".concat(a._acquisitionTimeout," ms. Pool status: Active conn count = ").concat(t,", Idle conn count = ").concat(e,"."))))},a._acquisitionTimeout),n=("object"==typeof r&&r.unref(),new PendingRequest(o,s,c,e,t,r,a._log));i[o].push(n),a._processPendingAcquireRequests(u)})];case 1:return[2,e.sent()]}})})},e.prototype.purge=function(t){return __awaiter$i(this,void 0,void 0,function(){return __generator$k(this,function(e){switch(e.label){case 0:return[4,this._purgeKey(t.asKey())];case 1:return[2,e.sent()]}})})},e.prototype.apply=function(e,t){e=e.asKey();e in this._pools&&this._pools[e].apply(t)},e.prototype.close=function(){return __awaiter$i(this,void 0,void 0,function(){var r=this;return __generator$k(this,function(e){switch(e.label){case 0:return this._closed=!0,[4,Promise.all(Object.keys(this._pools).map(function(t){return __awaiter$i(r,void 0,void 0,function(){return __generator$k(this,function(e){switch(e.label){case 0:return[4,this._purgeKey(t)];case 1:return[2,e.sent()]}})})})).then()];case 1:return[2,e.sent()]}})})},e.prototype.keepAll=function(o){return __awaiter$i(this,void 0,void 0,function(){var t,r,n=this;return __generator$k(this,function(e){switch(e.label){case 0:return t=o.map(function(e){return e.asKey()}),r=Object.keys(this._pools),r=r.filter(function(e){return!t.includes(e)}),[4,Promise.all(r.map(function(t){return __awaiter$i(n,void 0,void 0,function(){return __generator$k(this,function(e){switch(e.label){case 0:return[4,this._purgeKey(t)];case 1:return[2,e.sent()]}})})})).then()];case 1:return[2,e.sent()]}})})},e.prototype.has=function(e){return e.asKey()in this._pools},e.prototype.activeResourceCount=function(e){return null!=(e=this._activeResourceCounts[e.asKey()])?e:0},e.prototype._getOrInitializePoolFor=function(e){var t=this._pools[e];return null==t&&(t=new SingleAddressPool,this._pools[e]=t,this._pendingCreates[e]=0),t},e.prototype._acquire=function(c,l,f){return __awaiter$i(this,void 0,void 0,function(){var t,n,r,o,i,a,s,u=this;return __generator$k(this,function(e){switch(e.label){case 0:if(this._closed)throw(0,error_1$6.newError)("Pool is closed, it is no more able to serve requests.");if(t=l.asKey(),n=this._getOrInitializePoolFor(t),f)return[3,10];e.label=1;case 1:if(!(0<n.length))return[3,10];if(null==(r=n.pop()))return[3,1];resourceAcquired(t,this._activeResourceCounts),null!=this._removeIdleObserver&&this._removeIdleObserver(r),o=!1,e.label=2;case 2:return e.trys.push([2,4,,6]),[4,this._validateOnAcquire(c,r)];case 3:return o=e.sent(),[3,6];case 4:return i=e.sent(),resourceReleased(t,this._activeResourceCounts),n.removeInUse(r),[4,this._destroy(r)];case 5:throw e.sent(),i;case 6:return o?(this._log.isDebugEnabled()&&this._log.debug("".concat(r," acquired from the pool ").concat(t)),[2,{resource:r,pool:n}]):[3,7];case 7:return resourceReleased(t,this._activeResourceCounts),n.removeInUse(r),[4,this._destroy(r)];case 8:e.sent(),e.label=9;case 9:return[3,1];case 10:if(0<this._maxSize&&this.activeResourceCount(l)+this._pendingCreates[t]>=this._maxSize)return[2,{resource:null,pool:n}];this._pendingCreates[t]=this._pendingCreates[t]+1,e.label=11;case 11:return(e.trys.push([11,,15,16]),this.activeResourceCount(l)+n.length>=this._maxSize&&f)?null==(s=n.pop())?[3,13]:(null!=this._removeIdleObserver&&this._removeIdleObserver(s),n.removeInUse(s),[4,this._destroy(s)]):[3,13];case 12:e.sent(),e.label=13;case 13:return[4,this._create(c,l,function(t,r){return __awaiter$i(u,void 0,void 0,function(){return __generator$k(this,function(e){switch(e.label){case 0:return[4,this._release(t,r,n)];case 1:return[2,e.sent()]}})})})];case 14:return a=e.sent(),n.pushInUse(a),resourceAcquired(t,this._activeResourceCounts),this._log.isDebugEnabled()&&this._log.debug("".concat(a," created for the pool ").concat(t)),[3,16];case 15:return this._pendingCreates[t]=this._pendingCreates[t]-1,[7];case 16:return[2,{resource:a,pool:n}]}})})},e.prototype._release=function(n,o,i){return __awaiter$i(this,void 0,void 0,function(){var t,r=this;return __generator$k(this,function(e){switch(e.label){case 0:t=n.asKey(),e.label=1;case 1:return(e.trys.push([1,,9,10]),i.isActive())?[4,this._validateOnRelease(o)]:[3,6];case 2:return e.sent()?[3,4]:(this._log.isDebugEnabled()&&this._log.debug("".concat(o," destroyed and can't be released to the pool ").concat(t," because it is not functional")),i.removeInUse(o),[4,this._destroy(o)]);case 3:return e.sent(),[3,5];case 4:null!=this._installIdleObserver&&this._installIdleObserver(o,{onError:function(e){r._log.debug("Idle connection ".concat(o," destroyed because of error: ").concat(e));e=r._pools[t];null!=e&&(r._pools[t]=e.filter(function(e){return e!==o}),e.removeInUse(o)),r._destroy(o).catch(function(){})}}),i.push(o),this._log.isDebugEnabled()&&this._log.debug("".concat(o," released to the pool ").concat(t)),e.label=5;case 5:return[3,8];case 6:return this._log.isDebugEnabled()&&this._log.debug("".concat(o," destroyed and can't be released to the pool ").concat(t," because pool has been purged")),i.removeInUse(o),[4,this._destroy(o)];case 7:e.sent(),e.label=8;case 8:return[3,10];case 9:return resourceReleased(t,this._activeResourceCounts),this._processPendingAcquireRequests(n),[7];case 10:return[2]}})})},e.prototype._purgeKey=function(o){return __awaiter$i(this,void 0,void 0,function(){var t,r,n;return __generator$k(this,function(e){switch(e.label){case 0:if(t=this._pools[o],r=[],null==t)return[3,2];for(;0<t.length;)null!=(n=t.pop())&&(null!=this._removeIdleObserver&&this._removeIdleObserver(n),r.push(this._destroy(n)));return t.close(),delete this._pools[o],[4,Promise.all(r)];case 1:e.sent(),e.label=2;case 2:return[2]}})})},e.prototype._processPendingAcquireRequests=function(r){var n,o=this,i=r.asKey(),e=this._acquireRequests[i];null!=e&&(null!=(n=e.shift())?this._acquire(n.context,r,n.requireNew).catch(function(e){return n.reject(e),{resource:null,pool:null}}).then(function(e){var t=e.resource,e=e.pool;null!=t&&null!=e?n.isCompleted()?o._release(r,t,e).catch(function(e){o._log.isDebugEnabled()&&o._log.debug("".concat(t," could not be release back to the pool. Cause: ").concat(e))}):n.resolve(t):n.isCompleted()||(null==o._acquireRequests[i]&&(o._acquireRequests[i]=[]),o._acquireRequests[i].unshift(n))}).catch(function(e){return n.reject(e)}):delete this._acquireRequests[i])},e}();function resourceAcquired(e,t){var r=null!=(r=t[e])?r:0;t[e]=r+1}function resourceReleased(e,t){var r=(null!=(r=t[e])?r:0)-1;0<r?t[e]=r:delete t[e]}var PendingRequest=function(){function e(e,t,r,n,o,i,a){this._key=e,this._context=t,this._resolve=n,this._reject=o,this._timeoutId=i,this._log=a,this._completed=!1,this._config=null!=r?r:{}}return Object.defineProperty(e.prototype,"context",{get:function(){return this._context},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"requireNew",{get:function(){var e;return null!=(e=this._config.requireNew)&&e},enumerable:!1,configurable:!0}),e.prototype.isCompleted=function(){return this._completed},e.prototype.resolve=function(e){this._completed||(this._completed=!0,clearTimeout(this._timeoutId),this._log.isDebugEnabled()&&this._log.debug("".concat(e," acquired from the pool ").concat(this._key)),this._resolve(e))},e.prototype.reject=function(e){this._completed||(this._completed=!0,clearTimeout(this._timeoutId),this._reject(e))},e}(),SingleAddressPool=function(){function e(){this._active=!0,this._elements=[],this._elementsInUse=new Set}return e.prototype.isActive=function(){return this._active},e.prototype.close=function(){this._active=!1,this._elements=[],this._elementsInUse=new Set},e.prototype.filter=function(e){return this._elements=this._elements.filter(e),this},e.prototype.apply=function(e){this._elements.forEach(e),this._elementsInUse.forEach(e)},Object.defineProperty(e.prototype,"length",{get:function(){return this._elements.length},enumerable:!1,configurable:!0}),e.prototype.pop=function(){var e=this._elements.pop();return null!=e&&this._elementsInUse.add(e),e},e.prototype.push=function(e){return this._elementsInUse.delete(e),this._elements.push(e)},e.prototype.pushInUse=function(e){this._elementsInUse.add(e)},e.prototype.removeInUse=function(e){this._elementsInUse.delete(e)},e}(),__createBinding$7=(pool$1.default=Pool$1,!function(e){var n=commonjsGlobal&&commonjsGlobal.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&("get"in o?t.__esModule:!o.writable&&!o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,o)}:function(e,t,r,n){e[n=void 0===n?r:n]=t[r]}),o=commonjsGlobal&&commonjsGlobal.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),t=commonjsGlobal&&commonjsGlobal.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return o(t,e),t},r=commonjsGlobal&&commonjsGlobal.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},i=(Object.defineProperty(e,"__esModule",{value:!0}),e.DEFAULT_MAX_SIZE=e.DEFAULT_ACQUISITION_TIMEOUT=e.PoolConfig=e.Pool=void 0,t(poolConfig)),t=(e.PoolConfig=i.default,Object.defineProperty(e,"DEFAULT_ACQUISITION_TIMEOUT",{enumerable:!0,get:function(){return i.DEFAULT_ACQUISITION_TIMEOUT}}),Object.defineProperty(e,"DEFAULT_MAX_SIZE",{enumerable:!0,get:function(){return i.DEFAULT_MAX_SIZE}}),r(pool$1));e.Pool=t.default,e.default=t.default}(pool$2),commonjsGlobal&&commonjsGlobal.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&("get"in o?t.__esModule:!o.writable&&!o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,o)}:function(e,t,r,n){e[n=void 0===n?r:n]=t[r]})),__setModuleDefault$7=commonjsGlobal&&commonjsGlobal.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),__importStar$7=commonjsGlobal&&commonjsGlobal.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&__createBinding$7(t,e,r);return __setModuleDefault$7(t,e),t},util=(Object.defineProperty(internal,"__esModule",{value:!0}),internal.pool=internal.boltAgent=internal.objectUtil=internal.resolver=internal.serverAddress=internal.urlUtil=internal.logger=internal.transactionExecutor=internal.txConfig=internal.connectionHolder=internal.constants=internal.bookmarks=internal.observer=internal.temporalUtil=internal.util=void 0,__importStar$7(util$4)),temporalUtil=(internal.util=util,__importStar$7(temporalUtil$1)),observer=(internal.temporalUtil=temporalUtil,__importStar$7(observers)),bookmarks=(internal.observer=observer,__importStar$7(bookmarks$1)),constants=(internal.bookmarks=bookmarks,__importStar$7(constants$1)),connectionHolder=(internal.constants=constants,__importStar$7(connectionHolder$1)),txConfig=(internal.connectionHolder=connectionHolder,__importStar$7(txConfig$1)),transactionExecutor=(internal.txConfig=txConfig,__importStar$7(transactionExecutor$1)),logger=(internal.transactionExecutor=transactionExecutor,__importStar$7(logger$1)),urlUtil=(internal.logger=logger,__importStar$7(urlUtil$2)),serverAddress=(internal.urlUtil=urlUtil,__importStar$7(serverAddress$1)),resolver=(internal.serverAddress=serverAddress,__importStar$7(resolver$1)),objectUtil$1=(internal.resolver=resolver,__importStar$7(objectUtil$2)),boltAgent=(internal.objectUtil=objectUtil$1,__importStar$7(browser$1)),pool=(internal.boltAgent=boltAgent,__importStar$7(pool$2)),notification=(internal.pool=pool,{}),__assign$v=commonjsGlobal&&commonjsGlobal.__assign||function(){return(__assign$v=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},__createBinding$6=commonjsGlobal&&commonjsGlobal.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&("get"in o?t.__esModule:!o.writable&&!o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,o)}:function(e,t,r,n){e[n=void 0===n?r:n]=t[r]}),__setModuleDefault$6=commonjsGlobal&&commonjsGlobal.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),__importStar$6=commonjsGlobal&&commonjsGlobal.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&__createBinding$6(t,e,r);return __setModuleDefault$6(t,e),t},__read$s=commonjsGlobal&&commonjsGlobal.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),a=[];try{for(;(void 0===t||0<t--)&&!(n=i.next()).done;)a.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a},__spreadArray$m=commonjsGlobal&&commonjsGlobal.__spreadArray||function(e,t,r){if(r||2===arguments.length)for(var n,o=0,i=t.length;o<i;o++)!n&&o in t||((n=n||Array.prototype.slice.call(t,0,o))[o]=t[o]);return e.concat(n||Array.prototype.slice.call(t))},json$1=(Object.defineProperty(notification,"__esModule",{value:!0}),notification.buildNotificationsFromMetadata=notification.buildGqlStatusObjectFromMetadata=notification.polyfillNotification=notification.polyfillGqlStatusObject=notification.GqlStatusObject=notification.Notification=notification.notificationClassification=notification.notificationCategory=notification.notificationSeverityLevel=void 0,__importStar$6(json$3)),internal_1$3=internal,gql_constants_1=gqlConstants,unknownGqlStatus={WARNING:{gql_status:"01N42",status_description:"warn: unknown warning"},NO_DATA:{gql_status:"02N42",status_description:"note: no data - unknown subcondition"},INFORMATION:{gql_status:"03N42",status_description:"info: unknown notification"},ERROR:{gql_status:"50N42",status_description:"error: general processing exception - unexpected error"}},notificationSeverityLevel={WARNING:"WARNING",INFORMATION:"INFORMATION",UNKNOWN:"UNKNOWN"},severityLevels=(notification.notificationSeverityLevel=notificationSeverityLevel,Object.freeze(notificationSeverityLevel),Object.values(notificationSeverityLevel)),notificationCategory={HINT:"HINT",UNRECOGNIZED:"UNRECOGNIZED",UNSUPPORTED:"UNSUPPORTED",PERFORMANCE:"PERFORMANCE",DEPRECATION:"DEPRECATION",TOPOLOGY:"TOPOLOGY",SECURITY:"SECURITY",GENERIC:"GENERIC",SCHEMA:"SCHEMA",UNKNOWN:"UNKNOWN"},categories=(notification.notificationCategory=notificationCategory,Object.freeze(notificationCategory),Object.values(notificationCategory)),notificationClassification=notificationCategory,Notification$1=(notification.notificationClassification=notificationClassification,function(e){this.code=e.code,this.title=e.title,this.description=e.description,this.severity=e.severity,this.position=_constructPosition(e.position),this.severityLevel=_asEnumerableSeverity(e.severity),this.rawSeverityLevel=e.severity,this.category=_asEnumerableClassification(e.category),this.rawCategory=e.category}),GqlStatusObject=(notification.Notification=Notification$1,function(){function e(e){var t;this.gqlStatus=e.gql_status,this.statusDescription=e.status_description,this.diagnosticRecord=null!=(t=e.diagnostic_record)?t:{},this.position=null!=this.diagnosticRecord._position?_constructPosition(this.diagnosticRecord._position):void 0,this.severity=_asEnumerableSeverity(this.diagnosticRecord._severity),this.rawSeverity=this.diagnosticRecord._severity,this.classification=_asEnumerableClassification(this.diagnosticRecord._classification),this.rawClassification=this.diagnosticRecord._classification,this.isNotification=null!=e.neo4j_code,Object.freeze(this)}return Object.defineProperty(e.prototype,"diagnosticRecordAsJsonString",{get:function(){return json$1.stringify(this.diagnosticRecord,{useCustomToString:!0})},enumerable:!1,configurable:!0}),e}());function polyfillNotification(e){var t;if(null!=e.neo4j_code)return new Notification$1({code:e.neo4j_code,title:e.title,description:e.description,severity:null==(t=e.diagnostic_record)?void 0:t._severity,category:null==(t=e.diagnostic_record)?void 0:t._classification,position:null==(t=e.diagnostic_record)?void 0:t._position})}function polyfillGqlStatusObject(e){var t=e.severity===notificationSeverityLevel.WARNING?unknownGqlStatus.WARNING:unknownGqlStatus.INFORMATION,r={gql_status:t.gql_status,status_description:null!=(r=e.description)?r:t.status_description,neo4j_code:e.code,title:e.title,diagnostic_record:__assign$v({},gql_constants_1.rawPolyfilledDiagnosticRecord)};return null!=e.severity&&(r.diagnostic_record._severity=e.severity),null!=e.category&&(r.diagnostic_record._classification=e.category),null!=e.position&&(r.diagnostic_record._position=e.position),new GqlStatusObject(r)}notification.GqlStatusObject=GqlStatusObject,notification.polyfillNotification=polyfillNotification,notification.polyfillGqlStatusObject=polyfillGqlStatusObject;var staticGqlStatusObjects={SUCCESS:new GqlStatusObject({gql_status:"00000",status_description:"note: successful completion",diagnostic_record:gql_constants_1.rawPolyfilledDiagnosticRecord}),NO_DATA:new GqlStatusObject({gql_status:"02000",status_description:"note: no data",diagnostic_record:gql_constants_1.rawPolyfilledDiagnosticRecord}),NO_DATA_UNKNOWN_SUBCONDITION:new GqlStatusObject(__assign$v(__assign$v({},unknownGqlStatus.NO_DATA),{diagnostic_record:gql_constants_1.rawPolyfilledDiagnosticRecord})),OMITTED_RESULT:new GqlStatusObject({gql_status:"00001",status_description:"note: successful completion - omitted result",diagnostic_record:gql_constants_1.rawPolyfilledDiagnosticRecord})};function buildGqlStatusObjectFromMetadata(e){if(null!=e.statuses)return e.statuses.map(function(e){return new GqlStatusObject(e)});var t=!0===(null==(t=e.stream_summary)?void 0:t.have_records_streamed)?staticGqlStatusObjects.SUCCESS:!1===(null==t?void 0:t.has_keys)?staticGqlStatusObjects.OMITTED_RESULT:!0===(null==t?void 0:t.pulled)?staticGqlStatusObjects.NO_DATA:staticGqlStatusObjects.NO_DATA_UNKNOWN_SUBCONDITION;return __spreadArray$m([t],__read$s(null!=(e=null==(t=e.notifications)?void 0:t.map(polyfillGqlStatusObject))?e:[]),!1).sort(function(e,t){return calculateWeight(e)-calculateWeight(t)})}Object.freeze(staticGqlStatusObjects),notification.buildGqlStatusObjectFromMetadata=buildGqlStatusObjectFromMetadata;var gqlStatusWeightByClass=Object.freeze({"02":0,"01":1,"00":2});function calculateWeight(e){var e=null==(e=e.gqlStatus)?void 0:e.slice(0,2);return null!=(e=gqlStatusWeightByClass[e])?e:9999}function buildNotificationsFromMetadata(e){return null!=e.notifications?e.notifications.map(function(e){return new Notification$1(e)}):null!=e.statuses?e.statuses.map(polyfillNotification).filter(function(e){return null!=e}):[]}function _constructPosition(e){return null==e?{}:{offset:internal_1$3.util.toNumber(e.offset),line:internal_1$3.util.toNumber(e.line),column:internal_1$3.util.toNumber(e.column)}}function _asEnumerableSeverity(e){return severityLevels.includes(e)?e:notificationSeverityLevel.UNKNOWN}function _asEnumerableClassification(e){return categories.includes(e)?e:notificationClassification.UNKNOWN}notification.buildNotificationsFromMetadata=buildNotificationsFromMetadata,notification.default=Notification$1,Object.defineProperty(resultSummary,"__esModule",{value:!0}),resultSummary.Stats=resultSummary.QueryStatistics=resultSummary.ProfiledPlan=resultSummary.Plan=resultSummary.ServerInfo=resultSummary.queryType=void 0;var internal_1$2=internal,notification_1=notification,ResultSummary=function(){function e(e,t,r,n){this.query={text:e,parameters:t},this.queryType=r.type,this.counters=new QueryStatistics(null!=(e=r.stats)?e:{}),this.updateStatistics=this.counters,this.plan=(null!=r.plan||null!=r.profile)&&new Plan(null!=(t=r.plan)?t:r.profile),this.profile=null!=r.profile&&new ProfiledPlan(r.profile),this.notifications=(0,notification_1.buildNotificationsFromMetadata)(r),this.gqlStatusObjects=(0,notification_1.buildGqlStatusObjectFromMetadata)(r),this.server=new ServerInfo(r.server,n),this.resultConsumedAfter=r.result_consumed_after,this.resultAvailableAfter=r.result_available_after,this.database={name:null!=(e=r.db)?e:null}}return e.prototype.hasPlan=function(){return this.plan instanceof Plan},e.prototype.hasProfile=function(){return this.profile instanceof ProfiledPlan},e}(),Plan=function t(e){this.operatorType=e.operatorType,this.identifiers=e.identifiers,this.arguments=e.args,this.children=null!=e.children?e.children.map(function(e){return new t(e)}):[]},ProfiledPlan=(resultSummary.Plan=Plan,function(){function t(e){this.operatorType=e.operatorType,this.identifiers=e.identifiers,this.arguments=e.args,this.dbHits=valueOrDefault$1("dbHits",e),this.rows=valueOrDefault$1("rows",e),this.pageCacheMisses=valueOrDefault$1("pageCacheMisses",e),this.pageCacheHits=valueOrDefault$1("pageCacheHits",e),this.pageCacheHitRatio=valueOrDefault$1("pageCacheHitRatio",e),this.time=valueOrDefault$1("time",e),this.children=null!=e.children?e.children.map(function(e){return new t(e)}):[]}return t.prototype.hasPageCacheStats=function(){return 0<this.pageCacheMisses||0<this.pageCacheHits||0<this.pageCacheHitRatio},t}()),Stats=(resultSummary.ProfiledPlan=ProfiledPlan,function(){this.nodesCreated=0,this.nodesDeleted=0,this.relationshipsCreated=0,this.relationshipsDeleted=0,this.propertiesSet=0,this.labelsAdded=0,this.labelsRemoved=0,this.indexesAdded=0,this.indexesRemoved=0,this.constraintsAdded=0,this.constraintsRemoved=0}),QueryStatistics=(resultSummary.Stats=Stats,function(){function e(r){var n=this;this._stats={nodesCreated:0,nodesDeleted:0,relationshipsCreated:0,relationshipsDeleted:0,propertiesSet:0,labelsAdded:0,labelsRemoved:0,indexesAdded:0,indexesRemoved:0,constraintsAdded:0,constraintsRemoved:0},this._systemUpdates=0,Object.keys(r).forEach(function(e){var t=e.replace(/(-\w)/g,function(e){return e[1].toUpperCase()});t in n._stats?n._stats[t]=internal_1$2.util.toNumber(r[e]):"systemUpdates"===t?n._systemUpdates=internal_1$2.util.toNumber(r[e]):"containsSystemUpdates"===t?n._containsSystemUpdates=r[e]:"containsUpdates"===t&&(n._containsUpdates=r[e])}),this._stats=Object.freeze(this._stats)}return e.prototype.containsUpdates=function(){var r=this;return void 0!==this._containsUpdates?this._containsUpdates:0<Object.keys(this._stats).reduce(function(e,t){return e+r._stats[t]},0)},e.prototype.updates=function(){return this._stats},e.prototype.containsSystemUpdates=function(){return void 0!==this._containsSystemUpdates?this._containsSystemUpdates:0<this._systemUpdates},e.prototype.systemUpdates=function(){return this._systemUpdates},e}()),ServerInfo=(resultSummary.QueryStatistics=QueryStatistics,function(e,t){null!=e&&(this.address=e.address,this.agent=e.version),this.protocolVersion=t});function valueOrDefault$1(e,t,r){return void 0===r&&(r=0),!1!==t&&e in t?(t=t[e],internal_1$2.util.toNumber(t)):r}resultSummary.ServerInfo=ServerInfo;var _a$h,queryType={READ_ONLY:"r",READ_WRITE:"rw",WRITE_ONLY:"w",SCHEMA_WRITE:"s"},notificationFilter=(resultSummary.queryType=queryType,resultSummary.default=ResultSummary,{}),notificationFilterMinimumSeverityLevel=(Object.defineProperty(notificationFilter,"__esModule",{value:!0}),notificationFilter.notificationFilterDisabledClassification=notificationFilter.notificationFilterDisabledCategory=notificationFilter.notificationFilterMinimumSeverityLevel=void 0,{OFF:"OFF",WARNING:"WARNING",INFORMATION:"INFORMATION"}),notificationFilterDisabledCategory=(notificationFilter.notificationFilterMinimumSeverityLevel=notificationFilterMinimumSeverityLevel,Object.freeze(notificationFilterMinimumSeverityLevel),{HINT:"HINT",UNRECOGNIZED:"UNRECOGNIZED",UNSUPPORTED:"UNSUPPORTED",PERFORMANCE:"PERFORMANCE",TOPOLOGY:"TOPOLOGY",SECURITY:"SECURITY",DEPRECATION:"DEPRECATION",GENERIC:"GENERIC",SCHEMA:"SCHEMA"}),notificationFilterDisabledClassification=(notificationFilter.notificationFilterDisabledCategory=notificationFilterDisabledCategory,Object.freeze(notificationFilterDisabledCategory),notificationFilterDisabledCategory),NotificationFilter=(notificationFilter.notificationFilterDisabledClassification=notificationFilterDisabledClassification,function(){throw this.minimumSeverityLevel=void 0,this.disabledCategories=void 0,this.disabledClassifications=void 0,new Error("Not implemented")}),result=(notificationFilter.default=NotificationFilter,{}),__awaiter$h=commonjsGlobal&&commonjsGlobal.__awaiter||function(e,a,s,u){return new(s=s||Promise)(function(r,t){function n(e){try{i(u.next(e))}catch(e){t(e)}}function o(e){try{i(u.throw(e))}catch(e){t(e)}}function i(e){var t;e.done?r(e.value):((t=e.value)instanceof s?t:new s(function(e){e(t)})).then(n,o)}i((u=u.apply(e,a||[])).next())})},__generator$j=commonjsGlobal&&commonjsGlobal.__generator||function(n,o){var i,a,s,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},c={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(c[Symbol.iterator]=function(){return this}),c;function e(r){return function(e){var t=[r,e];if(i)throw new TypeError("Generator is already executing.");for(;u=c&&t[c=0]?0:u;)try{if(i=1,a&&(s=2&t[0]?a.return:t[0]?a.throw||((s=a.return)&&s.call(a),0):a.next)&&!(s=s.call(a,t[1])).done)return s;switch(a=0,(t=s?[2&t[0],s.value]:t)[0]){case 0:case 1:s=t;break;case 4:return u.label++,{value:t[1],done:!1};case 5:u.label++,a=t[1],t=[0];continue;case 7:t=u.ops.pop(),u.trys.pop();continue;default:if(!(s=0<(s=u.trys).length&&s[s.length-1])&&(6===t[0]||2===t[0])){u=0;continue}if(3===t[0]&&(!s||t[1]>s[0]&&t[1]<s[3])){u.label=t[1];break}if(6===t[0]&&u.label<s[1]){u.label=s[1],s=t;break}if(s&&u.label<s[2]){u.label=s[2],u.ops.push(t);break}s[2]&&u.ops.pop(),u.trys.pop();continue}t=o.call(n,u)}catch(e){t=[6,e],a=0}finally{i=s=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}}},__importDefault$_=commonjsGlobal&&commonjsGlobal.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},result_summary_1=(Object.defineProperty(result,"__esModule",{value:!0}),__importDefault$_(resultSummary)),internal_1$1=internal,error_1$5=error,EMPTY_CONNECTION_HOLDER=internal_1$1.connectionHolder.EMPTY_CONNECTION_HOLDER,DEFAULT_ON_ERROR=function(e){console.log("Uncaught error when processing result: "+e)},DEFAULT_ON_COMPLETED=function(e){},DEFAULT_ON_KEYS=function(e){},Result=function(){function e(e,t,r,n,o){void 0===o&&(o={high:Number.MAX_VALUE,low:Number.MAX_VALUE}),this[_a$h]="Result",this._stack=captureStacktrace(),this._streamObserverPromise=e,this._p=null,this._query=t,this._parameters=null!=r?r:{},this._connectionHolder=null!=n?n:EMPTY_CONNECTION_HOLDER,this._keys=null,this._summary=null,this._error=null,this._watermarks=o}return e.prototype.keys=function(){var n=this;return null!==this._keys?Promise.resolve(this._keys):null!==this._error?Promise.reject(this._error):new Promise(function(t,r){n._streamObserverPromise.then(function(e){return e.subscribe(n._decorateObserver({onKeys:function(e){return t(e)},onError:function(e){return r(e)}}))}).catch(r)})},e.prototype.summary=function(){var n=this;return null!==this._summary?Promise.resolve(this._summary):null!==this._error?Promise.reject(this._error):new Promise(function(t,r){n._streamObserverPromise.then(function(e){e.cancel(),e.subscribe(n._decorateObserver({onCompleted:function(e){return t(e)},onError:function(e){return r(e)}}))}).catch(r)})},e.prototype._getOrCreatePromise=function(){var e=this;return null==this._p&&(this._p=new Promise(function(t,r){var n=[];e.subscribe({onNext:function(e){n.push(e)},onCompleted:function(e){t({records:n,summary:e})},onError:function(e){r(e)}})})),this._p},e.prototype[Symbol.asyncIterator]=function(){var e,n=this;if(!this.isOpen())return e=(0,error_1$5.newError)("Result is already consumed"),{next:function(){return Promise.reject(e)},peek:function(){return Promise.reject(e)}};function o(){return __awaiter$h(n,void 0,void 0,function(){var t;return __generator$j(this,function(e){switch(e.label){case 0:return void 0!==a.queuedObserver?[3,2]:(a.queuedObserver=this._createQueuedResultObserver(r),t=a,[4,this._subscribe(a.queuedObserver,!0).catch(function(){})]);case 1:t.streaming=e.sent(),r(),e.label=2;case 2:return[2,a.queuedObserver]}})})}function i(e){if(void 0===e)throw(0,error_1$5.newError)("InvalidState: Result stream finished without Summary",error_1$5.PROTOCOL_ERROR);return 1}var a={paused:!0,firstRun:!0,finished:!1},r=function(){var e,t;null!=a.streaming&&(e=(t=null!=(t=null==(t=a.queuedObserver)?void 0:t.size)?t:0)>=n._watermarks.high,t=t<=n._watermarks.low,e&&!a.paused?(a.paused=!0,a.streaming.pause()):(t&&a.paused||a.firstRun&&!e)&&(a.firstRun=!1,a.paused=!1,a.streaming.resume()))};return{next:function(){return __awaiter$h(n,void 0,void 0,function(){var t;return __generator$j(this,function(e){switch(e.label){case 0:return a.finished&&i(a.summary)?[2,{done:!0,value:a.summary}]:[4,o()];case 1:return[4,e.sent().dequeue()];case 2:return!0===(t=e.sent()).done&&(a.finished=t.done,a.summary=t.value),[2,t]}})})},return:function(r){return __awaiter$h(n,void 0,void 0,function(){var t;return __generator$j(this,function(e){switch(e.label){case 0:return a.finished&&i(a.summary)?[2,{done:!0,value:null!=r?r:a.summary}]:(null!=(t=a.streaming)&&t.cancel(),[4,o()]);case 1:return[4,e.sent().dequeueUntilDone()];case 2:return t=e.sent(),a.finished=!0,t.value=null!=r?r:t.value,a.summary=t.value,[2,t]}})})},peek:function(){return __awaiter$h(n,void 0,void 0,function(){return __generator$j(this,function(e){switch(e.label){case 0:return a.finished&&i(a.summary)?[2,{done:!0,value:a.summary}]:[4,o()];case 1:return[4,e.sent().head()];case 2:return[2,e.sent()]}})})}}},e.prototype.then=function(e,t){return this._getOrCreatePromise().then(e,t)},e.prototype.catch=function(e){return this._getOrCreatePromise().catch(e)},e.prototype.finally=function(e){return this._getOrCreatePromise().finally(e)},e.prototype.subscribe=function(e){this._subscribe(e).catch(function(){})},e.prototype.isOpen=function(){return null===this._summary&&null===this._error},e.prototype._subscribe=function(e,t){void 0===t&&(t=!1);var r=this._decorateObserver(e);return this._streamObserverPromise.then(function(e){return t&&e.pause(),e.subscribe(r),e}).catch(function(e){return null!=r.onError&&r.onError(e),Promise.reject(e)})},e.prototype._decorateObserver=function(t){var e,r=this,n=null!=(e=t.onCompleted)?e:DEFAULT_ON_COMPLETED,o=null!=(e=t.onError)?e:DEFAULT_ON_ERROR,i=null!=(e=t.onKeys)?e:DEFAULT_ON_KEYS;return{onNext:null!=t.onNext?t.onNext.bind(t):void 0,onKeys:function(e){return r._keys=e,i.call(t,e)},onCompleted:function(e){r._releaseConnectionAndGetSummary(e).then(function(e){return null!==r._summary?n.call(t,r._summary):(r._summary=e,n.call(t,e))}).catch(o)},onError:function(e){r._connectionHolder.releaseConnection().then(function(){replaceStacktrace(e,r._stack),r._error=e,o.call(t,e)}).catch(o)}}},e.prototype._cancel=function(){null===this._summary&&null===this._error&&this._streamObserverPromise.then(function(e){return e.cancel()}).catch(function(){})},e.prototype._releaseConnectionAndGetSummary=function(t){var e=internal_1$1.util.validateQueryAndParameters(this._query,this._parameters,{skipAsserts:!0}),r=e.validatedQuery,n=e.params,o=this._connectionHolder;return o.getConnection().then(function(e){return o.releaseConnection().then(function(){return null==e?void 0:e.getProtocolVersion()})},function(e){}).then(function(e){return new result_summary_1.default(r,n,t,e)})},e.prototype._createQueuedResultObserver=function(n){var e=this;function o(){var r={};return r.promise=new Promise(function(e,t){r.resolve=e,r.reject=t}),r}function i(e){return e instanceof Error}function r(){var r;return __awaiter$h(this,void 0,void 0,function(){var t;return __generator$j(this,function(e){switch(e.label){case 0:if(0<a.length){if(t=null!=(r=a.shift())?r:(0,error_1$5.newError)("Unexpected empty buffer",error_1$5.PROTOCOL_ERROR),n(),i(t))throw t;return[2,t]}return s.resolvable=o(),[4,s.resolvable.promise];case 1:return[2,e.sent()]}})})}var a=[],s={resolvable:null},t={onNext:function(e){t._push({done:!1,value:e})},onCompleted:function(e){t._push({done:!0,value:e})},onError:function(e){t._push(e)},_push:function(e){var t;null!==s.resolvable?(t=s.resolvable,s.resolvable=null,i(e)?t.reject(e):t.resolve(e)):(a.push(e),n())},dequeue:r,dequeueUntilDone:function(){return __awaiter$h(e,void 0,void 0,function(){var t;return __generator$j(this,function(e){switch(e.label){case 0:return[4,r()];case 1:return!0===(t=e.sent()).done?[2,t]:[3,0];case 2:return[2]}})})},head:function(){return __awaiter$h(e,void 0,void 0,function(){var t,r;return __generator$j(this,function(e){switch(e.label){case 0:if(0<a.length){if(i(t=a[0]))throw t;return[2,t]}s.resolvable=o(),e.label=1;case 1:return e.trys.push([1,3,4,5]),[4,s.resolvable.promise];case 2:return t=e.sent(),a.unshift(t),[2,t];case 3:throw r=e.sent(),a.unshift(r),r;case 4:return n(),[7];case 5:return[2]}})})},get size(){return a.length}};return t},e}();function captureStacktrace(){var e=new Error("");return null!=e.stack?e.stack.replace(/^Error(\n\r)*/,""):null}function replaceStacktrace(e,t){null!=t&&(e.stack=e.toString()+"\n"+t)}_a$h=Symbol.toStringTag,result.default=Result;var resultEager={},EagerResult=(Object.defineProperty(resultEager,"__esModule",{value:!0}),function(e,t,r){this.keys=e,this.records=t,this.summary=r}),connectionProvider$1=(resultEager.default=EagerResult,{}),Releasable=(Object.defineProperty(connectionProvider$1,"__esModule",{value:!0}),connectionProvider$1.Releasable=void 0,function(){function e(){}return e.prototype.release=function(){throw new Error("Not implemented")},e}()),ConnectionProvider=(connectionProvider$1.Releasable=Releasable,function(){function e(){}return e.prototype.acquireConnection=function(e){throw Error("Not implemented")},e.prototype.supportsMultiDb=function(){throw Error("Not implemented")},e.prototype.supportsTransactionConfig=function(){throw Error("Not implemented")},e.prototype.supportsUserImpersonation=function(){throw Error("Not implemented")},e.prototype.supportsSessionAuth=function(){throw Error("Not implemented")},e.prototype.SSREnabled=function(){return!1},e.prototype.verifyConnectivityAndGetServerInfo=function(e){throw Error("Not implemented")},e.prototype.verifyAuthentication=function(e){throw Error("Not implemented")},e.prototype.getNegotiatedProtocolVersion=function(){throw Error("Not Implemented")},e.prototype.close=function(){throw Error("Not implemented")},e}()),connection$2=(connectionProvider$1.default=ConnectionProvider,{}),Connection$1=(Object.defineProperty(connection$2,"__esModule",{value:!0}),function(){function e(){}return e.prototype.beginTransaction=function(e){throw new Error("Not implemented")},e.prototype.run=function(e,t,r){throw new Error("Not implemented")},e.prototype.commitTransaction=function(e){throw new Error("Not implemented")},e.prototype.rollbackTransaction=function(e){throw new Error("Not implemented")},e.prototype.resetAndFlush=function(){throw new Error("Not implemented")},e.prototype.isOpen=function(){throw new Error("Not implemented")},e.prototype.getProtocolVersion=function(){throw new Error("Not implemented")},e.prototype.hasOngoingObservableRequests=function(){throw new Error("Not implemented")},e}()),transaction=(connection$2.default=Connection$1,{}),__awaiter$g=commonjsGlobal&&commonjsGlobal.__awaiter||function(e,a,s,u){return new(s=s||Promise)(function(r,t){function n(e){try{i(u.next(e))}catch(e){t(e)}}function o(e){try{i(u.throw(e))}catch(e){t(e)}}function i(e){var t;e.done?r(e.value):((t=e.value)instanceof s?t:new s(function(e){e(t)})).then(n,o)}i((u=u.apply(e,a||[])).next())})},__generator$i=commonjsGlobal&&commonjsGlobal.__generator||function(n,o){var i,a,s,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},c={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(c[Symbol.iterator]=function(){return this}),c;function e(r){return function(e){var t=[r,e];if(i)throw new TypeError("Generator is already executing.");for(;u=c&&t[c=0]?0:u;)try{if(i=1,a&&(s=2&t[0]?a.return:t[0]?a.throw||((s=a.return)&&s.call(a),0):a.next)&&!(s=s.call(a,t[1])).done)return s;switch(a=0,(t=s?[2&t[0],s.value]:t)[0]){case 0:case 1:s=t;break;case 4:return u.label++,{value:t[1],done:!1};case 5:u.label++,a=t[1],t=[0];continue;case 7:t=u.ops.pop(),u.trys.pop();continue;default:if(!(s=0<(s=u.trys).length&&s[s.length-1])&&(6===t[0]||2===t[0])){u=0;continue}if(3===t[0]&&(!s||t[1]>s[0]&&t[1]<s[3])){u.label=t[1];break}if(6===t[0]&&u.label<s[1]){u.label=s[1],s=t;break}if(s&&u.label<s[2]){u.label=s[2],u.ops.push(t);break}s[2]&&u.ops.pop(),u.trys.pop();continue}t=o.call(n,u)}catch(e){t=[6,e],a=0}finally{i=s=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}}},__importDefault$Z=commonjsGlobal&&commonjsGlobal.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},util_1$2=(Object.defineProperty(transaction,"__esModule",{value:!0}),util$4),connection_holder_1$1=connectionHolder$1,bookmarks_1$2=bookmarks$1,tx_config_1$1=txConfig$1,observers_1$1=observers,error_1$4=error,result_1$1=__importDefault$Z(result),Transaction=function(){function e(e){var t=e.connectionHolder,r=e.onClose,n=e.onBookmarks,o=e.onConnection,i=e.reactive,a=e.fetchSize,s=e.impersonatedUser,u=e.highRecordWatermark,c=e.lowRecordWatermark,l=e.notificationFilter,e=e.apiTelemetryConfig,f=this;this._connectionHolder=t,this._reactive=i,this._state=_states$1.ACTIVE,this._onClose=r,this._onBookmarks=n,this._onConnection=o,this._onError=this._onErrorCallback.bind(this),this._fetchSize=a,this._onComplete=this._onCompleteCallback.bind(this),this._results=[],this._impersonatedUser=s,this._lowRecordWatermak=c,this._highRecordWatermark=u,this._bookmarks=bookmarks_1$2.Bookmarks.empty(),this._notificationFilter=l,this._apiTelemetryConfig=e,this._acceptActive=function(){},this._activePromise=new Promise(function(e,t){f._acceptActive=e})}return e.prototype._begin=function(o,i,a){var t=this;this._connectionHolder.getConnection().then(function(n){return __awaiter$g(t,void 0,void 0,function(){var t,r=this;return __generator$i(this,function(e){switch(e.label){case 0:return(this._onConnection(),null==n)?[3,2]:(t=this,[4,o()]);case 1:return t._bookmarks=e.sent(),[2,n.beginTransaction({bookmarks:this._bookmarks,txConfig:i,mode:this._connectionHolder.mode(),database:this._connectionHolder.database(),impersonatedUser:this._impersonatedUser,notificationFilter:this._notificationFilter,apiTelemetryConfig:this._apiTelemetryConfig,beforeError:function(e){null!=a&&a.onError(e),r._onError(e).catch(function(){})},afterComplete:function(e){null!=a&&a.onComplete(e),void 0!==e.db&&null!=(null==a?void 0:a.onDB)&&a.onDB(e.db),r._onComplete(e)}})];case 2:throw(0,error_1$4.newError)("No connection available")}})})}).catch(function(e){null!=a&&a.onError(e),t._onError(e).catch(function(){})}).finally(function(){return t._acceptActive()})},e.prototype.run=function(e,t){e=(0,util_1$2.validateQueryAndParameters)(e,t),t=e.validatedQuery,e=e.params,t=this._state.run(t,e,{connectionHolder:this._connectionHolder,onError:this._onError,onComplete:this._onComplete,onConnection:this._onConnection,reactive:this._reactive,fetchSize:this._fetchSize,highRecordWatermark:this._highRecordWatermark,lowRecordWatermark:this._lowRecordWatermak,preparationJob:this._activePromise});return this._results.push(t),t},e.prototype.commit=function(){var t=this,r=this._state.commit({connectionHolder:this._connectionHolder,onError:this._onError,onComplete:function(e){return t._onCompleteCallback(e,t._bookmarks)},onConnection:this._onConnection,pendingResults:this._results,preparationJob:this._activePromise});return this._state=r.state,this._onClose(),new Promise(function(e,t){r.result.subscribe({onCompleted:function(){return e()},onError:function(e){return t(e)}})})},e.prototype.rollback=function(){var r=this._state.rollback({connectionHolder:this._connectionHolder,onError:this._onError,onComplete:this._onComplete,onConnection:this._onConnection,pendingResults:this._results,preparationJob:this._activePromise});return this._state=r.state,this._onClose(),new Promise(function(e,t){r.result.subscribe({onCompleted:function(){return e()},onError:function(e){return t(e)}})})},e.prototype.isOpen=function(){return this._state===_states$1.ACTIVE},e.prototype.close=function(){return __awaiter$g(this,void 0,void 0,function(){return __generator$i(this,function(e){switch(e.label){case 0:return this.isOpen()?[4,this.rollback()]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}})})},e.prototype[Symbol.asyncDispose]=function(){return this.close()},e.prototype._onErrorCallback=function(t){return this._state===_states$1.FAILED?Promise.resolve(null):(this._state=_states$1.FAILED,this._onClose(),this._results.forEach(function(e){e.isOpen()&&e._streamObserverPromise.then(function(e){return e.onError(t)}).catch(function(e){})}),this._connectionHolder.releaseConnection())},e.prototype._onCompleteCallback=function(e,t){this._onBookmarks(new bookmarks_1$2.Bookmarks(null==e?void 0:e.bookmark),null!=t?t:bookmarks_1$2.Bookmarks.empty(),null==e?void 0:e.db)},e}(),_states$1={ACTIVE:{commit:function(e){return{result:finishTransaction(!0,e.connectionHolder,e.onError,e.onComplete,e.onConnection,e.pendingResults,e.preparationJob),state:_states$1.SUCCEEDED}},rollback:function(e){return{result:finishTransaction(!1,e.connectionHolder,e.onError,e.onComplete,e.onConnection,e.pendingResults,e.preparationJob),state:_states$1.ROLLED_BACK}},run:function(t,r,e){var n=e.connectionHolder,o=e.onError,i=e.onComplete,a=e.onConnection,s=e.reactive,u=e.fetchSize,c=e.highRecordWatermark,l=e.lowRecordWatermark,e=e.preparationJob,f=null!=e?e:Promise.resolve();return newCompletedResult(n.getConnection().then(function(e){return f.then(function(){return e})}).then(function(e){if(a(),null!=e)return e.run(t,r,{bookmarks:bookmarks_1$2.Bookmarks.empty(),txConfig:tx_config_1$1.TxConfig.empty(),beforeError:o,afterComplete:i,reactive:s,fetchSize:u,highRecordWatermark:c,lowRecordWatermark:l});throw(0,error_1$4.newError)("No connection available")}).catch(function(e){return new observers_1$1.FailedObserver({error:e,onError:o})}),t,r,n,c,l)}},FAILED:{commit:function(e){var t=e.connectionHolder,r=e.onError;return e.onComplete,{result:newCompletedResult(new observers_1$1.FailedObserver({error:(0,error_1$4.newError)("Cannot commit this transaction, because it has been rolled back either because of an error or explicit termination."),onError:r}),"COMMIT",{},t,0,0),state:_states$1.FAILED}},rollback:function(e){var t=e.connectionHolder;return e.onError,e.onComplete,{result:newCompletedResult(new observers_1$1.CompletedObserver,"ROLLBACK",{},t,0,0),state:_states$1.FAILED}},run:function(e,t,r){var n=r.connectionHolder,o=r.onError;return r.onComplete,newCompletedResult(new observers_1$1.FailedObserver({error:(0,error_1$4.newError)("Cannot run query in this transaction, because it has been rolled back either because of an error or explicit termination."),onError:o}),e,t,n,0,0)}},SUCCEEDED:{commit:function(e){var t=e.connectionHolder,r=e.onError;return e.onComplete,{result:newCompletedResult(new observers_1$1.FailedObserver({error:(0,error_1$4.newError)("Cannot commit this transaction, because it has already been committed."),onError:r}),"COMMIT",{},connection_holder_1$1.EMPTY_CONNECTION_HOLDER,0,0),state:_states$1.SUCCEEDED,connectionHolder:t}},rollback:function(e){var t=e.connectionHolder,r=e.onError;return e.onComplete,{result:newCompletedResult(new observers_1$1.FailedObserver({error:(0,error_1$4.newError)("Cannot rollback this transaction, because it has already been committed."),onError:r}),"ROLLBACK",{},connection_holder_1$1.EMPTY_CONNECTION_HOLDER,0,0),state:_states$1.SUCCEEDED,connectionHolder:t}},run:function(e,t,r){var n=r.connectionHolder,o=r.onError;return r.onComplete,newCompletedResult(new observers_1$1.FailedObserver({error:(0,error_1$4.newError)("Cannot run query in this transaction, because it has already been committed."),onError:o}),e,t,n,0,0)}},ROLLED_BACK:{commit:function(e){var t=e.connectionHolder,r=e.onError;return e.onComplete,{result:newCompletedResult(new observers_1$1.FailedObserver({error:(0,error_1$4.newError)("Cannot commit this transaction, because it has already been rolled back."),onError:r}),"COMMIT",{},t,0,0),state:_states$1.ROLLED_BACK}},rollback:function(e){var t=e.connectionHolder;return e.onError,e.onComplete,{result:newCompletedResult(new observers_1$1.FailedObserver({error:(0,error_1$4.newError)("Cannot rollback this transaction, because it has already been rolled back.")}),"ROLLBACK",{},t,0,0),state:_states$1.ROLLED_BACK}},run:function(e,t,r){var n=r.connectionHolder,o=r.onError;return r.onComplete,newCompletedResult(new observers_1$1.FailedObserver({error:(0,error_1$4.newError)("Cannot run query in this transaction, because it has already been rolled back."),onError:o}),e,t,n,0,0)}}};function finishTransaction(r,e,n,o,i,a,t){var s=null!=t?t:Promise.resolve(),t=e.getConnection().then(function(e){return s.then(function(){return e})}).then(function(t){return i(),a.forEach(function(e){return e._cancel()}),Promise.all(a.map(function(e){return e.summary()})).then(function(e){if(null!=t)return r?t.commitTransaction({beforeError:n,afterComplete:o}):t.rollbackTransaction({beforeError:n,afterComplete:o});throw(0,error_1$4.newError)("No connection available")})}).catch(function(e){return new observers_1$1.FailedObserver({error:e,onError:n})});return new result_1$1.default(t,r?"COMMIT":"ROLLBACK",{},e,{high:Number.MAX_VALUE,low:Number.MAX_VALUE})}function newCompletedResult(e,t,r,n,o,i){return void 0===n&&(n=connection_holder_1$1.EMPTY_CONNECTION_HOLDER),new result_1$1.default(Promise.resolve(e),t,r,new connection_holder_1$1.ReadOnlyConnectionHolder(null!=n?n:connection_holder_1$1.EMPTY_CONNECTION_HOLDER),{low:i,high:o})}transaction.default=Transaction;var transactionManaged={},ManagedTransaction=(Object.defineProperty(transactionManaged,"__esModule",{value:!0}),function(){function t(e){e=e.run;this._run=e}return t.fromTransaction=function(e){return new t({run:e.run.bind(e)})},t.prototype.run=function(e,t){return this._run(e,t)},t}()),transactionPromise=(transactionManaged.default=ManagedTransaction,{}),__extends$P=commonjsGlobal&&commonjsGlobal.__extends||function(){var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}}(),__assign$u=commonjsGlobal&&commonjsGlobal.__assign||function(){return(__assign$u=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},__importDefault$Y=commonjsGlobal&&commonjsGlobal.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},transaction_1=(Object.defineProperty(transactionPromise,"__esModule",{value:!0}),__importDefault$Y(transaction)),TransactionPromise=function(_){function e(e){var t=e.connectionHolder,r=e.onClose,n=e.onBookmarks,o=e.onConnection,i=e.reactive,a=e.fetchSize,s=e.impersonatedUser,u=e.highRecordWatermark,c=e.lowRecordWatermark,l=e.notificationFilter,f=e.apiTelemetryConfig,e=e.onDbCallback,t=_.call(this,{connectionHolder:t,onClose:r,onBookmarks:n,onConnection:o,reactive:i,fetchSize:a,impersonatedUser:s,highRecordWatermark:u,lowRecordWatermark:c,notificationFilter:l,apiTelemetryConfig:f})||this;return t[_a$g]="TransactionPromise",t._onDbCallback=e,t}return __extends$P(e,_),e.prototype.then=function(e,t){return this._getOrCreateBeginPromise().then(e,t)},e.prototype.catch=function(e){return this._getOrCreateBeginPromise().catch(e)},e.prototype.finally=function(e){return this._getOrCreateBeginPromise().finally(e)},e.prototype._getOrCreateBeginPromise=function(){var r=this;return null==this._beginPromise&&(this._beginPromise=new Promise(function(e,t){r._resolve=e,r._reject=t,null!=r._beginError&&t(r._beginError),null!=r._beginMetadata&&e(r._toTransaction())})),this._beginPromise},e.prototype._toTransaction=function(){return __assign$u(__assign$u({},this),{run:_.prototype.run.bind(this),commit:_.prototype.commit.bind(this),rollback:_.prototype.rollback.bind(this),close:_.prototype.close.bind(this),isOpen:_.prototype.isOpen.bind(this),_begin:this._begin.bind(this)})},e.prototype._begin=function(e,t){return _.prototype._begin.call(this,e,t,{onError:this._onBeginError.bind(this),onComplete:this._onBeginMetadata.bind(this),onDB:this._onDbCallback})},e.prototype._onBeginError=function(e){this._beginError=e,null!=this._reject&&this._reject(e)},e.prototype._onBeginMetadata=function(e){this._beginMetadata=null!=e?e:{},null!=this._resolve&&this._resolve(this._toTransaction())},e}(transaction_1.default),_a$g=Symbol.toStringTag,session=(transactionPromise.default=TransactionPromise,{}),authUtil={},json_1$1=(Object.defineProperty(authUtil,"__esModule",{value:!0}),authUtil.cacheKey=void 0,json$3);function cacheKey(e,t){return null!=t?"basic:"+t:void 0===e?"DEFAULT":"basic"===e.scheme?"basic:"+(null!=(t=e.principal)?t:""):"kerberos"===e.scheme?"kerberos:"+e.credentials:"bearer"===e.scheme?"bearer:"+e.credentials:"none"===e.scheme?"none":(0,json_1$1.stringify)(e,{sortedElements:!0})}authUtil.cacheKey=cacheKey;var __awaiter$f=commonjsGlobal&&commonjsGlobal.__awaiter||function(e,a,s,u){return new(s=s||Promise)(function(r,t){function n(e){try{i(u.next(e))}catch(e){t(e)}}function o(e){try{i(u.throw(e))}catch(e){t(e)}}function i(e){var t;e.done?r(e.value):((t=e.value)instanceof s?t:new s(function(e){e(t)})).then(n,o)}i((u=u.apply(e,a||[])).next())})},__generator$h=commonjsGlobal&&commonjsGlobal.__generator||function(n,o){var i,a,s,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},c={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(c[Symbol.iterator]=function(){return this}),c;function e(r){return function(e){var t=[r,e];if(i)throw new TypeError("Generator is already executing.");for(;u=c&&t[c=0]?0:u;)try{if(i=1,a&&(s=2&t[0]?a.return:t[0]?a.throw||((s=a.return)&&s.call(a),0):a.next)&&!(s=s.call(a,t[1])).done)return s;switch(a=0,(t=s?[2&t[0],s.value]:t)[0]){case 0:case 1:s=t;break;case 4:return u.label++,{value:t[1],done:!1};case 5:u.label++,a=t[1],t=[0];continue;case 7:t=u.ops.pop(),u.trys.pop();continue;default:if(!(s=0<(s=u.trys).length&&s[s.length-1])&&(6===t[0]||2===t[0])){u=0;continue}if(3===t[0]&&(!s||t[1]>s[0]&&t[1]<s[3])){u.label=t[1];break}if(6===t[0]&&u.label<s[1]){u.label=s[1],s=t;break}if(s&&u.label<s[2]){u.label=s[2],u.ops.push(t);break}s[2]&&u.ops.pop(),u.trys.pop();continue}t=o.call(n,u)}catch(e){t=[6,e],a=0}finally{i=s=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}}},__read$r=commonjsGlobal&&commonjsGlobal.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),a=[];try{for(;(void 0===t||0<t--)&&!(n=i.next()).done;)a.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a},__spreadArray$l=commonjsGlobal&&commonjsGlobal.__spreadArray||function(e,t,r){if(r||2===arguments.length)for(var n,o=0,i=t.length;o<i;o++)!n&&o in t||((n=n||Array.prototype.slice.call(t,0,o))[o]=t[o]);return e.concat(n||Array.prototype.slice.call(t))},__importDefault$X=commonjsGlobal&&commonjsGlobal.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},observers_1=(Object.defineProperty(session,"__esModule",{value:!0}),observers),util_1$1=util$4,constants_1$2=constants$1,error_1$3=error,result_1=__importDefault$X(result),connection_holder_1=connectionHolder$1,transaction_executor_1=transactionExecutor$1,bookmarks_1$1=bookmarks$1,tx_config_1=txConfig$1,transaction_promise_1=__importDefault$X(transactionPromise),transaction_managed_1=__importDefault$X(transactionManaged),auth_util_1$1=authUtil,Session=function(){function o(e){var t=e.mode,r=e.connectionProvider,n=e.bookmarks,o=e.database,i=e.config,a=e.reactive,s=e.fetchSize,u=e.impersonatedUser,c=e.bookmarkManager,l=e.notificationFilter,f=e.auth,_=e.log,e=e.homeDatabaseCallback,t=(this._mode=t,this._database=o,this._reactive=a,this._fetchSize=s,this._homeDatabaseCallback=e,this._auth=f,this._getConnectionAcquistionBookmarks=this._getConnectionAcquistionBookmarks.bind(this),this._readConnectionHolder=new connection_holder_1.ConnectionHolder({mode:constants_1$2.ACCESS_MODE_READ,auth:f,database:o,bookmarks:n,connectionProvider:r,impersonatedUser:u,onDatabaseNameResolved:this._onDatabaseNameResolved.bind(this),getConnectionAcquistionBookmarks:this._getConnectionAcquistionBookmarks,log:_}),this._writeConnectionHolder=new connection_holder_1.ConnectionHolder({mode:constants_1$2.ACCESS_MODE_WRITE,auth:f,database:o,bookmarks:n,connectionProvider:r,impersonatedUser:u,onDatabaseNameResolved:this._onDatabaseNameResolved.bind(this),getConnectionAcquistionBookmarks:this._getConnectionAcquistionBookmarks,log:_}),this._open=!0,this._hasTx=!1,this._impersonatedUser=u,this._lastBookmarks=null!=n?n:bookmarks_1$1.Bookmarks.empty(),this._configuredBookmarks=this._lastBookmarks,this._transactionExecutor=_createTransactionExecutor(i),this._databaseNameResolved=""!==this._database,this._calculateWatermaks());this._lowRecordWatermark=t.low,this._highRecordWatermark=t.high,this._results=[],this._bookmarkManager=c,this._notificationFilter=l,this._log=_,this._databaseGuess=null==i?void 0:i.cachedHomeDatabase,this._isRoutingSession=null!=(a=null==i?void 0:i.routingDriver)&&a}return o.prototype.run=function(e,t,r){var o=this,e=(0,util_1$1.validateQueryAndParameters)(e,t),i=e.validatedQuery,a=e.params,s=null!=r?new tx_config_1.TxConfig(r,this._log):tx_config_1.TxConfig.empty(),t=this._run(i,a,function(n){return __awaiter$f(o,void 0,void 0,function(){var t,r=this;return __generator$h(this,function(e){switch(e.label){case 0:return[4,this._bookmarks()];case 1:return t=e.sent(),this._assertSessionIsOpen(),[2,n.run(i,a,{bookmarks:t,txConfig:s,mode:this._mode,database:this._database,apiTelemetryConfig:{api:constants_1$2.TELEMETRY_APIS.AUTO_COMMIT_TRANSACTION},impersonatedUser:this._impersonatedUser,afterComplete:function(e){return r._onCompleteCallback(e,t)},reactive:this._reactive,fetchSize:this._fetchSize,lowRecordWatermark:this._lowRecordWatermark,highRecordWatermark:this._highRecordWatermark,notificationFilter:this._notificationFilter,onDb:this._onDatabaseNameResolved.bind(this)})]}})})});return this._results.push(t),t},o.prototype._run=function(e,t,r){var r=this._acquireAndConsumeConnection(r),n=r.connectionHolder,r=r.resultPromise.catch(function(e){return Promise.resolve(new observers_1.FailedObserver({error:e}))}),o={high:this._highRecordWatermark,low:this._lowRecordWatermark};return new result_1.default(r,e,t,n,o)},o.prototype._acquireConnection=function(e){var r=this,e=this._acquireAndConsumeConnection(e),n=e.connectionHolder;return e.resultPromise.then(function(t){return __awaiter$f(r,void 0,void 0,function(){return __generator$h(this,function(e){switch(e.label){case 0:return[4,n.releaseConnection()];case 1:return e.sent(),[2,t]}})})})},o.prototype._acquireAndConsumeConnection=function(t){var e=this._connectionHolderWithMode(this._mode),r=this._open?!this._hasTx&&e.initializeConnection(this._databaseGuess)?e.getConnection().then(function(e){return t(e)}):Promise.reject((0,error_1$3.newError)("Queries cannot be run directly on a session with an open transaction; either run from within the transaction or use a different session.")):Promise.reject((0,error_1$3.newError)("Cannot run query in a closed session."));return{connectionHolder:e,resultPromise:r}},o.prototype.beginTransaction=function(e){var t=tx_config_1.TxConfig.empty();return null!=e&&(t=new tx_config_1.TxConfig(e,this._log)),this._beginTransaction(this._mode,t,{api:constants_1$2.TELEMETRY_APIS.UNMANAGED_TRANSACTION})},o.prototype._beginTransaction=function(e,t,r){var n=this;if(!this._open)throw(0,error_1$3.newError)("Cannot begin a transaction on a closed session.");if(this._hasTx)throw(0,error_1$3.newError)("You cannot begin a transaction on a session with an open transaction; either run from within the transaction or use a different session.");e=o._validateSessionMode(e),e=this._connectionHolderWithMode(e),e.initializeConnection(this._databaseGuess),this._hasTx=!0,e=new transaction_promise_1.default({connectionHolder:e,impersonatedUser:this._impersonatedUser,onClose:this._transactionClosed.bind(this),onBookmarks:function(e,t,r){return n._updateBookmarks(e,t,r)},onConnection:this._assertSessionIsOpen.bind(this),reactive:this._reactive,fetchSize:this._fetchSize,lowRecordWatermark:this._lowRecordWatermark,highRecordWatermark:this._highRecordWatermark,notificationFilter:this._notificationFilter,apiTelemetryConfig:r,onDbCallback:this._onDatabaseNameResolved.bind(this)});return e._begin(function(){return n._bookmarks()},t),e},o.prototype._assertSessionIsOpen=function(){if(!this._open)throw(0,error_1$3.newError)("You cannot run more transactions on a closed session.")},o.prototype._transactionClosed=function(){this._hasTx=!1},o.prototype.lastBookmark=function(){return this.lastBookmarks()},o.prototype.lastBookmarks=function(){return this._lastBookmarks.values()},o.prototype._bookmarks=function(){var r;return __awaiter$f(this,void 0,void 0,function(){var t;return __generator$h(this,function(e){switch(e.label){case 0:return[4,null==(r=this._bookmarkManager)?void 0:r.getBookmarks()];case 1:return void 0===(t=e.sent())?[2,this._lastBookmarks]:[2,new bookmarks_1$1.Bookmarks(__spreadArray$l(__spreadArray$l([],__read$r(t),!1),__read$r(this._configuredBookmarks),!1))]}})})},o.prototype.readTransaction=function(e,t){t=new tx_config_1.TxConfig(t,this._log);return this._runTransaction(constants_1$2.ACCESS_MODE_READ,t,e)},o.prototype.writeTransaction=function(e,t){t=new tx_config_1.TxConfig(t,this._log);return this._runTransaction(constants_1$2.ACCESS_MODE_WRITE,t,e)},o.prototype._runTransaction=function(t,r,e){var n=this;return this._transactionExecutor.execute(function(e){return n._beginTransaction(t,r,e)},e)},o.prototype.executeRead=function(e,t){t=new tx_config_1.TxConfig(t,this._log);return this._executeInTransaction(constants_1$2.ACCESS_MODE_READ,t,e)},o.prototype.executeWrite=function(e,t){t=new tx_config_1.TxConfig(t,this._log);return this._executeInTransaction(constants_1$2.ACCESS_MODE_WRITE,t,e)},o.prototype._executeInTransaction=function(t,r,e){var n=this;return this._transactionExecutor.execute(function(e){return n._beginTransaction(t,r,e)},e,transaction_managed_1.default.fromTransaction)},o.prototype._onDatabaseNameResolved=function(e){var t;this._isRoutingSession&&(this._databaseGuess=e,this._databaseNameResolved||(this._database=t=null!=e?e:"",this._readConnectionHolder.setDatabase(t),this._writeConnectionHolder.setDatabase(t),this._databaseNameResolved=!0,null!=this._homeDatabaseCallback&&this._homeDatabaseCallback((0,auth_util_1$1.cacheKey)(this._auth,this._impersonatedUser),e)))},o.prototype._getConnectionAcquistionBookmarks=function(){var r;return __awaiter$f(this,void 0,void 0,function(){var t;return __generator$h(this,function(e){switch(e.label){case 0:return[4,null==(r=this._bookmarkManager)?void 0:r.getBookmarks()];case 1:return void 0===(t=e.sent())?[2,this._lastBookmarks]:[2,new bookmarks_1$1.Bookmarks(__spreadArray$l(__spreadArray$l([],__read$r(this._configuredBookmarks),!1),__read$r(t),!1))]}})})},o.prototype._updateBookmarks=function(e,t,r){var n;null==e||e.isEmpty()||(null!=(n=this._bookmarkManager)&&n.updateBookmarks(null!=(n=null==t?void 0:t.values())?n:[],null!=(t=null==e?void 0:e.values())?t:[]).catch(function(){}),this._lastBookmarks=e,this._configuredBookmarks=bookmarks_1$1.Bookmarks.empty())},o.prototype.close=function(){return __awaiter$f(this,void 0,void 0,function(){return __generator$h(this,function(e){switch(e.label){case 0:return this._open?(this._open=!1,this._results.forEach(function(e){return e._cancel()}),this._transactionExecutor.close(),[4,this._readConnectionHolder.close(this._hasTx)]):[3,3];case 1:return e.sent(),[4,this._writeConnectionHolder.close(this._hasTx)];case 2:e.sent(),e.label=3;case 3:return[2]}})})},o.prototype[Symbol.asyncDispose]=function(){return this.close()},o.prototype._connectionHolderWithMode=function(e){if(e===constants_1$2.ACCESS_MODE_READ)return this._readConnectionHolder;if(e===constants_1$2.ACCESS_MODE_WRITE)return this._writeConnectionHolder;throw(0,error_1$3.newError)("Unknown access mode: "+e)},o.prototype._onCompleteCallback=function(e,t){this._updateBookmarks(new bookmarks_1$1.Bookmarks(e.bookmark),t,e.db)},o.prototype._calculateWatermaks=function(){return this._fetchSize===constants_1$2.FETCH_ALL?{low:Number.MAX_VALUE,high:Number.MAX_VALUE}:{low:.3*this._fetchSize,high:.7*this._fetchSize}},o.prototype._configureTransactionExecutor=function(e,t){this._transactionExecutor.pipelineBegin=e,this._transactionExecutor.telemetryApi=t},o._validateSessionMode=function(e){e=null!=e?e:constants_1$2.ACCESS_MODE_WRITE;if(e!==constants_1$2.ACCESS_MODE_READ&&e!==constants_1$2.ACCESS_MODE_WRITE)throw(0,error_1$3.newError)("Illegal session mode "+e);return e},o}();function _createTransactionExecutor(e){e=null!=(e=null==e?void 0:e.maxTransactionRetryTime)?e:null;return new transaction_executor_1.TransactionExecutor(e)}session.default=Session;var driver={},bookmarkManager$1={},__awaiter$e=commonjsGlobal&&commonjsGlobal.__awaiter||function(e,a,s,u){return new(s=s||Promise)(function(r,t){function n(e){try{i(u.next(e))}catch(e){t(e)}}function o(e){try{i(u.throw(e))}catch(e){t(e)}}function i(e){var t;e.done?r(e.value):((t=e.value)instanceof s?t:new s(function(e){e(t)})).then(n,o)}i((u=u.apply(e,a||[])).next())})},__generator$g=commonjsGlobal&&commonjsGlobal.__generator||function(n,o){var i,a,s,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},c={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(c[Symbol.iterator]=function(){return this}),c;function e(r){return function(e){var t=[r,e];if(i)throw new TypeError("Generator is already executing.");for(;u=c&&t[c=0]?0:u;)try{if(i=1,a&&(s=2&t[0]?a.return:t[0]?a.throw||((s=a.return)&&s.call(a),0):a.next)&&!(s=s.call(a,t[1])).done)return s;switch(a=0,(t=s?[2&t[0],s.value]:t)[0]){case 0:case 1:s=t;break;case 4:return u.label++,{value:t[1],done:!1};case 5:u.label++,a=t[1],t=[0];continue;case 7:t=u.ops.pop(),u.trys.pop();continue;default:if(!(s=0<(s=u.trys).length&&s[s.length-1])&&(6===t[0]||2===t[0])){u=0;continue}if(3===t[0]&&(!s||t[1]>s[0]&&t[1]<s[3])){u.label=t[1];break}if(6===t[0]&&u.label<s[1]){u.label=s[1],s=t;break}if(s&&u.label<s[2]){u.label=s[2],u.ops.push(t);break}s[2]&&u.ops.pop(),u.trys.pop();continue}t=o.call(n,u)}catch(e){t=[6,e],a=0}finally{i=s=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}}},__values$b=commonjsGlobal&&commonjsGlobal.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return{value:(e=e&&n>=e.length?void 0:e)&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},__read$q=commonjsGlobal&&commonjsGlobal.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),a=[];try{for(;(void 0===t||0<t--)&&!(n=i.next()).done;)a.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a},__spreadArray$k=commonjsGlobal&&commonjsGlobal.__spreadArray||function(e,t,r){if(r||2===arguments.length)for(var n,o=0,i=t.length;o<i;o++)!n&&o in t||((n=n||Array.prototype.slice.call(t,0,o))[o]=t[o]);return e.concat(n||Array.prototype.slice.call(t))},BookmarkManager=(Object.defineProperty(bookmarkManager$1,"__esModule",{value:!0}),bookmarkManager$1.bookmarkManager=void 0,function(){function e(){throw new Error("Not implemented")}return e.prototype.updateBookmarks=function(e,t){return __awaiter$e(this,void 0,void 0,function(){return __generator$g(this,function(e){throw new Error("Not implemented")})})},e.prototype.getBookmarks=function(){return __awaiter$e(this,void 0,void 0,function(){return __generator$g(this,function(e){throw new Error("Not implemented")})})},e}());function bookmarkManager(e){void 0===e&&(e={});var t=new Set(e.initialBookmarks);return new Neo4jBookmarkManager(t,e.bookmarksSupplier,e.bookmarksConsumer)}bookmarkManager$1.default=BookmarkManager,bookmarkManager$1.bookmarkManager=bookmarkManager;var Neo4jBookmarkManager=function(){function e(e,t,r){this._bookmarks=e,this._bookmarksSupplier=t,this._bookmarksConsumer=r}return e.prototype.updateBookmarks=function(f,_){return __awaiter$e(this,void 0,void 0,function(){var t,r,n,o,i,a,s,u,c,l;return __generator$g(this,function(e){switch(e.label){case 0:t=this._bookmarks;try{for(r=__values$b(f),n=r.next();!n.done;n=r.next())a=n.value,t.delete(a)}catch(e){s={error:e}}finally{try{n&&!n.done&&(u=r.return)&&u.call(r)}finally{if(s)throw s.error}}try{for(o=__values$b(_),i=o.next();!i.done;i=o.next())a=i.value,t.add(a)}catch(e){c={error:e}}finally{try{i&&!i.done&&(l=o.return)&&l.call(o)}finally{if(c)throw c.error}}return"function"!=typeof this._bookmarksConsumer?[3,2]:[4,this._bookmarksConsumer(__spreadArray$k([],__read$q(t),!1))];case 1:e.sent(),e.label=2;case 2:return[2]}})})},e.prototype.getBookmarks=function(){var u;return __awaiter$e(this,void 0,void 0,function(){var t,r,n,o,i,a,s;return __generator$g(this,function(e){switch(e.label){case 0:return t=new Set(this._bookmarks),"function"!=typeof this._bookmarksSupplier?[3,2]:[4,this._bookmarksSupplier()];case 1:r=null!=(u=e.sent())?u:[];try{for(n=__values$b(r),o=n.next();!o.done;o=n.next())i=o.value,t.add(i)}catch(e){a={error:e}}finally{try{o&&!o.done&&(s=n.return)&&s.call(n)}finally{if(a)throw a.error}}e.label=2;case 2:return[2,__spreadArray$k([],__read$q(t),!1)]}})})},e}(),resultTransformers$1={},__awaiter$d=commonjsGlobal&&commonjsGlobal.__awaiter||function(e,a,s,u){return new(s=s||Promise)(function(r,t){function n(e){try{i(u.next(e))}catch(e){t(e)}}function o(e){try{i(u.throw(e))}catch(e){t(e)}}function i(e){var t;e.done?r(e.value):((t=e.value)instanceof s?t:new s(function(e){e(t)})).then(n,o)}i((u=u.apply(e,a||[])).next())})},__generator$f=commonjsGlobal&&commonjsGlobal.__generator||function(n,o){var i,a,s,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},c={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(c[Symbol.iterator]=function(){return this}),c;function e(r){return function(e){var t=[r,e];if(i)throw new TypeError("Generator is already executing.");for(;u=c&&t[c=0]?0:u;)try{if(i=1,a&&(s=2&t[0]?a.return:t[0]?a.throw||((s=a.return)&&s.call(a),0):a.next)&&!(s=s.call(a,t[1])).done)return s;switch(a=0,(t=s?[2&t[0],s.value]:t)[0]){case 0:case 1:s=t;break;case 4:return u.label++,{value:t[1],done:!1};case 5:u.label++,a=t[1],t=[0];continue;case 7:t=u.ops.pop(),u.trys.pop();continue;default:if(!(s=0<(s=u.trys).length&&s[s.length-1])&&(6===t[0]||2===t[0])){u=0;continue}if(3===t[0]&&(!s||t[1]>s[0]&&t[1]<s[3])){u.label=t[1];break}if(6===t[0]&&u.label<s[1]){u.label=s[1],s=t;break}if(s&&u.label<s[2]){u.label=s[2],u.ops.push(t);break}s[2]&&u.ops.pop(),u.trys.pop();continue}t=o.call(n,u)}catch(e){t=[6,e],a=0}finally{i=s=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}}},__importDefault$W=commonjsGlobal&&commonjsGlobal.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},result_eager_1=(Object.defineProperty(resultTransformers$1,"__esModule",{value:!0}),__importDefault$W(resultEager)),error_1$2=error,ResultTransformers=function(){function e(){}return e.prototype.eagerResultTransformer=function(){return createEagerResultFromResult},e.prototype.eager=function(){return createEagerResultFromResult},e.prototype.mappedResultTransformer=function(e){return createMappedResultTransformer(e)},e.prototype.mapped=function(e){return createMappedResultTransformer(e)},e.prototype.first=function(){return first$2},e.prototype.summary=function(){return summary},e}(),resultTransformers=new ResultTransformers;function createEagerResultFromResult(o){return __awaiter$d(this,void 0,void 0,function(){var t,r,n;return __generator$f(this,function(e){switch(e.label){case 0:return[4,o];case 1:return r=e.sent(),t=r.summary,r=r.records,[4,o.keys()];case 2:return n=e.sent(),[2,new result_eager_1.default(n,r,t)]}})})}function createMappedResultTransformer(i){var e=this;if(null==i||null==i.collect&&null==i.map)throw(0,error_1$2.newError)("Requires a map or/and a collect functions.");return function(o){return __awaiter$d(e,void 0,void 0,function(){return __generator$f(this,function(e){switch(e.label){case 0:return[4,new Promise(function(t,r){var n={records:[],keys:[]};o.subscribe({onKeys:function(e){n.keys=e},onNext:function(e){var t;null!=i.map?void 0!==(t=i.map(e))&&n.records.push(t):n.records.push(e)},onCompleted:function(e){null!=i.collect?t(i.collect(n.records,e,n.keys)):(e={records:n.records,summary:e,keys:n.keys},t(e))},onError:function(e){r(e)}})})];case 1:return[2,e.sent()]}})})}}function first$2(o){return __awaiter$d(this,void 0,void 0,function(){var t,r,n;return __generator$f(this,function(e){switch(e.label){case 0:return[4,(t=o[Symbol.asyncIterator]()).next()];case 1:n=e.sent(),r=n.value,n=n.done,e.label=2;case 2:return e.trys.push([2,,3,6]),!0===n?[2,void 0]:[2,r];case 3:return null==t.return?[3,5]:[4,t.return()];case 4:e.sent(),e.label=5;case 5:return[7];case 6:return[2]}})})}function summary(t){return __awaiter$d(this,void 0,void 0,function(){return __generator$f(this,function(e){switch(e.label){case 0:return[4,t.summary()];case 1:return[2,e.sent()]}})})}Object.freeze(resultTransformers),resultTransformers$1.default=resultTransformers;var queryExecutor={},__awaiter$c=commonjsGlobal&&commonjsGlobal.__awaiter||function(e,a,s,u){return new(s=s||Promise)(function(r,t){function n(e){try{i(u.next(e))}catch(e){t(e)}}function o(e){try{i(u.throw(e))}catch(e){t(e)}}function i(e){var t;e.done?r(e.value):((t=e.value)instanceof s?t:new s(function(e){e(t)})).then(n,o)}i((u=u.apply(e,a||[])).next())})},__generator$e=commonjsGlobal&&commonjsGlobal.__generator||function(n,o){var i,a,s,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},c={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(c[Symbol.iterator]=function(){return this}),c;function e(r){return function(e){var t=[r,e];if(i)throw new TypeError("Generator is already executing.");for(;u=c&&t[c=0]?0:u;)try{if(i=1,a&&(s=2&t[0]?a.return:t[0]?a.throw||((s=a.return)&&s.call(a),0):a.next)&&!(s=s.call(a,t[1])).done)return s;switch(a=0,(t=s?[2&t[0],s.value]:t)[0]){case 0:case 1:s=t;break;case 4:return u.label++,{value:t[1],done:!1};case 5:u.label++,a=t[1],t=[0];continue;case 7:t=u.ops.pop(),u.trys.pop();continue;default:if(!(s=0<(s=u.trys).length&&s[s.length-1])&&(6===t[0]||2===t[0])){u=0;continue}if(3===t[0]&&(!s||t[1]>s[0]&&t[1]<s[3])){u.label=t[1];break}if(6===t[0]&&u.label<s[1]){u.label=s[1],s=t;break}if(s&&u.label<s[2]){u.label=s[2],u.ops.push(t);break}s[2]&&u.ops.pop(),u.trys.pop();continue}t=o.call(n,u)}catch(e){t=[6,e],a=0}finally{i=s=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}}},constants_1$1=(Object.defineProperty(queryExecutor,"__esModule",{value:!0}),constants$1),QueryExecutor=function(){function e(e){this._createSession=e}return e.prototype.execute=function(o,i,a){return __awaiter$c(this,void 0,void 0,function(){var t,r,n=this;return __generator$e(this,function(e){switch(e.label){case 0:t=this._createSession({database:o.database,bookmarkManager:o.bookmarkManager,impersonatedUser:o.impersonatedUser,auth:o.auth}),r=installEventListenerWhenPossible(o.signal,"abort",function(){return __awaiter$c(n,void 0,void 0,function(){return __generator$e(this,function(e){switch(e.label){case 0:return[4,t.close()];case 1:return[2,e.sent()]}})})}),t._configureTransactionExecutor(!0,constants_1$1.TELEMETRY_APIS.EXECUTE_QUERY),e.label=1;case 1:return e.trys.push([1,,3,5]),[4,("READ"===o.routing?t.executeRead:t.executeWrite).bind(t)(function(r){return __awaiter$c(n,void 0,void 0,function(){var t;return __generator$e(this,function(e){switch(e.label){case 0:return t=r.run(i,a),[4,o.resultTransformer(t)];case 1:return[2,e.sent()]}})})},o.transactionConfig)];case 2:return[2,e.sent()];case 3:return r.uninstall(),[4,t.close()];case 4:return e.sent(),[7];case 5:return[2]}})})},e}();function installEventListenerWhenPossible(e,t,r){return"function"==typeof(null==e?void 0:e.addEventListener)&&e.addEventListener(t,r),{uninstall:function(){"function"==typeof(null==e?void 0:e.removeEventListener)&&e.removeEventListener(t,r)}}}queryExecutor.default=QueryExecutor;var homedbCache={},HomeDatabaseCache=(Object.defineProperty(homedbCache,"__esModule",{value:!0}),function(){function e(e){this.maxSize=e,this.pruneCount=Math.max(Math.round(.01*e*Math.log(e)),1),this.map=new Map}return e.prototype.set=function(e,t){this.map.set(e,{database:t,lastUsed:Date.now()}),this._pruneCache()},e.prototype.get=function(e){e=this.map.get(e);if(void 0!==e)return e.lastUsed=Date.now(),e.database},e.prototype.delete=function(e){this.map.delete(e)},e.prototype._pruneCache=function(){if(this.map.size>this.maxSize)for(var e=Array.from(this.map.entries()).sort(function(e,t){return e[1].lastUsed-t[1].lastUsed}),t=0;t<this.pruneCount;t++)this.map.delete(e[t][0])},e}()),__assign$t=(homedbCache.default=HomeDatabaseCache,commonjsGlobal&&commonjsGlobal.__assign||function(){return(__assign$t=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)}),__awaiter$b=commonjsGlobal&&commonjsGlobal.__awaiter||function(e,a,s,u){return new(s=s||Promise)(function(r,t){function n(e){try{i(u.next(e))}catch(e){t(e)}}function o(e){try{i(u.throw(e))}catch(e){t(e)}}function i(e){var t;e.done?r(e.value):((t=e.value)instanceof s?t:new s(function(e){e(t)})).then(n,o)}i((u=u.apply(e,a||[])).next())})},__generator$d=commonjsGlobal&&commonjsGlobal.__generator||function(n,o){var i,a,s,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},c={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(c[Symbol.iterator]=function(){return this}),c;function e(r){return function(e){var t=[r,e];if(i)throw new TypeError("Generator is already executing.");for(;u=c&&t[c=0]?0:u;)try{if(i=1,a&&(s=2&t[0]?a.return:t[0]?a.throw||((s=a.return)&&s.call(a),0):a.next)&&!(s=s.call(a,t[1])).done)return s;switch(a=0,(t=s?[2&t[0],s.value]:t)[0]){case 0:case 1:s=t;break;case 4:return u.label++,{value:t[1],done:!1};case 5:u.label++,a=t[1],t=[0];continue;case 7:t=u.ops.pop(),u.trys.pop();continue;default:if(!(s=0<(s=u.trys).length&&s[s.length-1])&&(6===t[0]||2===t[0])){u=0;continue}if(3===t[0]&&(!s||t[1]>s[0]&&t[1]<s[3])){u.label=t[1];break}if(6===t[0]&&u.label<s[1]){u.label=s[1],s=t;break}if(s&&u.label<s[2]){u.label=s[2],u.ops.push(t);break}s[2]&&u.ops.pop(),u.trys.pop();continue}t=o.call(n,u)}catch(e){t=[6,e],a=0}finally{i=s=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}}},__importDefault$V=commonjsGlobal&&commonjsGlobal.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},bookmarks_1=(Object.defineProperty(driver,"__esModule",{value:!0}),driver.QueryConfig=driver.SessionConfig=driver.routing=driver.WRITE=driver.READ=driver.Driver=void 0,bookmarks$1),configured_custom_resolver_1=__importDefault$V(configuredCustomResolver),constants_1=constants$1,logger_1=logger$1,session_1=__importDefault$V(session),util_1=util$4,bookmark_manager_1=bookmarkManager$1,result_transformers_1=__importDefault$V(resultTransformers$1),query_executor_1=__importDefault$V(queryExecutor),error_1$1=error,homedb_cache_1=__importDefault$V(homedbCache),auth_util_1=authUtil,DEFAULT_MAX_CONNECTION_LIFETIME=36e5,DEFAULT_FETCH_SIZE=1e3,HOMEDB_CACHE_MAX_SIZE=1e4,READ$3=constants_1.ACCESS_MODE_READ,WRITE$3=(driver.READ=READ$3,constants_1.ACCESS_MODE_WRITE),idGenerator$1=(driver.WRITE=WRITE$3,0),SessionConfig=function(){this.defaultAccessMode=WRITE$3,this.bookmarks=[],this.database="",this.impersonatedUser=void 0,this.auth=void 0,this.fetchSize=void 0,this.bookmarkManager=void 0,this.notificationFilter=void 0},ROUTING_WRITE=(driver.SessionConfig=SessionConfig,"WRITE"),ROUTING_READ="READ",routing={WRITE:ROUTING_WRITE,READ:ROUTING_READ},QueryConfig=(driver.routing=routing,Object.freeze(routing),function(){this.routing=routing.WRITE,this.resultTransformer=void 0,this.database="",this.impersonatedUser=void 0,this.bookmarkManager=void 0,this.transactionConfig=void 0,this.auth=void 0,this.signal=void 0}),Driver$1=(driver.QueryConfig=QueryConfig,function(){function e(e,t,r,n,o){void 0===n&&(n=function(e){return new session_1.default(e)}),void 0===o&&(o=function(e){return new query_executor_1.default(e)}),sanitizeConfig(t=void 0===t?{}:t);var i=logger_1.Logger.create(t);validateConfig(t,i),this._id=idGenerator$1++,this._meta=e,this._config=t,this._log=i,this._createConnectionProvider=r,this._createSession=n,this._defaultExecuteQueryBookmarkManager=(0,bookmark_manager_1.bookmarkManager)(),this._queryExecutor=o(this.session.bind(this)),this._connectionProvider=null,this.homeDatabaseCache=new homedb_cache_1.default(HOMEDB_CACHE_MAX_SIZE),this._afterConstruction()}return Object.defineProperty(e.prototype,"executeQueryBookmarkManager",{get:function(){return this._defaultExecuteQueryBookmarkManager},enumerable:!1,configurable:!0}),e.prototype.executeQuery=function(o,i,a){var s,u;return void 0===a&&(a={}),__awaiter$b(this,void 0,void 0,function(){var t,r,n;return __generator$d(this,function(e){switch(e.label){case 0:if(t=null===a.bookmarkManager?void 0:null!=(s=a.bookmarkManager)?s:this.executeQueryBookmarkManager,r=null!=(s=a.resultTransformer)?s:result_transformers_1.default.eagerResultTransformer(),(n=null!=(u=a.routing)?u:routing.WRITE)!==routing.READ&&n!==routing.WRITE)throw(0,error_1$1.newError)('Illegal query routing config: "'.concat(n,'"'));return[4,this._queryExecutor.execute({resultTransformer:r,bookmarkManager:t,routing:n,database:a.database,impersonatedUser:a.impersonatedUser,transactionConfig:a.transactionConfig,auth:a.auth,signal:a.signal},o,i)];case 1:return[2,e.sent()]}})})},e.prototype.verifyConnectivity=function(e){e=(void 0===e?{}:e).database,e=void 0===e?"":e;return this._getOrCreateConnectionProvider().verifyConnectivityAndGetServerInfo({database:e,accessMode:READ$3})},e.prototype.verifyAuthentication=function(e){var e=void 0===e?{}:e,t=e.database,r=e.auth;return __awaiter$b(this,void 0,void 0,function(){return __generator$d(this,function(e){switch(e.label){case 0:return[4,this._getOrCreateConnectionProvider().verifyAuthentication({database:null!=t?t:"system",auth:r,accessMode:READ$3})];case 1:return[2,e.sent()]}})})},e.prototype.getServerInfo=function(e){e=(void 0===e?{}:e).database,e=void 0===e?"":e;return this._getOrCreateConnectionProvider().verifyConnectivityAndGetServerInfo({database:e,accessMode:READ$3})},e.prototype.supportsMultiDb=function(){return this._getOrCreateConnectionProvider().supportsMultiDb()},e.prototype.supportsTransactionConfig=function(){return this._getOrCreateConnectionProvider().supportsTransactionConfig()},e.prototype.supportsUserImpersonation=function(){return this._getOrCreateConnectionProvider().supportsUserImpersonation()},e.prototype.supportsSessionAuth=function(){return this._getOrCreateConnectionProvider().supportsSessionAuth()},e.prototype.getNegotiatedProtocolVersion=function(){return this._getOrCreateConnectionProvider().getNegotiatedProtocolVersion()},e.prototype.isEncrypted=function(){return this._isEncrypted()},e.prototype._supportsRouting=function(){return this._meta.routing},e.prototype._isEncrypted=function(){return this._config.encrypted===util_1.ENCRYPTION_ON||!0===this._config.encrypted},e.prototype._getTrust=function(){return this._config.trust},e.prototype.session=function(e){var e=void 0===e?{}:e,t=e.defaultAccessMode,r=e.bookmarks,n=e.database,o=e.impersonatedUser,i=e.fetchSize,a=e.bookmarkManager,s=e.notificationFilter,e=e.auth;return this._newSession({defaultAccessMode:void 0===t?WRITE$3:t,bookmarkOrBookmarks:r,database:void 0===n?"":n,reactive:!1,impersonatedUser:o,fetchSize:validateFetchSizeValue$1(i,this._config.fetchSize),bookmarkManager:a,notificationFilter:s,auth:e})},e.prototype.close=function(){return this._log.info("Driver ".concat(this._id," closing")),null!=this._connectionProvider?this._connectionProvider.close():Promise.resolve()},e.prototype[Symbol.asyncDispose]=function(){return this.close()},e.prototype._afterConstruction=function(){this._log.info("".concat(this._meta.typename," driver ").concat(this._id," created for server address ").concat(this._meta.address.toString()))},e.prototype._homeDatabaseCallback=function(e,t){this.homeDatabaseCache.set(e,t)},e.prototype._newSession=function(e){var t=e.defaultAccessMode,r=e.bookmarkOrBookmarks,n=e.database,o=e.reactive,i=e.impersonatedUser,a=e.fetchSize,s=e.bookmarkManager,u=e.notificationFilter,e=e.auth,t=session_1.default._validateSessionMode(t),c=this._getOrCreateConnectionProvider(),l=this.homeDatabaseCache.get((0,auth_util_1.cacheKey)(e,i)),f=this._homeDatabaseCallback.bind(this),r=null!=r?new bookmarks_1.Bookmarks(r):bookmarks_1.Bookmarks.empty();return this._createSession({mode:t,database:null!=n?n:"",connectionProvider:c,bookmarks:r,config:__assign$t({cachedHomeDatabase:l,routingDriver:this._supportsRouting()},this._config),reactive:o,impersonatedUser:i,fetchSize:a,bookmarkManager:s,notificationFilter:u,auth:e,log:this._log,homeDatabaseCallback:f})},e.prototype._getOrCreateConnectionProvider=function(){return null==this._connectionProvider&&(this._connectionProvider=this._createConnectionProvider(this._id,this._config,this._log,createHostNameResolver(this._config))),this._connectionProvider},e}());function validateConfig(e,t){var r=e.resolver;if(null!=r&&"function"!=typeof r)throw new TypeError("Configured resolver should be a function. Got: ".concat(typeof r));if(e.connectionAcquisitionTimeout<e.connectionTimeout&&t.warn('Configuration for "connectionAcquisitionTimeout" should be greater than or equal to "connectionTimeout". Otherwise, the connection acquisition timeout will take precedence for over the connection timeout in scenarios where a new connection is created while it is acquired'),null!=(null==(r=e.notificationFilter)?void 0:r.disabledCategories)&&null!=(null==(t=e.notificationFilter)?void 0:t.disabledClassifications))throw new Error('The notificationFilter can\'t have both "disabledCategories" and  "disabledClassifications" configured at the same time.');return e}function sanitizeConfig(e){e.maxConnectionLifetime=sanitizeIntValue(e.maxConnectionLifetime,DEFAULT_MAX_CONNECTION_LIFETIME),e.maxConnectionPoolSize=sanitizeIntValue(e.maxConnectionPoolSize,constants_1.DEFAULT_POOL_MAX_SIZE),e.connectionAcquisitionTimeout=sanitizeIntValue(e.connectionAcquisitionTimeout,constants_1.DEFAULT_POOL_ACQUISITION_TIMEOUT),e.fetchSize=validateFetchSizeValue$1(e.fetchSize,DEFAULT_FETCH_SIZE),e.connectionTimeout=extractConnectionTimeout(e),e.connectionLivenessCheckTimeout=validateConnectionLivenessCheckTimeoutSizeValue(e.connectionLivenessCheckTimeout)}function sanitizeIntValue(e,t){e=parseInt(e,10);return 0<e||0===e?e:e<0?Number.MAX_SAFE_INTEGER:t}function validateFetchSizeValue$1(e,t){e=parseInt(e,10);if(0<e||e===constants_1.FETCH_ALL)return e;if(0===e||e<0)throw new Error("The fetch size can only be a positive value or ".concat(constants_1.FETCH_ALL," for ALL. However fetchSize = ").concat(e));return t}function extractConnectionTimeout(e){e=parseInt(e.connectionTimeout,10);return 0===e||!isNaN(e)&&e<0?null:isNaN(e)?constants_1.DEFAULT_CONNECTION_TIMEOUT_MILLIS:e}function validateConnectionLivenessCheckTimeoutSizeValue(e){if(null!=e){e=parseInt(e,10);if(e<0||Number.isNaN(e))throw new Error("The connectionLivenessCheckTimeout can only be a positive value or 0 for always. However connectionLivenessCheckTimeout = ".concat(e));return e}}function createHostNameResolver(e){return new configured_custom_resolver_1.default(e.resolver)}driver.Driver=Driver$1,driver.default=Driver$1;var auth$1={},error_1=(Object.defineProperty(auth$1,"__esModule",{value:!0}),error),json_1=json$3,auth={basic:function(e,t,r){return null!=r?{scheme:"basic",principal:e,credentials:t,realm:r}:{scheme:"basic",principal:e,credentials:t}},kerberos:function(e){return{scheme:"kerberos",principal:"",credentials:e}},bearer:function(e){return{scheme:"bearer",credentials:e}},none:function(){return{scheme:"none"}},custom:function(e,t,r,n,o){n={scheme:n,principal:e};if(isNotEmpty(t)&&(n.credentials=t),isNotEmpty(r)&&(n.realm=r),isNotEmpty(o)){try{(0,json_1.stringify)(o)}catch(e){throw(0,error_1.newError)("Circular references in custom auth token parameters",void 0,e)}n.parameters=o}return n}};function isNotEmpty(e){return!(null==e||""===e||Object.getPrototypeOf(e)===Object.prototype&&0===Object.keys(e).length)}auth$1.default=auth;var authTokenManager={},__awaiter$a=commonjsGlobal&&commonjsGlobal.__awaiter||function(e,a,s,u){return new(s=s||Promise)(function(r,t){function n(e){try{i(u.next(e))}catch(e){t(e)}}function o(e){try{i(u.throw(e))}catch(e){t(e)}}function i(e){var t;e.done?r(e.value):((t=e.value)instanceof s?t:new s(function(e){e(t)})).then(n,o)}i((u=u.apply(e,a||[])).next())})},__generator$c=commonjsGlobal&&commonjsGlobal.__generator||function(n,o){var i,a,s,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},c={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(c[Symbol.iterator]=function(){return this}),c;function e(r){return function(e){var t=[r,e];if(i)throw new TypeError("Generator is already executing.");for(;u=c&&t[c=0]?0:u;)try{if(i=1,a&&(s=2&t[0]?a.return:t[0]?a.throw||((s=a.return)&&s.call(a),0):a.next)&&!(s=s.call(a,t[1])).done)return s;switch(a=0,(t=s?[2&t[0],s.value]:t)[0]){case 0:case 1:s=t;break;case 4:return u.label++,{value:t[1],done:!1};case 5:u.label++,a=t[1],t=[0];continue;case 7:t=u.ops.pop(),u.trys.pop();continue;default:if(!(s=0<(s=u.trys).length&&s[s.length-1])&&(6===t[0]||2===t[0])){u=0;continue}if(3===t[0]&&(!s||t[1]>s[0]&&t[1]<s[3])){u.label=t[1];break}if(6===t[0]&&u.label<s[1]){u.label=s[1],s=t;break}if(s&&u.label<s[2]){u.label=s[2],u.ops.push(t);break}s[2]&&u.ops.pop(),u.trys.pop();continue}t=o.call(n,u)}catch(e){t=[6,e],a=0}finally{i=s=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}}},__importDefault$U=commonjsGlobal&&commonjsGlobal.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},auth_1=(Object.defineProperty(authTokenManager,"__esModule",{value:!0}),authTokenManager.staticAuthTokenManager=authTokenManager.authTokenManagers=authTokenManager.AuthTokenAndExpiration=void 0,__importDefault$U(auth$1)),internal_1=internal,AuthTokenManager=function(){function e(){}return e.prototype.getToken=function(){throw new Error("Not Implemented")},e.prototype.handleSecurityException=function(e,t){throw new Error("Not implemented")},e}(),AuthTokenAndExpiration=(authTokenManager.default=AuthTokenManager,function(){this.token=auth_1.default.none(),this.expiration=void 0}),AuthTokenManagers=(authTokenManager.AuthTokenAndExpiration=AuthTokenAndExpiration,function(){function e(){}return e.prototype.bearer=function(e){e=e.tokenProvider;if("function"!=typeof e)throw new TypeError("tokenProvider should be function, but got: ".concat(typeof e));return new ExpirationBasedAuthTokenManager(e,["Neo.ClientError.Security.Unauthorized","Neo.ClientError.Security.TokenExpired"])},e.prototype.basic=function(e){var t=this,r=e.tokenProvider;if("function"!=typeof r)throw new TypeError("tokenProvider should be function, but got: ".concat(typeof r));return new ExpirationBasedAuthTokenManager(function(){return __awaiter$a(t,void 0,void 0,function(){var t;return __generator$c(this,function(e){switch(e.label){case 0:return t={},[4,r()];case 1:return[2,(t.token=e.sent(),t)]}})})},["Neo.ClientError.Security.Unauthorized"])},e}()),authTokenManagers=new AuthTokenManagers;function staticAuthTokenManager(e){e=e.authToken;return new StaticAuthTokenManager(e)}authTokenManager.authTokenManagers=authTokenManagers,Object.freeze(authTokenManagers),authTokenManager.staticAuthTokenManager=staticAuthTokenManager;var TokenRefreshObservable=function(){function e(e){this._subscribers=e=void 0===e?[]:e}return e.prototype.subscribe=function(e){this._subscribers.push(e)},e.prototype.onCompleted=function(t){this._subscribers.forEach(function(e){return e.onCompleted(t)})},e.prototype.onError=function(t){this._subscribers.forEach(function(e){return e.onError(t)})},e}(),ExpirationBasedAuthTokenManager=function(){function e(e,t,r,n){this._tokenProvider=e,this._handledSecurityCodes=t,this._currentAuthData=r,this._refreshObservable=n}return e.prototype.getToken=function(){var t;return __awaiter$a(this,void 0,void 0,function(){return __generator$c(this,function(e){switch(e.label){case 0:return void 0===this._currentAuthData||void 0!==this._currentAuthData.expiration&&this._currentAuthData.expiration<new Date?[4,this._refreshAuthToken()]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2,null==(t=this._currentAuthData)?void 0:t.token]}})})},e.prototype.handleSecurityException=function(e,t){return!!this._handledSecurityCodes.includes(t)&&(internal_1.util.equals(e,null==(t=this._currentAuthData)?void 0:t.token)&&this._scheduleRefreshAuthToken(),!0)},e.prototype._scheduleRefreshAuthToken=function(e){var r=this;void 0===this._refreshObservable&&(this._currentAuthData=void 0,this._refreshObservable=new TokenRefreshObservable,Promise.resolve(this._tokenProvider()).then(function(e){var t;r._currentAuthData=e,null!=(t=r._refreshObservable)&&t.onCompleted(e)}).catch(function(e){var t;null!=(t=r._refreshObservable)&&t.onError(e)}).finally(function(){r._refreshObservable=void 0})),void 0!==e&&this._refreshObservable.subscribe(e)},e.prototype._refreshAuthToken=function(){return __awaiter$a(this,void 0,void 0,function(){var r=this;return __generator$c(this,function(e){switch(e.label){case 0:return[4,new Promise(function(e,t){r._scheduleRefreshAuthToken({onCompleted:e,onError:t})})];case 1:return[2,e.sent()]}})})},e}(),StaticAuthTokenManager=function(){function e(e){this._authToken=e}return e.prototype.getToken=function(){return this._authToken},e.prototype.handleSecurityException=function(e,t){return!1},e}(),types$1={},__extends$O=commonjsGlobal&&commonjsGlobal.__extends||function(){var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}}(),Config=(Object.defineProperty(types$1,"__esModule",{value:!0}),types$1.InternalConfig=types$1.Config=void 0,function(){this.encrypted=void 0,this.trust=void 0,this.trustedCertificates=[],this.maxConnectionPoolSize=100,this.maxConnectionLifetime=36e5,this.connectionAcquisitionTimeout=6e4,this.maxTransactionRetryTime=3e4,this.connectionLivenessCheckTimeout=void 0,this.connectionTimeout=3e4,this.disableLosslessIntegers=!1,this.useBigInt=!1,this.logging=void 0,this.resolver=void 0,this.notificationFilter=void 0,this.userAgent=void 0,this.telemetryDisabled=!1,this.clientCertificate=void 0}),InternalConfig=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends$O(t,e),t}(types$1.Config=Config),clientCertificate=(types$1.InternalConfig=InternalConfig,{}),__extends$N=commonjsGlobal&&commonjsGlobal.__extends||function(){var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}}(),__assign$s=commonjsGlobal&&commonjsGlobal.__assign||function(){return(__assign$s=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},__createBinding$5=commonjsGlobal&&commonjsGlobal.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&("get"in o?t.__esModule:!o.writable&&!o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,o)}:function(e,t,r,n){e[n=void 0===n?r:n]=t[r]}),__setModuleDefault$5=commonjsGlobal&&commonjsGlobal.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),__importStar$5=commonjsGlobal&&commonjsGlobal.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&__createBinding$5(t,e,r);return __setModuleDefault$5(t,e),t},json=(Object.defineProperty(clientCertificate,"__esModule",{value:!0}),clientCertificate.resolveCertificateProvider=clientCertificate.clientCertificateProviders=clientCertificate.RotatingClientCertificateProvider=clientCertificate.ClientCertificateProvider=void 0,__importStar$5(json$3)),ClientCertificate=function(){this.certfile="",this.keyfile="",this.password=void 0},ClientCertificateProvider=(clientCertificate.default=ClientCertificate,function(){function e(){}return e.prototype.hasUpdate=function(){throw new Error("Not Implemented")},e.prototype.getClientCertificate=function(){throw new Error("Not Implemented")},e}()),RotatingClientCertificateProvider=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends$N(t,e),t.prototype.updateCertificate=function(e){throw new Error("Not implemented")},t}(clientCertificate.ClientCertificateProvider=ClientCertificateProvider),ClientCertificateProviders=(clientCertificate.RotatingClientCertificateProvider=RotatingClientCertificateProvider,function(){function e(){}return e.prototype.rotating=function(e){e=e.initialCertificate;if(null==e||!isClientClientCertificate(e))throw new TypeError("initialCertificate should be ClientCertificate, but got ".concat(json.stringify(e)));e=__assign$s({},e);return new InternalRotatingClientCertificateProvider(e)},e}()),clientCertificateProviders=new ClientCertificateProviders;function resolveCertificateProvider(e){if(null!=e){if("object"==typeof e&&"hasUpdate"in e&&"getClientCertificate"in e&&"function"==typeof e.getClientCertificate&&"function"==typeof e.hasUpdate)return e;var t;if(isClientClientCertificate(e))return t=__assign$s({},e),{getClientCertificate:function(){return t},hasUpdate:function(){return!1}};throw new TypeError("clientCertificate should be configured with ClientCertificate or ClientCertificateProvider, but got ".concat(json.stringify(e)))}}function isClientClientCertificate(e){return null!=e&&"object"==typeof e&&"certfile"in e&&isCertFile(e.certfile)&&"keyfile"in e&&isKeyFile(e.keyfile)&&isStringOrNotPresent("password",e)}function isCertFile(e){return isString(e)||isArrayOf(e,isString)}function isKeyFile(e){function t(e){return"string"==typeof e||null!=e&&"object"==typeof e&&"path"in e&&"string"==typeof e.path&&isStringOrNotPresent("password",e)}return t(e)||isArrayOf(e,t)}function isString(e){return"string"==typeof e}function isArrayOf(e,t,r){return void 0===r&&(r=!1),Array.isArray(e)&&(r||0<e.length)&&e.filter(t).length===e.length}function isStringOrNotPresent(e,t){return!(e in t)||null==t[e]||"string"==typeof t[e]}clientCertificate.clientCertificateProviders=clientCertificateProviders,Object.freeze(clientCertificateProviders),clientCertificate.resolveCertificateProvider=resolveCertificateProvider;var InternalRotatingClientCertificateProvider=function(){function e(e,t){void 0===t&&(t=!1),this._certificate=e,this._updated=t}return e.prototype.hasUpdate=function(){try{return this._updated}finally{this._updated=!1}},e.prototype.getClientCertificate=function(){return this._certificate},e.prototype.updateCertificate=function(e){if(!isClientClientCertificate(e))throw new TypeError("certificate should be ClientCertificate, but got ".concat(json.stringify(e)));this._certificate=__assign$s({},e),this._updated=!0},e}(),sessionRx=(!function(e){var n=commonjsGlobal&&commonjsGlobal.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&("get"in o?t.__esModule:!o.writable&&!o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,o)}:function(e,t,r,n){e[n=void 0===n?r:n]=t[r]}),o=commonjsGlobal&&commonjsGlobal.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),t=commonjsGlobal&&commonjsGlobal.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return o(t,e),t},r=commonjsGlobal&&commonjsGlobal.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},i=(Object.defineProperty(e,"__esModule",{value:!0}),e.EagerResult=e.Result=e.Stats=e.QueryStatistics=e.ProfiledPlan=e.Plan=e.GqlStatusObject=e.Notification=e.ServerInfo=e.queryType=e.ResultSummary=e.Record=e.isPathSegment=e.PathSegment=e.isPath=e.Path=e.isUnboundRelationship=e.UnboundRelationship=e.isRelationship=e.Relationship=e.isNode=e.Node=e.Time=e.LocalTime=e.LocalDateTime=e.isTime=e.isLocalTime=e.isLocalDateTime=e.isDuration=e.isDateTime=e.isDate=e.Duration=e.DateTime=e.Date=e.Point=e.isPoint=e.internal=e.toString=e.toNumber=e.inSafeRange=e.isInt=e.int=e.Integer=e.error=e.isRetriableError=e.GQLError=e.newGQLError=e.Neo4jError=e.newError=e.authTokenManagers=void 0,e.resolveCertificateProvider=e.clientCertificateProviders=e.notificationFilterMinimumSeverityLevel=e.notificationFilterDisabledClassification=e.notificationFilterDisabledCategory=e.notificationSeverityLevel=e.notificationClassification=e.notificationCategory=e.resultTransformers=e.routing=e.staticAuthTokenManager=e.bookmarkManager=e.auth=e.json=e.driver=e.types=e.Driver=e.Session=e.TransactionPromise=e.ManagedTransaction=e.Transaction=e.Connection=e.Releasable=e.ConnectionProvider=void 0,error),a=(Object.defineProperty(e,"newError",{enumerable:!0,get:function(){return i.newError}}),Object.defineProperty(e,"Neo4jError",{enumerable:!0,get:function(){return i.Neo4jError}}),Object.defineProperty(e,"newGQLError",{enumerable:!0,get:function(){return i.newGQLError}}),Object.defineProperty(e,"GQLError",{enumerable:!0,get:function(){return i.GQLError}}),Object.defineProperty(e,"isRetriableError",{enumerable:!0,get:function(){return i.isRetriableError}}),t(integer)),s=(e.Integer=a.default,Object.defineProperty(e,"int",{enumerable:!0,get:function(){return a.int}}),Object.defineProperty(e,"isInt",{enumerable:!0,get:function(){return a.isInt}}),Object.defineProperty(e,"inSafeRange",{enumerable:!0,get:function(){return a.inSafeRange}}),Object.defineProperty(e,"toNumber",{enumerable:!0,get:function(){return a.toNumber}}),Object.defineProperty(e,"toString",{enumerable:!0,get:function(){return a.toString}}),temporalTypes),u=(Object.defineProperty(e,"Date",{enumerable:!0,get:function(){return s.Date}}),Object.defineProperty(e,"DateTime",{enumerable:!0,get:function(){return s.DateTime}}),Object.defineProperty(e,"Duration",{enumerable:!0,get:function(){return s.Duration}}),Object.defineProperty(e,"isDate",{enumerable:!0,get:function(){return s.isDate}}),Object.defineProperty(e,"isDateTime",{enumerable:!0,get:function(){return s.isDateTime}}),Object.defineProperty(e,"isDuration",{enumerable:!0,get:function(){return s.isDuration}}),Object.defineProperty(e,"isLocalDateTime",{enumerable:!0,get:function(){return s.isLocalDateTime}}),Object.defineProperty(e,"isLocalTime",{enumerable:!0,get:function(){return s.isLocalTime}}),Object.defineProperty(e,"isTime",{enumerable:!0,get:function(){return s.isTime}}),Object.defineProperty(e,"LocalDateTime",{enumerable:!0,get:function(){return s.LocalDateTime}}),Object.defineProperty(e,"LocalTime",{enumerable:!0,get:function(){return s.LocalTime}}),Object.defineProperty(e,"Time",{enumerable:!0,get:function(){return s.Time}}),graphTypes),c=(Object.defineProperty(e,"Node",{enumerable:!0,get:function(){return u.Node}}),Object.defineProperty(e,"isNode",{enumerable:!0,get:function(){return u.isNode}}),Object.defineProperty(e,"Relationship",{enumerable:!0,get:function(){return u.Relationship}}),Object.defineProperty(e,"isRelationship",{enumerable:!0,get:function(){return u.isRelationship}}),Object.defineProperty(e,"UnboundRelationship",{enumerable:!0,get:function(){return u.UnboundRelationship}}),Object.defineProperty(e,"isUnboundRelationship",{enumerable:!0,get:function(){return u.isUnboundRelationship}}),Object.defineProperty(e,"Path",{enumerable:!0,get:function(){return u.Path}}),Object.defineProperty(e,"isPath",{enumerable:!0,get:function(){return u.isPath}}),Object.defineProperty(e,"PathSegment",{enumerable:!0,get:function(){return u.PathSegment}}),Object.defineProperty(e,"isPathSegment",{enumerable:!0,get:function(){return u.isPathSegment}}),r(record)),l=(e.Record=c.default,spatialTypes),f=(Object.defineProperty(e,"isPoint",{enumerable:!0,get:function(){return l.isPoint}}),Object.defineProperty(e,"Point",{enumerable:!0,get:function(){return l.Point}}),t(resultSummary)),_=(e.ResultSummary=f.default,Object.defineProperty(e,"queryType",{enumerable:!0,get:function(){return f.queryType}}),Object.defineProperty(e,"ServerInfo",{enumerable:!0,get:function(){return f.ServerInfo}}),Object.defineProperty(e,"Plan",{enumerable:!0,get:function(){return f.Plan}}),Object.defineProperty(e,"ProfiledPlan",{enumerable:!0,get:function(){return f.ProfiledPlan}}),Object.defineProperty(e,"QueryStatistics",{enumerable:!0,get:function(){return f.QueryStatistics}}),Object.defineProperty(e,"Stats",{enumerable:!0,get:function(){return f.Stats}}),t(notification)),p=(e.Notification=_.default,Object.defineProperty(e,"GqlStatusObject",{enumerable:!0,get:function(){return _.GqlStatusObject}}),Object.defineProperty(e,"notificationCategory",{enumerable:!0,get:function(){return _.notificationCategory}}),Object.defineProperty(e,"notificationClassification",{enumerable:!0,get:function(){return _.notificationClassification}}),Object.defineProperty(e,"notificationSeverityLevel",{enumerable:!0,get:function(){return _.notificationSeverityLevel}}),notificationFilter),d=(Object.defineProperty(e,"notificationFilterDisabledCategory",{enumerable:!0,get:function(){return p.notificationFilterDisabledCategory}}),Object.defineProperty(e,"notificationFilterDisabledClassification",{enumerable:!0,get:function(){return p.notificationFilterDisabledClassification}}),Object.defineProperty(e,"notificationFilterMinimumSeverityLevel",{enumerable:!0,get:function(){return p.notificationFilterMinimumSeverityLevel}}),r(result)),b=(e.Result=d.default,r(resultEager)),m=(e.EagerResult=b.default,t(connectionProvider$1)),h=(e.ConnectionProvider=m.default,Object.defineProperty(e,"Releasable",{enumerable:!0,get:function(){return m.Releasable}}),r(connection$2)),y=(e.Connection=h.default,r(transaction)),v=(e.Transaction=y.default,r(transactionManaged)),g=(e.ManagedTransaction=v.default,r(transactionPromise)),$=(e.TransactionPromise=g.default,r(session)),O=(e.Session=$.default,t(driver)),E=O,T=(e.Driver=O.default,e.driver=E,r(auth$1)),S=(e.auth=T.default,bookmarkManager$1),w=(Object.defineProperty(e,"bookmarkManager",{enumerable:!0,get:function(){return S.bookmarkManager}}),authTokenManager),P=(Object.defineProperty(e,"authTokenManagers",{enumerable:!0,get:function(){return w.authTokenManagers}}),Object.defineProperty(e,"staticAuthTokenManager",{enumerable:!0,get:function(){return w.staticAuthTokenManager}}),driver),j=(Object.defineProperty(e,"routing",{enumerable:!0,get:function(){return P.routing}}),t(types$1)),C=(e.types=j,t(json$3)),r=(e.json=C,r(resultTransformers$1)),R=(e.resultTransformers=r.default,clientCertificate),t=(Object.defineProperty(e,"clientCertificateProviders",{enumerable:!0,get:function(){return R.clientCertificateProviders}}),Object.defineProperty(e,"resolveCertificateProvider",{enumerable:!0,get:function(){return R.resolveCertificateProvider}}),t(internal)),A=(e.internal=t,{SERVICE_UNAVAILABLE:i.SERVICE_UNAVAILABLE,SESSION_EXPIRED:i.SESSION_EXPIRED,PROTOCOL_ERROR:i.PROTOCOL_ERROR}),A=(e.error=A,{authTokenManagers:w.authTokenManagers,newError:i.newError,Neo4jError:i.Neo4jError,newGQLError:i.newGQLError,GQLError:i.GQLError,isRetriableError:i.isRetriableError,error:A,Integer:a.default,int:a.int,isInt:a.isInt,inSafeRange:a.inSafeRange,toNumber:a.toNumber,toString:a.toString,internal:t,isPoint:l.isPoint,Point:l.Point,Date:s.Date,DateTime:s.DateTime,Duration:s.Duration,isDate:s.isDate,isDateTime:s.isDateTime,isDuration:s.isDuration,isLocalDateTime:s.isLocalDateTime,isLocalTime:s.isLocalTime,isTime:s.isTime,LocalDateTime:s.LocalDateTime,LocalTime:s.LocalTime,Time:s.Time,Node:u.Node,isNode:u.isNode,Relationship:u.Relationship,isRelationship:u.isRelationship,UnboundRelationship:u.UnboundRelationship,isUnboundRelationship:u.isUnboundRelationship,Path:u.Path,isPath:u.isPath,PathSegment:u.PathSegment,isPathSegment:u.isPathSegment,Record:c.default,ResultSummary:f.default,queryType:f.queryType,ServerInfo:f.ServerInfo,Notification:_.default,GqlStatusObject:_.GqlStatusObject,Plan:f.Plan,ProfiledPlan:f.ProfiledPlan,QueryStatistics:f.QueryStatistics,Stats:f.Stats,Result:d.default,EagerResult:b.default,Transaction:y.default,ManagedTransaction:v.default,TransactionPromise:g.default,Session:$.default,Driver:O.default,Connection:h.default,Releasable:m.Releasable,types:j,driver:E,json:C,auth:T.default,bookmarkManager:S.bookmarkManager,routing:P.routing,resultTransformers:r.default,notificationCategory:_.notificationCategory,notificationClassification:_.notificationClassification,notificationSeverityLevel:_.notificationSeverityLevel,notificationFilterDisabledCategory:p.notificationFilterDisabledCategory,notificationFilterDisabledClassification:p.notificationFilterDisabledClassification,notificationFilterMinimumSeverityLevel:p.notificationFilterMinimumSeverityLevel,clientCertificateProviders:R.clientCertificateProviders,resolveCertificateProvider:R.resolveCertificateProvider});e.default=A}(lib$1),{}),cjs={},Observable$1={},Subscriber={},isFunction$1={};function isFunction(e){return"function"==typeof e}Object.defineProperty(isFunction$1,"__esModule",{value:!0}),isFunction$1.isFunction=void 0,isFunction$1.isFunction=isFunction;var Subscription$1={},UnsubscriptionError={},createErrorClass$1={};function createErrorClass(e){e=e(function(e){Error.call(e),e.stack=(new Error).stack});return e.prototype=Object.create(Error.prototype),e.prototype.constructor=e}Object.defineProperty(createErrorClass$1,"__esModule",{value:!0}),createErrorClass$1.createErrorClass=void 0,createErrorClass$1.createErrorClass=createErrorClass,Object.defineProperty(UnsubscriptionError,"__esModule",{value:!0}),UnsubscriptionError.UnsubscriptionError=void 0;var createErrorClass_1$5=createErrorClass$1,arrRemove$1=(UnsubscriptionError.UnsubscriptionError=createErrorClass_1$5.createErrorClass(function(t){return function(e){t(this),this.message=e?e.length+" errors occurred during unsubscription:\n"+e.map(function(e,t){return t+1+") "+e.toString()}).join("\n  "):"",this.name="UnsubscriptionError",this.errors=e}}),{});function arrRemove(e,t){e&&0<=(t=e.indexOf(t))&&e.splice(t,1)}Object.defineProperty(arrRemove$1,"__esModule",{value:!0}),arrRemove$1.arrRemove=void 0,arrRemove$1.arrRemove=arrRemove;var __values$a=commonjsGlobal&&commonjsGlobal.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return{value:(e=e&&n>=e.length?void 0:e)&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},__read$p=commonjsGlobal&&commonjsGlobal.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),a=[];try{for(;(void 0===t||0<t--)&&!(n=i.next()).done;)a.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a},__spreadArray$j=commonjsGlobal&&commonjsGlobal.__spreadArray||function(e,t){for(var r=0,n=t.length,o=e.length;r<n;r++,o++)e[o]=t[r];return e},isFunction_1$p=(Object.defineProperty(Subscription$1,"__esModule",{value:!0}),Subscription$1.isSubscription=Subscription$1.EMPTY_SUBSCRIPTION=Subscription$1.Subscription=void 0,isFunction$1),UnsubscriptionError_1=UnsubscriptionError,arrRemove_1$7=arrRemove$1,Subscription=function(){function r(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}var e;return r.prototype.unsubscribe=function(){var t,e,r;if(!this.closed){this.closed=!0;var n=this._parentage;if(n)if(this._parentage=null,Array.isArray(n))try{for(var o=__values$a(n),i=o.next();!i.done;i=o.next())i.value.remove(this)}catch(e){s={error:e}}finally{try{i&&!i.done&&(a=o.return)&&a.call(o)}finally{if(s)throw s.error}}else n.remove(this);var a=this.initialTeardown;if(isFunction_1$p.isFunction(a))try{a()}catch(e){r=e instanceof UnsubscriptionError_1.UnsubscriptionError?e.errors:[e]}var s=this._finalizers;if(s){this._finalizers=null;try{for(var u=__values$a(s),c=u.next();!c.done;c=u.next()){var l=c.value;try{execFinalizer(l)}catch(e){r=null!=r?r:[],e instanceof UnsubscriptionError_1.UnsubscriptionError?r=__spreadArray$j(__spreadArray$j([],__read$p(r)),__read$p(e.errors)):r.push(e)}}}catch(e){t={error:e}}finally{try{c&&!c.done&&(e=u.return)&&e.call(u)}finally{if(t)throw t.error}}}if(r)throw new UnsubscriptionError_1.UnsubscriptionError(r)}},r.prototype.add=function(e){var t;if(e&&e!==this)if(this.closed)execFinalizer(e);else{if(e instanceof r){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=null!=(t=this._finalizers)?t:[]).push(e)}},r.prototype._hasParent=function(e){var t=this._parentage;return t===e||Array.isArray(t)&&t.includes(e)},r.prototype._addParent=function(e){var t=this._parentage;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e},r.prototype._removeParent=function(e){var t=this._parentage;t===e?this._parentage=null:Array.isArray(t)&&arrRemove_1$7.arrRemove(t,e)},r.prototype.remove=function(e){var t=this._finalizers;t&&arrRemove_1$7.arrRemove(t,e),e instanceof r&&e._removeParent(this)},r.EMPTY=((e=new r).closed=!0,e),r}();function isSubscription(e){return e instanceof Subscription||e&&"closed"in e&&isFunction_1$p.isFunction(e.remove)&&isFunction_1$p.isFunction(e.add)&&isFunction_1$p.isFunction(e.unsubscribe)}function execFinalizer(e){isFunction_1$p.isFunction(e)?e():e.unsubscribe()}Subscription$1.Subscription=Subscription,Subscription$1.EMPTY_SUBSCRIPTION=Subscription.EMPTY,Subscription$1.isSubscription=isSubscription;var config={},reportUnhandledError$1=(Object.defineProperty(config,"__esModule",{value:!0}),config.config=void 0,config.config={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},{}),timeoutProvider={},config_1$2=(!function(i){var a=commonjsGlobal&&commonjsGlobal.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),a=[];try{for(;(void 0===t||0<t--)&&!(n=i.next()).done;)a.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a},s=commonjsGlobal&&commonjsGlobal.__spreadArray||function(e,t){for(var r=0,n=t.length,o=e.length;r<n;r++,o++)e[o]=t[r];return e};Object.defineProperty(i,"__esModule",{value:!0}),i.timeoutProvider=void 0,i.timeoutProvider={setTimeout:function(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];var o=i.timeoutProvider.delegate;return null!=o&&o.setTimeout?o.setTimeout.apply(o,s([e,t],a(r))):setTimeout.apply(void 0,s([e,t],a(r)))},clearTimeout:function(e){var t=i.timeoutProvider.delegate;return((null==t?void 0:t.clearTimeout)||clearTimeout)(e)},delegate:void 0}}(timeoutProvider),Object.defineProperty(reportUnhandledError$1,"__esModule",{value:!0}),reportUnhandledError$1.reportUnhandledError=void 0,config),timeoutProvider_1=timeoutProvider;function reportUnhandledError(t){timeoutProvider_1.timeoutProvider.setTimeout(function(){var e=config_1$2.config.onUnhandledError;if(!e)throw t;e(t)})}reportUnhandledError$1.reportUnhandledError=reportUnhandledError;var noop$1={};function noop(){}Object.defineProperty(noop$1,"__esModule",{value:!0}),noop$1.noop=void 0,noop$1.noop=noop;var NotificationFactories={};function errorNotification(e){return createNotification("E",void 0,e)}function nextNotification(e){return createNotification("N",e,void 0)}function createNotification(e,t,r){return{kind:e,value:t,error:r}}Object.defineProperty(NotificationFactories,"__esModule",{value:!0}),NotificationFactories.createNotification=NotificationFactories.nextNotification=NotificationFactories.errorNotification=NotificationFactories.COMPLETE_NOTIFICATION=void 0,NotificationFactories.COMPLETE_NOTIFICATION=createNotification("C",void 0,void 0),NotificationFactories.errorNotification=errorNotification,NotificationFactories.nextNotification=nextNotification,NotificationFactories.createNotification=createNotification;var errorContext$1={},config_1$1=(Object.defineProperty(errorContext$1,"__esModule",{value:!0}),errorContext$1.captureError=errorContext$1.errorContext=void 0,config),context=null;function errorContext(e){if(config_1$1.config.useDeprecatedSynchronousErrorHandling){var t=!context;if(t&&(context={errorThrown:!1,error:null}),e(),t){var t=context,r=t.errorThrown,t=t.error;if(context=null,r)throw t}}else e()}function captureError(e){config_1$1.config.useDeprecatedSynchronousErrorHandling&&context&&(context.errorThrown=!0,context.error=e)}errorContext$1.errorContext=errorContext,errorContext$1.captureError=captureError,function(r){var n,o,e=commonjsGlobal&&commonjsGlobal.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),i=(Object.defineProperty(r,"__esModule",{value:!0}),r.EMPTY_OBSERVER=r.SafeSubscriber=r.Subscriber=void 0,isFunction$1),a=Subscription$1,s=config,t=reportUnhandledError$1,u=noop$1,c=NotificationFactories,l=timeoutProvider,f=errorContext$1,_=(o=a.Subscription,e(p,o),p.create=function(e,t,r){return new v(e,t,r)},p.prototype.next=function(e){this.isStopped?O(c.nextNotification(e),this):this._next(e)},p.prototype.error=function(e){this.isStopped?O(c.errorNotification(e),this):(this.isStopped=!0,this._error(e))},p.prototype.complete=function(){this.isStopped?O(c.COMPLETE_NOTIFICATION,this):(this.isStopped=!0,this._complete())},p.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,o.prototype.unsubscribe.call(this),this.destination=null)},p.prototype._next=function(e){this.destination.next(e)},p.prototype._error=function(e){try{this.destination.error(e)}finally{this.unsubscribe()}},p.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},p);function p(e){var t=o.call(this)||this;return t.isStopped=!1,e?(t.destination=e,a.isSubscription(e)&&e.add(t)):t.destination=r.EMPTY_OBSERVER,t}r.Subscriber=_;var d=Function.prototype.bind;function b(e,t){return d.call(e,t)}h.prototype.next=function(e){var t=this.partialObserver;if(t.next)try{t.next(e)}catch(e){$(e)}},h.prototype.error=function(e){var t=this.partialObserver;if(t.error)try{t.error(e)}catch(e){$(e)}else $(e)},h.prototype.complete=function(){var e=this.partialObserver;if(e.complete)try{e.complete()}catch(e){$(e)}};var m=h;function h(e){this.partialObserver=e}e(g,y=_);var y,v=g;function g(e,t,r){var n=y.call(this)||this;return r=i.isFunction(e)||!e?{next:null!=e?e:void 0,error:null!=t?t:void 0,complete:null!=r?r:void 0}:n&&s.config.useDeprecatedNextContext?((t=Object.create(e)).unsubscribe=function(){return n.unsubscribe()},{next:e.next&&b(e.next,t),error:e.error&&b(e.error,t),complete:e.complete&&b(e.complete,t)}):e,n.destination=new m(r),n}function $(e){s.config.useDeprecatedSynchronousErrorHandling?f.captureError(e):t.reportUnhandledError(e)}function O(e,t){var r=s.config.onStoppedNotification;r&&l.timeoutProvider.setTimeout(function(){return r(e,t)})}r.SafeSubscriber=v,r.EMPTY_OBSERVER={closed:!0,next:u.noop,error:function(e){throw e},complete:u.noop}}(Subscriber);var observable={},pipe$1=(Object.defineProperty(observable,"__esModule",{value:!0}),observable.observable=void 0,observable.observable="function"==typeof Symbol&&Symbol.observable||"@@observable",{}),identity$2={};function identity$1(e){return e}Object.defineProperty(identity$2,"__esModule",{value:!0}),identity$2.identity=void 0,identity$2.identity=identity$1,Object.defineProperty(pipe$1,"__esModule",{value:!0}),pipe$1.pipeFromArray=pipe$1.pipe=void 0;var identity_1$e=identity$2;function pipe(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return pipeFromArray(e)}function pipeFromArray(t){return 0===t.length?identity_1$e.identity:1===t.length?t[0]:function(e){return t.reduce(function(e,t){return t(e)},e)}}pipe$1.pipe=pipe,pipe$1.pipeFromArray=pipeFromArray,Object.defineProperty(Observable$1,"__esModule",{value:!0}),Observable$1.Observable=void 0;var Subscriber_1$3=Subscriber,Subscription_1$8=Subscription$1,observable_1$2=observable,pipe_1$2=pipe$1,config_1=config,isFunction_1$o=isFunction$1,errorContext_1$1=errorContext$1,Observable=function(){function r(e){e&&(this._subscribe=e)}return r.prototype.lift=function(e){var t=new r;return t.source=this,t.operator=e,t},r.prototype.subscribe=function(e,t,r){var n=this,o=isSubscriber(e)?e:new Subscriber_1$3.SafeSubscriber(e,t,r);return errorContext_1$1.errorContext(function(){var e=n.operator,t=n.source;o.add(e?e.call(o,t):t?n._subscribe(o):n._trySubscribe(o))}),o},r.prototype._trySubscribe=function(t){try{return this._subscribe(t)}catch(e){t.error(e)}},r.prototype.forEach=function(n,e){var o=this;return new(e=getPromiseCtor(e))(function(e,t){var r=new Subscriber_1$3.SafeSubscriber({next:function(e){try{n(e)}catch(e){t(e),r.unsubscribe()}},error:t,complete:e});o.subscribe(r)})},r.prototype._subscribe=function(e){var t;return null==(t=this.source)?void 0:t.subscribe(e)},r.prototype[observable_1$2.observable]=function(){return this},r.prototype.pipe=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return pipe_1$2.pipeFromArray(e)(this)},r.prototype.toPromise=function(e){var n=this;return new(e=getPromiseCtor(e))(function(e,t){var r;n.subscribe(function(e){return r=e},function(e){return t(e)},function(){return e(r)})})},r.create=function(e){return new r(e)},r}();function getPromiseCtor(e){return null!=(e=null!=e?e:config_1.config.Promise)?e:Promise}function isObserver(e){return e&&isFunction_1$o.isFunction(e.next)&&isFunction_1$o.isFunction(e.error)&&isFunction_1$o.isFunction(e.complete)}function isSubscriber(e){return e&&e instanceof Subscriber_1$3.Subscriber||isObserver(e)&&Subscription_1$8.isSubscription(e)}Observable$1.Observable=Observable;var ConnectableObservable$1={},refCount$1={},lift={},isFunction_1$n=(Object.defineProperty(lift,"__esModule",{value:!0}),lift.operate=lift.hasLift=void 0,isFunction$1);function hasLift(e){return isFunction_1$n.isFunction(null==e?void 0:e.lift)}function operate(t){return function(e){if(hasLift(e))return e.lift(function(e){try{return t(e,this)}catch(e){this.error(e)}});throw new TypeError("Unable to lift unknown Observable type")}}lift.hasLift=hasLift,lift.operate=operate;var OperatorSubscriber$1={},__extends$M=commonjsGlobal&&commonjsGlobal.__extends||function(){var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}}(),Subscriber_1$2=(Object.defineProperty(OperatorSubscriber$1,"__esModule",{value:!0}),OperatorSubscriber$1.OperatorSubscriber=OperatorSubscriber$1.createOperatorSubscriber=void 0,Subscriber);function createOperatorSubscriber(e,t,r,n,o){return new OperatorSubscriber(e,t,r,n,o)}OperatorSubscriber$1.createOperatorSubscriber=createOperatorSubscriber;var OperatorSubscriber=function(s){function e(t,r,e,n,o,i){var a=s.call(this,t)||this;return a.onFinalize=o,a.shouldUnsubscribe=i,a._next=r?function(e){try{r(e)}catch(e){t.error(e)}}:s.prototype._next,a._error=n?function(e){try{n(e)}catch(e){t.error(e)}finally{this.unsubscribe()}}:s.prototype._error,a._complete=e?function(){try{e()}catch(e){t.error(e)}finally{this.unsubscribe()}}:s.prototype._complete,a}return __extends$M(e,s),e.prototype.unsubscribe=function(){var e;this.shouldUnsubscribe&&!this.shouldUnsubscribe()||(e=this.closed,s.prototype.unsubscribe.call(this),e||null==(e=this.onFinalize)||e.call(this))},e}(Subscriber_1$2.Subscriber),lift_1$14=(OperatorSubscriber$1.OperatorSubscriber=OperatorSubscriber,Object.defineProperty(refCount$1,"__esModule",{value:!0}),refCount$1.refCount=void 0,lift),OperatorSubscriber_1$V=OperatorSubscriber$1;function refCount(){return lift_1$14.operate(function(r,n){var o=null,e=(r._refCount++,OperatorSubscriber_1$V.createOperatorSubscriber(n,void 0,void 0,void 0,function(){var e,t;!r||r._refCount<=0||0<--r._refCount?o=null:(e=r._connection,t=o,o=null,!e||t&&e!==t||e.unsubscribe(),n.unsubscribe())}));r.subscribe(e),e.closed||(o=r.connect())})}refCount$1.refCount=refCount;var __extends$L=commonjsGlobal&&commonjsGlobal.__extends||function(){var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}}(),Observable_1$n=(Object.defineProperty(ConnectableObservable$1,"__esModule",{value:!0}),ConnectableObservable$1.ConnectableObservable=void 0,Observable$1),Subscription_1$7=Subscription$1,refCount_1=refCount$1,OperatorSubscriber_1$U=OperatorSubscriber$1,lift_1$13=lift,ConnectableObservable=function(n){function e(e,t){var r=n.call(this)||this;return r.source=e,r.subjectFactory=t,r._subject=null,r._refCount=0,r._connection=null,lift_1$13.hasLift(e)&&(r.lift=e.lift),r}return __extends$L(e,n),e.prototype._subscribe=function(e){return this.getSubject().subscribe(e)},e.prototype.getSubject=function(){var e=this._subject;return e&&!e.isStopped||(this._subject=this.subjectFactory()),this._subject},e.prototype._teardown=function(){this._refCount=0;var e=this._connection;(this._subject=this._connection=null)!=e&&e.unsubscribe()},e.prototype.connect=function(){var t,r=this,e=this._connection;return e||(e=this._connection=new Subscription_1$7.Subscription,t=this.getSubject(),e.add(this.source.subscribe(OperatorSubscriber_1$U.createOperatorSubscriber(t,void 0,function(){r._teardown(),t.complete()},function(e){r._teardown(),t.error(e)},function(){return r._teardown()}))),e.closed&&(this._connection=null,e=Subscription_1$7.Subscription.EMPTY)),e},e.prototype.refCount=function(){return refCount_1.refCount()(this)},e}(Observable$1.Observable),animationFrames$1=(ConnectableObservable$1.ConnectableObservable=ConnectableObservable,{}),performanceTimestampProvider={},animationFrameProvider=(!function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.performanceTimestampProvider=void 0,e.performanceTimestampProvider={now:function(){return(e.performanceTimestampProvider.delegate||performance).now()},delegate:void 0}}(performanceTimestampProvider),{}),Observable_1$m=(!function(i){var n=commonjsGlobal&&commonjsGlobal.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),a=[];try{for(;(void 0===t||0<t--)&&!(n=i.next()).done;)a.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a},o=commonjsGlobal&&commonjsGlobal.__spreadArray||function(e,t){for(var r=0,n=t.length,o=e.length;r<n;r++,o++)e[o]=t[r];return e},a=(Object.defineProperty(i,"__esModule",{value:!0}),i.animationFrameProvider=void 0,Subscription$1);i.animationFrameProvider={schedule:function(t){var e=requestAnimationFrame,r=cancelAnimationFrame,n=i.animationFrameProvider.delegate,o=(n&&(e=n.requestAnimationFrame,r=n.cancelAnimationFrame),e(function(e){r=void 0,t(e)}));return new a.Subscription(function(){return null==r?void 0:r(o)})},requestAnimationFrame:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=i.animationFrameProvider.delegate;return((null==r?void 0:r.requestAnimationFrame)||requestAnimationFrame).apply(void 0,o([],n(e)))},cancelAnimationFrame:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=i.animationFrameProvider.delegate;return((null==r?void 0:r.cancelAnimationFrame)||cancelAnimationFrame).apply(void 0,o([],n(e)))},delegate:void 0}}(animationFrameProvider),Object.defineProperty(animationFrames$1,"__esModule",{value:!0}),animationFrames$1.animationFrames=void 0,Observable$1),performanceTimestampProvider_1=performanceTimestampProvider,animationFrameProvider_1$1=animationFrameProvider;function animationFrames(e){return e?animationFramesFactory(e):DEFAULT_ANIMATION_FRAMES}function animationFramesFactory(s){return new Observable_1$m.Observable(function(r){var n=s||performanceTimestampProvider_1.performanceTimestampProvider,o=n.now(),i=0,a=function(){r.closed||(i=animationFrameProvider_1$1.animationFrameProvider.requestAnimationFrame(function(e){i=0;var t=n.now();r.next({timestamp:s?t:e,elapsed:t-o}),a()}))};return a(),function(){i&&animationFrameProvider_1$1.animationFrameProvider.cancelAnimationFrame(i)}})}animationFrames$1.animationFrames=animationFrames;var resolved,DEFAULT_ANIMATION_FRAMES=animationFramesFactory(),Subject$1={},ObjectUnsubscribedError={},createErrorClass_1$4=(Object.defineProperty(ObjectUnsubscribedError,"__esModule",{value:!0}),ObjectUnsubscribedError.ObjectUnsubscribedError=void 0,createErrorClass$1),__extends$K=(ObjectUnsubscribedError.ObjectUnsubscribedError=createErrorClass_1$4.createErrorClass(function(e){return function(){e(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}}),commonjsGlobal&&commonjsGlobal.__extends||function(){var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}}()),__values$9=commonjsGlobal&&commonjsGlobal.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return{value:(e=e&&n>=e.length?void 0:e)&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},Observable_1$l=(Object.defineProperty(Subject$1,"__esModule",{value:!0}),Subject$1.AnonymousSubject=Subject$1.Subject=void 0,Observable$1),Subscription_1$6=Subscription$1,ObjectUnsubscribedError_1=ObjectUnsubscribedError,arrRemove_1$6=arrRemove$1,errorContext_1=errorContext$1,Subject=function(t){function e(){var e=t.call(this)||this;return e.closed=!1,e.currentObservers=null,e.observers=[],e.isStopped=!1,e.hasError=!1,e.thrownError=null,e}return __extends$K(e,t),e.prototype.lift=function(e){var t=new AnonymousSubject(this,this);return t.operator=e,t},e.prototype._throwIfClosed=function(){if(this.closed)throw new ObjectUnsubscribedError_1.ObjectUnsubscribedError},e.prototype.next=function(o){var i=this;errorContext_1.errorContext(function(){var t,e;if(i._throwIfClosed(),!i.isStopped){i.currentObservers||(i.currentObservers=Array.from(i.observers));try{for(var r=__values$9(i.currentObservers),n=r.next();!n.done;n=r.next())n.value.next(o)}catch(e){t={error:e}}finally{try{n&&!n.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}}})},e.prototype.error=function(t){var r=this;errorContext_1.errorContext(function(){if(r._throwIfClosed(),!r.isStopped){r.hasError=r.isStopped=!0,r.thrownError=t;for(var e=r.observers;e.length;)e.shift().error(t)}})},e.prototype.complete=function(){var t=this;errorContext_1.errorContext(function(){if(t._throwIfClosed(),!t.isStopped){t.isStopped=!0;for(var e=t.observers;e.length;)e.shift().complete()}})},e.prototype.unsubscribe=function(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null},Object.defineProperty(e.prototype,"observed",{get:function(){var e;return 0<(null==(e=this.observers)?void 0:e.length)},enumerable:!1,configurable:!0}),e.prototype._trySubscribe=function(e){return this._throwIfClosed(),t.prototype._trySubscribe.